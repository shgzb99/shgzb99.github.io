<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="英雄本色的博客，记录生活，分享感悟。">
<meta property="og:type" content="website">
<meta property="og:title" content="英雄本色的博客">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="英雄本色的博客">
<meta property="og:description" content="英雄本色的博客，记录生活，分享感悟。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="英雄本色">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>英雄本色的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">英雄本色的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">记录生活，分享感悟</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/14/linux%E4%B8%AD%E6%8C%82%E8%BD%BDIMG%E6%96%87%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/14/linux%E4%B8%AD%E6%8C%82%E8%BD%BDIMG%E6%96%87%E4%BB%B6/" class="post-title-link" itemprop="url">linux中挂载IMG文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-14 17:17:35 / 修改时间：17:18:25" itemprop="dateCreated datePublished" datetime="2024-06-14T17:17:35+08:00">2024-06-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>原文：<a target="_blank" rel="noopener" href="http://www.linuxsir.org/bbs/thread334903.html">http://www.linuxsir.org/bbs/thread334903.html</a></p>
<ol>
<li><p>先查看第一个空闲loop设备<br>Shell代码<br>sudo losetup -f<br>&#x2F;dev&#x2F;loop0  </p>
</li>
<li><p>使用上一步得到的设备名，第一次创建loop设备<br>Shell代码<br>sudo losetup &#x2F;dev&#x2F;loop0 archlinux-2008.06-core-i686.img  </p>
</li>
<li><p>查看信息<br>Shell代码<br>sudo fdisk -lu &#x2F;dev&#x2F;loop0</p>
</li>
</ol>
<p>Disk &#x2F;dev&#x2F;loop0: 322 MB, 322469376 bytes<br>53 heads, 12 sectors&#x2F;track, 990 cylinders, total 629823 sectors<br>Units &#x3D; sectors of 1 * 512 &#x3D; 512 bytes<br>Disk identifier: 0x00000000  </p>
<pre><code>  Device Boot      Start         End      Blocks   Id  System  
</code></pre>
<p>&#x2F;dev&#x2F;loop0p1   *          63      629822      314880   83  Linux<br>Partition 1 has different physical&#x2F;logical beginnings (non-Linux?):<br>     phys&#x3D;(0, 1, 1) logical&#x3D;(0, 5, 4)<br>Partition 1 has different physical&#x2F;logical endings:<br>     phys&#x3D;(39, 52, 12) logical&#x3D;(990, 15, 3)  </p>
<p>我们可以看到，该镜像只有一个分区(loop0p1)，从第63扇区开始(Start列)，每扇区512字节(Units &#x3D; sectors of 1 * 512 &#x3D; 512 bytes)，我们算出offset，下面mout命令会用到：<br>Shell代码<br>63*512&#x3D;32256  </p>
<ol start="4">
<li>mout<br>Shell代码<br>sudo losetup -o 32256 &#x2F;dev&#x2F;loop1 archlinux-2008.06-core-i686.img<br>sudo mount -o loop &#x2F;dev&#x2F;loop1 &#x2F;mnt&#x2F;<br>ls &#x2F;mnt&#x2F;<br>addons  archlive.sqfs  boot  lost+found</li>
</ol>
<p>事实上，fdisk可以直接查看img文件(虽然功能不全，下面会说到)，mount可以自动创建loop设备，所以上面步骤可以简化为：<br>I. 查看信息<br>Shell代码<br>sudo fdisk -lu archlinux-2008.06-core-i686.img<br>You must set cylinders.<br>You can do this from the extra functions menu.  </p>
<p>Disk archlinux-2008.06-core-i686.img: 0 MB, 0 bytes<br>53 heads, 12 sectors&#x2F;track, 0 cylinders, total 0 sectors<br>Units &#x3D; sectors of 1 * 512 &#x3D; 512 bytes<br>Disk identifier: 0x00000000  </p>
<pre><code>                      Device Boot      Start         End      Blocks   Id  System  
</code></pre>
<p>archlinux-2008.06-core-i686.img1   *          63      629822      314880   83  Linux<br>Partition 1 has different physical&#x2F;logical beginnings (non-Linux?):<br>     phys&#x3D;(0, 1, 1) logical&#x3D;(0, 5, 4)<br>Partition 1 has different physical&#x2F;logical endings:<br>     phys&#x3D;(39, 52, 12) logical&#x3D;(990, 15, 3)  </p>
<p>第一行抱怨不能得到cylinders，原因是普通文件上没有实现ioctl操作，我们可以看到0 cylinders，但这对我们不重要，关键是我们依然可以得到第一个分区（archlinux-2008.06-core-i686.img1）的偏移值</p>
<p>II. 直接mount<br>Shell代码<br>sudo mount -o loop,offset&#x3D;32256 archlinux-2008.06-core-i686.img &#x2F;mnt&#x2F;<br>ls &#x2F;mnt&#x2F;<br>addons  archlive.sqfs  boot  lost+found  </p>
<p>参考Loop-mounting partitions from a disk image</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/14/Linux%E4%B8%AD%E6%8C%82%E8%BD%BD%E5%90%84%E7%A7%8D%E6%A0%BC%E5%BC%8F%E9%95%9C%E5%83%8F%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/14/Linux%E4%B8%AD%E6%8C%82%E8%BD%BD%E5%90%84%E7%A7%8D%E6%A0%BC%E5%BC%8F%E9%95%9C%E5%83%8F%E7%9A%84%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">Linux中挂载各种格式镜像的方法总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-06-14 17:10:27" itemprop="dateCreated datePublished" datetime="2024-06-14T17:10:27+08:00">2024-06-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-06-15 06:35:54" itemprop="dateModified" datetime="2024-06-15T06:35:54+08:00">2024-06-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>原文 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ed9dbaabfee4">https://www.jianshu.com/p/ed9dbaabfee4</a></p>
<p>一、挂载iso格式镜像<br>1、将镜像文件拷贝到linux系统上。</p>
<p>2、执行命令：mount -t iso9660 -o loop &#x2F;root&#x2F;xxx.iso &#x2F;mnt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@h07d07184.sqa.eu95 /root]#mount -t iso9660 -o loop alinux-test.iso /mnt</span><br><span class="line"></span><br><span class="line">mount: /root/alinux-test.iso is already mounted</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>3、查看&#x2F;mnt文件夹，即可查看到镜像的文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@h07d07184.sqa.eu95 /root]#ls /mnt</span><br><span class="line"></span><br><span class="line">apptmp_run.over boot dev home lib64 media opt root run srv tmp varbin data etc lib lost+found mnt proc rr_moved sbin sys usr</span><br></pre></td></tr></table></figure>

<p>4、卸载：umount &#x2F;mnt</p>
<p>二、挂载qcow2格式镜像</p>
<ol>
<li>首先检查当前系统的kernel对NBD模块的支持（NBD:network block device），加载nbd这个module</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@jay-linux kvm_demo]# grep NBD /boot/config-3.5.0</span><br><span class="line"></span><br><span class="line">CONFIG_BLK_DEV_NBD=m</span><br><span class="line"></span><br><span class="line">[root@jay-linux kvm_demo]# modinfo nbd</span><br><span class="line"></span><br><span class="line">filename:      /lib/modules/3.5.0/kernel/drivers/block/nbd.ko</span><br><span class="line"></span><br><span class="line">license:        GPL</span><br><span class="line"></span><br><span class="line">description:    Network Block Device</span><br><span class="line"></span><br><span class="line">srcversion:    56F31584CC2EB73E6F1DA69</span><br><span class="line"></span><br><span class="line">depends:</span><br><span class="line"></span><br><span class="line">intree:        Y</span><br><span class="line"></span><br><span class="line">vermagic:      3.5.0 SMP mod_unload modversions</span><br><span class="line"></span><br><span class="line">parm:          nbds_max:number of network block devices to initialize (default: 16) (int)</span><br><span class="line"></span><br><span class="line">parm:          max_part:number of partitions per device (default: 0) (int)</span><br><span class="line"></span><br><span class="line">parm:          debugflags:flags for controlling debug output (int)</span><br><span class="line"></span><br><span class="line">[root@jay-linux kvm_demo]# modprobe nbd max_part=16</span><br><span class="line"></span><br><span class="line">[root@jay-linux kvm_demo]# lsmod | grep nbd</span><br><span class="line"></span><br><span class="line">nbd                    7593  0</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>将qcow2镜像映射为网络块设备(nbd)，命令如下：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@h07d07184.sqa.eu95 /mnt]#qemu-nbd -c /dev/nbd0 /root/Alinux-2.1.0-OUT-1220.qcow2</span><br><span class="line"></span><br><span class="line">[root@h07d07184.sqa.eu95 /mnt]# ll /dev/nbd0*</span><br><span class="line"></span><br><span class="line">brw-rw---- 1 root disk 43, 0 Jan 10 10:17 /dev/nbd0</span><br><span class="line"></span><br><span class="line">brw-rw---- 1 root disk 43, 1 Jan 10 10:17 /dev/nbd0p1</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>像普通block设备那样使用刚才映射好的网络块设备的分区即可，命令行如下：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@h07d07184.sqa.eu95 /mnt]#mount /dev/nbd0p1 /mnt/[root@h07d07184.sqa.eu95 /mnt]#ls /mnt/ </span><br><span class="line"></span><br><span class="line">apptmp_run.over boot dev home lib64 media opt root sbin sys usrbin data etc lib lost+found mnt proc run srv tmp var</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>使用完这个qcow2镜像后，卸载已挂载的nbd设备，解除qcow2镜像与nbd设备的关联。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@jay-linux kvm_demo]# umount /mnt/</span><br><span class="line"></span><br><span class="line">[root@jay-linux kvm_demo]# qemu-nbd -d /dev/nbd0</span><br><span class="line"></span><br><span class="line">/dev/nbd0 disconnected</span><br></pre></td></tr></table></figure>

<p>三、挂载vhd格式镜像（与qcow2方法相似）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@h07d07184.sqa.eu95 /root]#ll /dev/nbd0*</span><br><span class="line"></span><br><span class="line">brw-rw---- 1 root disk 43, 0 Jan 10 10:31 /dev/nbd0</span><br><span class="line"></span><br><span class="line">[root@h07d07184.sqa.eu95 /root]#qemu-nbd -c /dev/nbd0 aliyun-test.vhd[root@h07d07184.sqa.eu95 /root]#ll /dev/nbd0*</span><br><span class="line"></span><br><span class="line">brw-rw---- 1 root disk 43, 0 Jan 10 10:32 /dev/nbd0</span><br><span class="line"></span><br><span class="line">brw-rw---- 1 root disk 43, 1 Jan 10 10:32 /dev/nbd0p1</span><br><span class="line"></span><br><span class="line">[root@h07d07184.sqa.eu95 /root]#mount /dev/nbd0p1 /mnt[root@h07d07184.sqa.eu95 /root]#ls /mnt/</span><br><span class="line"></span><br><span class="line">bin boot dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var</span><br><span class="line"></span><br><span class="line">[root@h07d07184.sqa.eu95 /root]#umount /mnt/</span><br><span class="line"></span><br><span class="line">[root@h07d07184.sqa.eu95 /root]#qemu-nbd -d /dev/nbd0</span><br><span class="line"></span><br><span class="line">/dev/nbd0 disconnected</span><br><span class="line"></span><br><span class="line">[root@h07d07184.sqa.eu95 /root]#</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/13/tee-%E8%AF%BB%E5%8F%96%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%B9%B6%E8%BE%93%E5%87%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/13/tee-%E8%AF%BB%E5%8F%96%E6%A0%87%E5%87%86%E8%BE%93%E5%85%A5%E5%B9%B6%E8%BE%93%E5%87%BA/" class="post-title-link" itemprop="url">tee 读取标准输入并输出</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-13 22:12:44 / 修改时间：22:13:47" itemprop="dateCreated datePublished" datetime="2024-06-13T22:12:44+08:00">2024-06-13</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://einverne.github.io/post/2013/01/tee-command.html">https://einverne.github.io/post/2013/01/tee-command.html</a></p>
<p>在执行 Linux 命令时，我们可以把输出重定向到文件中，比如 <code>ls &gt; a.txt</code>，这时我们就不能看到输出了，如果我们既想把输出保存到文件中，又想在屏幕上看到输出内容，就可以使用 tee 命令了。tee 命令读取标准输入，把这些内容同时输出到标准输出和（多个）文件中（read from standard input and write to standard output and files. Copy standard input to each FILE, and also to standard output. If a FILE is -, copy again to standard output.）。</p>
<p>在 tee 中说道：tee 命令可以重定向标准输出到多个文件（<code>tee&#39;: Redirect output to multiple files. The </code>tee’ command copies standard input to standard output and also to any files given as arguments.  This is useful when you want not only to send some data down a pipe, but also to save a copy.）。要注意的是：在使用管道时，前一个命令的标准错误输出不会被 tee 读取。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>格式：</p>
<pre><code>tee file
</code></pre>
<p>输出到标准输出的同时，保存到文件 file 中。如果文件不存在，则创建；如果已经存在，则覆盖之。当使用 <code>-a</code> 参数时不会覆盖，而是附加。</p>
<p>格式：</p>
<pre><code>tee -a file
</code></pre>
<p>输出到标准输出的同时，追加到文件 file 中。如果文件不存在，则创建；如果已经存在，就在末尾追加内容，而不是覆盖。</p>
<p>格式：</p>
<pre><code>tee -
</code></pre>
<p>输出到标准输出两次。（A FILE of <code>-&#39; causes </code>tee’ to send another copy of input to standard output, but this is typically not that useful as the copies are interleaved.）</p>
<p>格式：</p>
<pre><code>tee file1 file2 -
</code></pre>
<p>输出到标准输出两次，同时保存到 file1 和 file2 中。</p>
<p>使用 tee 命令重复输出字符串</p>
<pre><code>echo 12345 | tee
12345

echo 12345 | tee -
12345
12345
echo 12345 | tee - -
12345
12345
12345
</code></pre>
<p>使用 tee 命令把标准错误输出也保存到文件，默认情况下 tee 是不会将标准错误内容也保存到文件的，这个时候需要使用 <code>2&gt;$1</code></p>
<pre><code>ls &quot;*&quot; 2&gt;&amp;1 | tee ls.txt
</code></pre>
<p>文件中就是</p>
<pre><code>ls: cannot access &#39;*&#39;: No such file or directory
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/13/dd%E5%91%BD%E4%BB%A4%E6%98%BE%E7%A4%BA%E8%BF%9B%E5%BA%A6%E5%8F%8A%E6%89%8B%E5%8A%A8%E8%BF%81%E7%A7%BB%E7%B3%BB%E7%BB%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/13/dd%E5%91%BD%E4%BB%A4%E6%98%BE%E7%A4%BA%E8%BF%9B%E5%BA%A6%E5%8F%8A%E6%89%8B%E5%8A%A8%E8%BF%81%E7%A7%BB%E7%B3%BB%E7%BB%9F/" class="post-title-link" itemprop="url">dd命令显示进度及手动迁移系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-13 14:31:54 / 修改时间：14:32:42" itemprop="dateCreated datePublished" datetime="2024-06-13T14:31:54+08:00">2024-06-13</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/grumpyhippo/p/11260161.html#:~:text=dd%E5%91%BD%E4%BB%A4%E6%98%BE%E7%A4%BA%E8%BF%9B%E5%BA%A6%201.%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AA%97%E5%8F%A3%E6%89%A7%E8%A1%8Cdd%E5%91%BD%E4%BB%A4%202.%E5%8F%A6%E5%BC%80%E4%B8%80%E4%B8%AA%E7%AA%97%E5%8F%A3%EF%BC%8C%E6%89%A7%E8%A1%8Cwatch%20-n%205,pkill%20-USR1%20-x%20dd%203.%E5%9C%A8%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%89%A7%E8%A1%8Cdd%E5%91%BD%E4%BB%A4%E7%9A%84%E7%AA%97%E5%8F%A3%E5%8D%B3%E5%8F%AF%E6%98%BE%E7%A4%BAdd%E6%89%A7%E8%A1%8C%E8%BF%9B%E5%BA%A6%EF%BC%8C%E7%9B%B4%E5%88%B0%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90">https://www.cnblogs.com/grumpyhippo/p/11260161.html#:~:text=dd%E5%91%BD%E4%BB%A4%E6%98%BE%E7%A4%BA%E8%BF%9B%E5%BA%A6%201.%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AA%97%E5%8F%A3%E6%89%A7%E8%A1%8Cdd%E5%91%BD%E4%BB%A4%202.%E5%8F%A6%E5%BC%80%E4%B8%80%E4%B8%AA%E7%AA%97%E5%8F%A3%EF%BC%8C%E6%89%A7%E8%A1%8Cwatch%20-n%205,pkill%20-USR1%20-x%20dd%203.%E5%9C%A8%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%89%A7%E8%A1%8Cdd%E5%91%BD%E4%BB%A4%E7%9A%84%E7%AA%97%E5%8F%A3%E5%8D%B3%E5%8F%AF%E6%98%BE%E7%A4%BAdd%E6%89%A7%E8%A1%8C%E8%BF%9B%E5%BA%A6%EF%BC%8C%E7%9B%B4%E5%88%B0%E4%BB%BB%E5%8A%A1%E5%AE%8C%E6%88%90</a></p>
<p>dd命令显示进度<br>1.第一个窗口执行dd命令<br>2.另开一个窗口，执行watch -n 5 pkill -USR1 -x dd<br>3.在第一个执行dd命令的窗口即可显示dd执行进度，直到任务完成</p>
<p>dd 网络磁盘克隆<br>dd if&#x3D;&#x2F;dev&#x2F;sda |ssh xxx.xxx.xxx.xxx “dd of&#x3D;&#x2F;dev&#x2F;sda bs&#x3D;4M”</p>
<p>linux手动迁移方法<br>1.在目标机器挂起live CD，并配置可通IP地址，开启ssh服务器，设置root密码。2.在原机执行dd if&#x3D;&#x2F;dev&#x2F;sda |ssh xxx.xxx.xxx.xxx “dd of&#x3D;&#x2F;dev&#x2F;sda bs&#x3D;4M”<br>3.第二步完成后再目标机live CD系统中将boot所在分区挂载起来，执行grub-install –root-directory&#x3D;&#x2F;mnt&#x2F;boot &#x2F;dev&#x2F;sda<br>4.目标机reboot<br>5.启动时进入grub&gt;<br>6.ls查看boot所在分区，例如查询可知在（hd0,msdos1）。执行：set root&#x3D;(hd0,msdos1);set prefix&#x3D;(hd0,msdos1)&#x2F;grub2;insmod normal;normal<br>7.执行完以上即可进入系统<br>8.进入系统后执行grub2-install &#x2F;dev&#x2F;sda<br>9.reboot目标机完成迁移。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/13/linux%E4%B8%8B%E6%98%BE%E7%A4%BAdd%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BF%9B%E5%BA%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/13/linux%E4%B8%8B%E6%98%BE%E7%A4%BAdd%E5%91%BD%E4%BB%A4%E7%9A%84%E8%BF%9B%E5%BA%A6/" class="post-title-link" itemprop="url">linux下显示dd命令的进度</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-13 14:30:01 / 修改时间：14:31:14" itemprop="dateCreated datePublished" datetime="2024-06-13T14:30:01+08:00">2024-06-13</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/potato-chip/p/12759103.html">https://www.cnblogs.com/potato-chip/p/12759103.html</a></p>
<p>sudo dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;tmp&#x2F;zero.img status&#x3D;progress<br>linux下显示dd命令的进度：<br>dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;&#x2F;tmp&#x2F;zero.img bs&#x3D;10M count&#x3D;100000<br>想要查看上面的dd命令的执行进度，可以使用下面几种方法：<br>比如：每5秒输出dd的进度<br>方法一：<br>watch -n 5 pkill -USR1 ^dd$</p>
<p>方法二：<br>watch -n 5 killall -USR1 dd</p>
<p>方法三：<br>while killall -USR1 dd; do sleep 5; done</p>
<p>方法四：<br>while (ps auxww |grep “ dd “ |grep -v grep |awk ‘{print $2}’ |while read pid; do kill -USR1 $pid; done) ; do sleep 5; done<br>上述四种方法中使用三个命令：pkill、killall、kill向dd命令发送SIGUSR1信息，dd命令进程接收到信号之后就打印出自己当前的进度。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/12/publish-obsidian-post-to-wordpress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/12/publish-obsidian-post-to-wordpress/" class="post-title-link" itemprop="url">publish-obsidian-post-to-wordpress</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-12 21:24:54 / 修改时间：21:26:00" itemprop="dateCreated datePublished" datetime="2024-06-12T21:24:54+08:00">2024-06-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://einverne.github.io/post/2023/08/publish-obsidian-post-to-wordpress.html">https://einverne.github.io/post/2023/08/publish-obsidian-post-to-wordpress.html</a></p>
<p>如何快速分享 Obsidian 中的笔记是从我开始使用 Obsidian 之后一直在思考的问题，在之前，因为我所有的笔记都是通过 Markdown 来存放在本地的，如果我想要分享一个笔记，一般就是将笔记移动到 <code>Blog/_post</code> 目录下，因为我使用一个 Git 仓库来管理我所有的笔记（Vault）然后使用 git submodule 的方式来将我的 <a target="_blank" rel="noopener" href="https://blog.einverne.info/">Jekyll 博客</a>，<a target="_blank" rel="noopener" href="https://invest.einverne.info/">Hexo 博客</a> 放到我的统一的笔记库里面。所以当我想要发布一篇笔记的时候，就是将笔记移动到对应的博客的目录，然后在使用 git commit 提交，push 来发布，之后的过程都是通过 CI 自动完成的。</p>
<p>虽然这样的方式我已经使用了很多年了，也没有什么大的问题，唯一的问题就是因为发布博客对 Markdown 的标题有一些限制，所以发布之前都得进行重命名。并且我没有办法做到一键发布，大部分的情况下我都必需打开终端，然后进行提交。直到我发现了一款叫做 [[obsidian-wordpress]] 的插件。</p>
<p>这个<a target="_blank" rel="noopener" href="https://github.com/devbean/obsidian-wordpress">插件</a>完美的解决了我想要快速分享一篇笔记，然后还不需要我做任何调整，当完成初次的配置之后，基本上只需要点击一下就可以完成发布。</p>
<p><img src="https://photo.einverne.info/images/2023/08/28/U9pC.png" alt="U9pC"></p>
<p>这个插件使用 WordPress 的接口（XML-RPC 或 REST）来发布文章。</p>
<h2 id="obsidian-wordpress"><a href="#obsidian-wordpress" class="headerlink" title="obsidian wordpress"></a>obsidian wordpress</h2><p><a target="_blank" rel="noopener" href="https://github.com/devbean/obsidian-wordpress">obsidian-wordpress</a> 是一款 Obsidian 下的插件，可以一键将笔记发布到 WordPress 站点中。该插件使用 XML-RPC 或 REST 接口进行发布。</p>
<p>XML-RPC 是默认启用的，但有些站点可能由于安全问题而禁用它。 虽然有些共享主机可能默认禁用 XML-RPC，但是您无法启用它。 因此，如果禁用 XML-RPC，这个插件将不起作用。</p>
<p>在 WodrPress 4.7 之后，REST API 会在默认情况下启用。 一些 REST API 需要额外的操作来保护可写 API。 历史上 REST 接口是通过安装插件实现的。 在 WordPress 5.6 版本之后，引入了应用程序密码来完成类似的工作。 因此在 WordPress 5.6 之后 ，应用程序密码是首选的。</p>
<h2 id="初次设置"><a href="#初次设置" class="headerlink" title="初次设置"></a>初次设置</h2><p>在插件的设置中，找到 Profile，这里可以配置站点的信息，包括地址，API 类型，用户名，密码等。</p>
<p><img src="https://photo.einverne.info/images/2023/08/28/UA2H.png" alt="UA2H"></p>
<p>需要注意的是这里的密码，在最新版的 WordPress 中请使用应用程序密码，在用户管理下面生成。</p>
<p>当完成以上的设置之后，在任意的笔记中，都可以在侧边栏中找到 WordPress 的按钮，然后点击，选择分类，一键完成发布。最近我有在写我的 <a target="_blank" rel="noopener" href="https://japan.einverne.info/">日本生活</a> ，其中所有的内容都是我在 Obsidian 中完成编写，然后发布的。我创建了一个单独的文件夹用来存放所有发布到该网站的内容，并且这些内容也可以很好的和我的其他笔记进行融合，并且在我修改了文章的内容之后，也可以快速进行一键发布。</p>
<p>在以前我使用 WordPress 的时候，非常不方面的一点就是对其中文章内容的修改非常不方便，我不喜欢在线的编辑器，而如今 Obsidian 就成为了我的 WordPress 的本地编辑器。</p>
<h2 id="图片怎么办"><a href="#图片怎么办" class="headerlink" title="图片怎么办"></a>图片怎么办</h2><p>文章中的图片我是我之前搭建的 [[Chevereto]] 图床，配合 macOS 下的 uPic，我设置了快捷键 Ctrl + Shift + U，就可以一键上传粘贴板中的内容。然后直接在 Obsidian 中使用即可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/12/%E5%8F%8D%E6%9F%A5%E4%B8%80%E4%B8%AA%E5%9F%9F%E5%90%8D%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E5%9F%9F%E5%90%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/12/%E5%8F%8D%E6%9F%A5%E4%B8%80%E4%B8%AA%E5%9F%9F%E5%90%8D%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E5%9F%9F%E5%90%8D/" class="post-title-link" itemprop="url">反查一个域名的所有子域名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-12 21:03:34 / 修改时间：21:18:38" itemprop="dateCreated datePublished" datetime="2024-06-12T21:03:34+08:00">2024-06-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://einverne.github.io/post/2023/09/subdomain-scanner.html">https://einverne.github.io/post/2023/09/subdomain-scanner.html</a></p>
<p>前段时间看到一篇文章说因为 Nginx 的一个「特性」，在直接访问 IP ，并且没有配置默认证书的情况下 Nginx 就会返回一个 SSL 证书从而倒置域名的泄露，进而泄露了网站的源 IP，使得一些扫描网站，比如 [[censys]] 可以直接查询到域名背后的网站 IP，从而导致网站即使用了 CDN 也会遭受到攻击。在这个契机下，我又开始了衍生，因为在 censys，[[fofa]]，[[Shodan]] 等等网站上你只需要输入一个域名就可以获得所有这个站点相关的信息，那么有没有办法可以在只知道一个网站域名的情况下知道所有的二级域名呢。</p>
<p>于是抱着这个新想法，进行了一番调查，果然还是有办法可以知道的。我最最朴素的想法就是写一个遍历，直接通过随机的字符串，<code>[a-z0-9\-]</code> 等等字符的组合，然后进行这些域名检查，ping，dig 的结果，如果有返回，可以认为这个子域名被启用了。但是很显然这个想法的效率太低了，并且遍历这么多无效的域名前缀很显然没有办法最快的找到所有的。</p>
<p>然后我就找到了 [[MassDNS]]，一款使用 C 语言编写的高性能子域名扫描工具。它通过使用自定义的 DNS 解析器和并发查询来加快子域名的发现速度。MassDNS 支持使用字典文件进行子域名爆破，并提供了丰富的配置选项来优化扫描过程。 MassDNS 还支持自定义的 DNS 服务器，并可以通过设置最大查询时间和最大重试次数等参数来控制扫描过程中的超时和重试行为。此外，它还提供了多种输出格式，包括文本、JSON 和 CSV，以便用户根据需要对扫描结果进行分析和处理。 使用 MassDNS 进行子域名扫描非常简单，只需指定目标域名和字典文件即可开始扫描。它还提供了多线程支持，可以根据系统资源情况调整并发线程数量，以实现更快的扫描速度。</p>
<p>然后我又循着脉络找到了 <a target="_blank" rel="noopener" href="https://github.com/shmilylty/OneForAll">OneForAll</a> 这样一个开源的工具，它是一个功能强大的子域名收集工具，集成了非常多的工具，从它的官方介绍上也可以看出来它收集子域名的思路和方法。</p>
<ul>
<li>利用成熟第三方的情报收集<ul>
<li>利用证书收集子域名情报，比如通过 <code>censys_api</code>，<code>certspotter</code>，<code>crtsh</code> 等等</li>
<li>常规检查收集子域<ul>
<li>域传送漏洞利用<code>axfr</code></li>
<li>检查跨域策略文件<code>cdx</code></li>
<li>检查 HTTPS 证书<code>cert</code></li>
<li>检查内容安全策略<code>csp</code></li>
<li>检查 robots 文件<code>robots</code></li>
<li>检查 sitemap 文件<code>sitemap</code></li>
<li>利用 NSEC 记录遍历 DNS 域<code>dnssec</code></li>
<li>NSEC3 记录</li>
</ul>
</li>
<li>网络爬虫存档记录，<code>archivecrawl</code>，<code>commoncrawl</code></li>
<li>通过第三方 DNS 数据集收集子域</li>
<li>直接通过 DNS 查询收集，SRV记录，MX,NS,SOA,TXT记录</li>
<li>利用威胁情报平台数据收集子域</li>
<li>搜索引擎发现子域</li>
</ul>
</li>
<li>通过字典，或者遍历来查询子域名</li>
<li>通过 [[MassDNS]] 来多线程查询子域名</li>
</ul>
<h2 id="OneForAll-使用"><a href="#OneForAll-使用" class="headerlink" title="OneForAll 使用"></a>OneForAll 使用</h2><p>首先获取 OneForAll 的代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:shmilylty/OneForAll.git</span><br></pre></td></tr></table></figure>

<p>通过 <a href="/post/2017/04/pyenv.html">pyenv</a> 或者其他熟悉的工具，安装 Python 依赖，然后执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 oneforall.py --target douban.com run</span><br></pre></td></tr></table></figure>

<p>很快就能获得一个 CSV 的结果。</p>
<h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><ul>
<li>[[Findomain]]</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/12/genisoimage%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/12/genisoimage%E5%91%BD%E4%BB%A4%E7%94%A8%E6%B3%95/" class="post-title-link" itemprop="url">genisoimage命令用法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-12 13:57:03 / 修改时间：14:00:19" itemprop="dateCreated datePublished" datetime="2024-06-12T13:57:03+08:00">2024-06-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/klb561/p/9108712.html">https://www.cnblogs.com/klb561/p/9108712.html</a></p>
<p>功能说明：建立ISO 9660映像文件。  常用命令：genisoimage -o imagename.iso file 语 法：mkisofs [-adDfhJlLNrRTvz][-print-size][-quiet][-A ][-abstract ][-b ][-biblio ][-c ][-C ][-copyright ][-hide ][-hide-joliet ][-log-file ][-m ][-M ][-o ][-p ][-P ][-sysid ][-V ][-volset ][-volset-size ][-volset-seqno ][-x ][目录或文件]  补充说明：mkisofs可将指定的目录与文件做成ISO 9660格式的映像文件</p>
<p>基本用法：</p>
<p>mkisofs (or genisoimage) -o image.iso &#x2F;path&#x2F;of&#x2F;folder</p>
<p>如有中文不能显示尝试(建议使用)：</p>
<p>mkisofs (or genisoimage) -J -o image.iso &#x2F;path&#x2F;of&#x2F;folder</p>
<p>完整命令查看：</p>
<p>mkisofs (or genisoimage) –help 或 man genisoimage</p>
<p>命令: mkisofs(make iso file system)</p>
<p>功能说明：建立ISO 9660映像文件。<br>  语 法：mkisofs [-adDfhJlLNrRTvz][-print-size][-quiet][-A &lt;应用程序ID&gt;][-abstract &lt;摘要文件&gt;][-b &lt;开机映像文件&gt;][-biblio ][-c &lt;开机文件名称&gt;][-C &lt;盘区编号，磁区编号&gt;][-copyright &lt;版权信息文件&gt;][-hide &lt;目录或文件名&gt;][-hide-joliet &lt;文件或目录名&gt;][-log-file &lt;记录文件&gt;][-m &lt;目录或文件名&gt;][-M &lt;开机映像文件&gt;][-o &lt;映像文件&gt;][-p &lt;数据处理人&gt;][-P &lt;光盘发行人&gt;][-sysid &lt;系统ID &gt;][-V &lt;光盘ID &gt;][-volset &lt;卷册集ID&gt;][-volset-size &lt;光盘总数&gt;][-volset-seqno &lt;卷册序号&gt;][-x &lt;目录&gt;][目录或文件]<br>补充说明：mkisofs可将指定的目录与文件做成ISO 9660格式的映像文件，以供刻录光盘。<br>参 数：<br>-a或–all mkisofs通常不处理备份文件。使用此参数可以把备份文件加到映像文件中。<br>-A&lt;应用程序ID&gt;或-appid&lt;应用程序ID&gt; 指定光盘的应用程序ID。<br>-abstract&lt;摘要文件&gt; 指定摘要文件的文件名。<br>-b&lt;开机映像文件&gt;或-eltorito-boot&lt;开机映像文件&gt; 指定在制作可开机光盘时所需的开机映像文件。<br>-biblio 指定ISBN文件的文件名，ISBN文件位于光盘根目录下，记录光盘的ISBN。<br>-c&lt;开机文件名称&gt; 制作可开机光盘时，mkisofs会将开机映像文件中的全-eltorito-catalog&lt;开机文件名称&gt;全部内容作成一个文件。<br>-C&lt;盘区编号，盘区编号&gt; 将许多节区合成一个映像文件时，必须使用此参数。<br>-copyright&lt;版权信息文件&gt; 指定版权信息文件的文件名。<br>-d或-omit-period 省略文件后的句号。<br>-D或-disable-deep-relocation ISO 9660最多只能处理8层的目录，超过8层的部分，RRIP会自动将它们设置成ISO 9660兼容的格式。使用-D参数可关闭此功能。<br>-f或-follow-links 忽略符号连接。<br>-h 显示帮助。<br>-hide&lt;目录或文件名&gt; 使指定的目录或文件在ISO 9660或Rock RidgeExtensions的系统中隐藏。<br>-hide-joliet&lt;目录或文件名&gt; 使指定的目录或文件在Joliet系统中隐藏。<br>-J或-joliet 使用Joliet格式的目录与文件名称。<br>-l或-full-iso9660-filenames 使用ISO 9660 32字符长度的文件名。<br>-L或-allow-leading-dots 允许文件名的第一个字符为句号。<br>-log-file&lt;记录文件&gt; 在执行过程中若有错误信息，预设会显示在屏幕上。<br>-m&lt;目录或文件名&gt;或-exclude&lt;目录或文件名&gt; 指定的目录或文件名将不会房入映像文件中。<br>-M&lt;映像文件&gt;或-prev-session&lt;映像文件&gt; 与指定的映像文件合并。<br>-N或-omit-version-number 省略ISO 9660文件中的版本信息。<br>-o&lt;映像文件&gt;或-output&lt;映像文件&gt; 指定映像文件的名称。<br>-p&lt;数据处理人&gt;或-preparer&lt;数据处理人&gt; 记录光盘的数据处理人。<br>-print-size 显示预估的文件系统大小。<br>-quiet 执行时不显示任何信息。<br>-r或-rational-rock 使用Rock Ridge Extensions，并开放全部文件的读取权限。<br>-R或-rock 使用Rock Ridge Extensions。<br>-sysid&lt;系统ID&gt; 指定光盘的系统ID。<br>-T或-translation-table 建立文件名的转换表，适用于不支持Rock Ridge Extensions的系统上。<br>-v或-verbose 执行时显示详细的信息。<br>-V&lt;光盘ID</p>
<p>###############################################<br>#################################################</p>
<p> mkisofs(8) 程序作为 sysutils&#x2F;cdrtools port 的一部分， 将生成 ISO 9660 文件系统，其中包含 UNIX? 命名空间中的文件名。最简单的用法是：</p>
<h1 id="mkisofs-o-imagefile-iso-path-to-tree"><a href="#mkisofs-o-imagefile-iso-path-to-tree" class="headerlink" title="mkisofs -o imagefile.iso &#x2F;path&#x2F;to&#x2F;tree"></a>mkisofs -o imagefile.iso &#x2F;path&#x2F;to&#x2F;tree</h1><p>这个命令将创建一个包含 ISO9660 文件系统的 imagefile.iso 文件，它是目录树 &#x2F;path&#x2F;to&#x2F;tree 的一个副本。 在处理过程中，它将文件名称映射为标准的 ISO9660 文件系统的文件名，将排除那些不典型的 ISO 文件系统的文件。<br>有很多选项能够用来克服那些限制。特别的，-R 选项能够启用 Rock Ridge 扩展一般的 UNIX 系统，-J 选项能启用用于 Microsoft 系统的 Joliet 扩展，-hfs 选项能用来创建用于 Mac OS? 系统的 HFS 文件系统。<br>    RockRidge格式是ISO9660格式的延伸，支持文件名字母的大小写、符号字符、长文件名以及超过8层的目录结构。RockRidge使CD-ROM能兼容Unix的文件系统，因此它在Unix系统上已经被广泛地使用。<br>    对于那些即将要在 FreeBSD 系统中使用 CD 的人来说，-U 选项能用来消除所有文件名的限制。当使用-R 选项时，它会产生一个 文件系统映像，它与您从那儿启动 FreeBSD 树是一样的，虽然它在许多方面也违反了 ISO 9660 的标准。<br>最后一个常用的选项是 -b。 它用来指定启动映像的位置，用以生成 “El Torito” 启动 CD。 这个选项使用一个参数， 用以指定将写入 CD 的目录的根。默认情况下， mkisofs(8) 会以常说的 “软盘模拟” 方式来创建 ISO， 因此它希望引导映像文件的尺寸恰好是 1200， 1440 或 2880 KB。 某些引导加载器， 例如 FreeBSD 发行版磁盘， 并不使用模拟模式；这种情况下， 需要使用 -no-emul-boot 选项。 因此， 如果 &#x2F;tmp&#x2F;myboot 是一个包含了启动映像文件 &#x2F;tmp&#x2F;myboot&#x2F;boot&#x2F;cdboot 的可引导的 FreeBSD 系统，您就可以使用下面的命令生成 ISO 9660 文件系统映像 &#x2F;tmp&#x2F;bootable.iso：</p>
<h1 id="mkisofs-R-no-emul-boot-b-boot-cdboot-o-tmp-bootable-iso-tmp-myboot"><a href="#mkisofs-R-no-emul-boot-b-boot-cdboot-o-tmp-bootable-iso-tmp-myboot" class="headerlink" title="mkisofs -R -no-emul-boot -b boot&#x2F;cdboot -o &#x2F;tmp&#x2F;bootable.iso &#x2F;tmp&#x2F;myboot"></a>mkisofs -R -no-emul-boot -b boot&#x2F;cdboot -o &#x2F;tmp&#x2F;bootable.iso &#x2F;tmp&#x2F;myboot</h1><p>完成这些工作之后， 如果您的内核中配置了 md，就可以用下列命令来挂接文件系统了：</p>
<h1 id="mdconfig-a-t-vnode-f-tmp-bootable-iso-u-0"><a href="#mdconfig-a-t-vnode-f-tmp-bootable-iso-u-0" class="headerlink" title="mdconfig -a -t vnode -f &#x2F;tmp&#x2F;bootable.iso -u 0"></a>mdconfig -a -t vnode -f &#x2F;tmp&#x2F;bootable.iso -u 0</h1><h1 id="mount-t-cd9660-dev-md0-mnt"><a href="#mount-t-cd9660-dev-md0-mnt" class="headerlink" title="mount -t cd9660 &#x2F;dev&#x2F;md0 &#x2F;mnt"></a>mount -t cd9660 &#x2F;dev&#x2F;md0 &#x2F;mnt</h1><p>可以发现 &#x2F;mnt 和 &#x2F;tmp&#x2F;myboot 是一样的。</p>
<h4 id="1-安装所需的软件包："><a href="#1-安装所需的软件包：" class="headerlink" title="1.安装所需的软件包："></a>1.安装所需的软件包：</h4><p>[root@localhost ~]# yum -y install createrepo mkisofs isomd5sum</p>
<h4 id="2-根据当前系统已安装的软件包生成安装系统所需要的rpm列表"><a href="#2-根据当前系统已安装的软件包生成安装系统所需要的rpm列表" class="headerlink" title="2.根据当前系统已安装的软件包生成安装系统所需要的rpm列表"></a>2.根据当前系统已安装的软件包生成安装系统所需要的rpm列表</h4><p>[root@localhost ~]# awk ‘&#x2F;Installing&#x2F;{print $2}’ install.log |sed ‘s&#x2F;^[0-9]*:&#x2F;&#x2F;g’ &gt;&#x2F;root&#x2F;packages.list</p>
<h4 id="3-建立定制所需要的目录并把除Packages目录以外的文件复制到新的系统目录"><a href="#3-建立定制所需要的目录并把除Packages目录以外的文件复制到新的系统目录" class="headerlink" title="3.建立定制所需要的目录并把除Packages目录以外的文件复制到新的系统目录"></a>3.建立定制所需要的目录并把除Packages目录以外的文件复制到新的系统目录</h4><p>[root@localhost ~]# mkdir  &#x2F;mnt&#x2F;cdrom<br>[root@localhost ~]# mkdir -p &#x2F;data&#x2F;OS<br>[root@localhost ~]# mount &#x2F;dev&#x2F;cdrom &#x2F;mnt&#x2F;cdrom&#x2F;<br>[root@localhost ~]# rsync -a –exclude&#x3D;Packages &#x2F;mnt&#x2F;cdrom&#x2F; &#x2F;data&#x2F;OS&#x2F;<br>[root@localhost ~]# mkdir &#x2F;data&#x2F;OS&#x2F;Packages</p>
<h4 id="4-使用脚本自动复制所需要的RPM包到新建立的光盘目录中Packages"><a href="#4-使用脚本自动复制所需要的RPM包到新建立的光盘目录中Packages" class="headerlink" title="4.使用脚本自动复制所需要的RPM包到新建立的光盘目录中Packages"></a>4.使用脚本自动复制所需要的RPM包到新建立的光盘目录中Packages</h4><p>[root@localhost ~]# vim cprpms.sh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash  </span><br><span class="line">SRC_RPMS=/mnt/cdrom/Packages     </span><br><span class="line">DST_RPMS=/data/OS/Packages     </span><br><span class="line">packages_list=/root/packages.list </span><br><span class="line">number_of_packages=`cat $packages_list | wc -l` </span><br><span class="line">i=1 </span><br><span class="line">while [ $i -le $number_of_packages ] ; </span><br><span class="line"> do </span><br><span class="line">    name=`head -n $i $packages_list | tail -n -1` </span><br><span class="line">         echo &quot;cp $SRC_RPMS/$name* $DST_RPMS/&quot;  </span><br><span class="line">         cp $SRC_RPMS/$name* $DST_RPMS/         </span><br><span class="line">    i=`expr $i + 1` </span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p> [root@localhost ~]# sh cprpms.sh</p>
<h4 id="5-配置kickstart脚本"><a href="#5-配置kickstart脚本" class="headerlink" title="5.配置kickstart脚本"></a>5.配置kickstart脚本</h4><p>[root@localhost ~]# vim &#x2F;data&#x2F;OS&#x2F;isolinux&#x2F;ks.cfg</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">#platform=x86, AMD64, or Intel EM64T </span><br><span class="line"># Firewall configuration </span><br><span class="line">firewall --disabled </span><br><span class="line"># Install OS instead of upgrade </span><br><span class="line">install </span><br><span class="line"># Use CDROM installation media </span><br><span class="line">cdrom </span><br><span class="line"># Root password default is &quot;redhat&quot; </span><br><span class="line">rootpw --iscrypted $1$JJuQiyTA$fbBF2fBqHB1P5PpFNy5f.1</span><br><span class="line"># System authorization information </span><br><span class="line">auth  --useshadow  --passalgo=md5</span><br><span class="line"># Use text mode install </span><br><span class="line">text </span><br><span class="line">firstboot --disable </span><br><span class="line"># System keyboard </span><br><span class="line">keyboard us </span><br><span class="line"># System language </span><br><span class="line">lang en_US </span><br><span class="line"># SELinux configuration </span><br><span class="line">selinux --disabled </span><br><span class="line"># Do not configure the X Window System </span><br><span class="line">skipx </span><br><span class="line"># Installation logging level </span><br><span class="line">logging --level=info</span><br><span class="line"># Reboot after installation </span><br><span class="line">reboot </span><br><span class="line"># System timezone </span><br><span class="line">timezone  Asia/Shanghai </span><br><span class="line"># Network information </span><br><span class="line">network  --bootproto=dhcp --device=eth0 --onboot=on –noipv6 </span><br><span class="line"># System bootloader configuration </span><br><span class="line">bootloader --location=mbr</span><br><span class="line"># Clear the Master Boot Record </span><br><span class="line">zerombr </span><br><span class="line"># Partition clearing information </span><br><span class="line">clearpart --all --initlabel </span><br><span class="line"># Disk partitioning information </span><br><span class="line">ignoredisk --only-use=sda</span><br><span class="line">part /boot --fstype=&quot;ext4&quot; --size=1024</span><br><span class="line">part swap --recommended</span><br><span class="line">part / --fstype=&quot;ext4&quot; --grow --size=1</span><br><span class="line">%packages</span><br><span class="line">@additional-devel</span><br><span class="line">@base</span><br><span class="line">@core</span><br><span class="line">@debugging</span><br><span class="line">@basic-desktop</span><br><span class="line">@desktop-debugging</span><br><span class="line">@desktop-platform</span><br><span class="line">@desktop-platform-devel</span><br><span class="line">@development</span><br><span class="line">@directory-client</span><br><span class="line">@eclipse</span><br><span class="line">@emacs</span><br><span class="line">@fonts</span><br><span class="line">@general-desktop</span><br><span class="line">@graphical-admin-tools</span><br><span class="line">@graphics</span><br><span class="line">@input-methods</span><br><span class="line">@internet-browser</span><br><span class="line">@java-platform</span><br><span class="line">@legacy-x</span><br><span class="line">@network-file-system-client</span><br><span class="line">@performance</span><br><span class="line">@perl-runtime</span><br><span class="line">@print-client</span><br><span class="line">@remote-desktop-clients</span><br><span class="line">@server-platform</span><br><span class="line">@server-platform-devel</span><br><span class="line">@server-policy</span><br><span class="line">@tex</span><br><span class="line">@technical-writing</span><br><span class="line">@virtualization</span><br><span class="line">@virtualization-client</span><br><span class="line">@virtualization-platform</span><br><span class="line">@workstation-policy</span><br><span class="line">@x11</span><br><span class="line">libgcrypt-devel</span><br><span class="line">libXinerama-devel</span><br><span class="line">openmotif-devel</span><br><span class="line">libXmu-devel</span><br><span class="line">xorg-x11-proto-devel</span><br><span class="line">startup-notification-devel</span><br><span class="line">libgnomeui-devel</span><br><span class="line">libbonobo-devel</span><br><span class="line">junit</span><br><span class="line">libXau-devel</span><br><span class="line">libXrandr-devel</span><br><span class="line">popt-devel</span><br><span class="line">gnome-python2-desktop</span><br><span class="line">libdrm-devel</span><br><span class="line">libxslt-devel</span><br><span class="line">libglade2-devel</span><br><span class="line">gnutls-devel</span><br><span class="line">mtools</span><br><span class="line">pax</span><br><span class="line">python-dmidecode</span><br><span class="line">oddjob</span><br><span class="line">wodim</span><br><span class="line">sgpio</span><br><span class="line">genisoimage</span><br><span class="line">device-mapper-persistent-data</span><br><span class="line">systemtap-client</span><br><span class="line">abrt-gui</span><br><span class="line">desktop-file-utils</span><br><span class="line">ant</span><br><span class="line">rpmdevtools</span><br><span class="line">jpackage-utils</span><br><span class="line">rpmlint</span><br><span class="line">samba-winbind</span><br><span class="line">certmonger</span><br><span class="line">pam_krb5</span><br><span class="line">krb5-workstation</span><br><span class="line">netpbm-progs</span><br><span class="line">openmotif</span><br><span class="line">libXmu</span><br><span class="line">libXp</span><br><span class="line">perl-DBD-SQLite</span><br><span class="line">libvirt-java</span><br><span class="line">%end</span><br></pre></td></tr></table></figure>

<h4 id="6-让系统从kickstart配置启动安装"><a href="#6-让系统从kickstart配置启动安装" class="headerlink" title="6.让系统从kickstart配置启动安装"></a>6.让系统从kickstart配置启动安装</h4><p>[root@localhost OS]# vim &#x2F;data&#x2F;OS&#x2F;isolinux&#x2F;isolinux.cfg   #备注这里需要给执行权限，才可以编辑，默认只读；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">default ks</span><br><span class="line">prompt 1</span><br><span class="line">timeout 60</span><br><span class="line">display boot.msg</span><br><span class="line">F1 boot.msg</span><br><span class="line">F2 options.msg</span><br><span class="line">F3 general.msg</span><br><span class="line">F4 param.msg</span><br><span class="line">F5 rescue.msg</span><br><span class="line">label linux</span><br><span class="line">kernel vmlinuz</span><br><span class="line">append initrd=initrd.img</span><br><span class="line">label text</span><br><span class="line">kernel vmlinuz</span><br><span class="line">append initrd=initrd.img text</span><br><span class="line">label ks</span><br><span class="line">kernel vmlinuz</span><br><span class="line">append ks=cdrom:/isolinux/ks.cfg initrd=initrd.img</span><br><span class="line">label local</span><br><span class="line">localboot 1</span><br><span class="line">label memtest86</span><br><span class="line">kernel memtest</span><br><span class="line">append -</span><br></pre></td></tr></table></figure>

<h4 id="7-生成rpm包的依赖关系"><a href="#7-生成rpm包的依赖关系" class="headerlink" title="7.生成rpm包的依赖关系"></a>7.生成rpm包的依赖关系</h4><p>[root@localhost ~]# cd &#x2F;data&#x2F;OS&#x2F;<br>[root@localhost OS]# createrepo -g repodata&#x2F;<em>-comps.xml &#x2F;data&#x2F;OS&#x2F;<br>[root@localhost OS]# declare -x discinfo&#x3D;<code>head -1 .discinfo</code><br>[root@localhost OS]# createrepo -u “media:&#x2F;&#x2F;$discinfo” -g repodata&#x2F;</em>-comps.xml &#x2F;data&#x2F;OS&#x2F;</p>
<h4 id="8-生成ISO镜像文件"><a href="#8-生成ISO镜像文件" class="headerlink" title="8.生成ISO镜像文件"></a>8.生成ISO镜像文件</h4><p>[root@localhost ~]# cd &#x2F;data&#x2F;OS&#x2F;<br>[root@localhost OS]# mkisofs -R -J -T -r -l -d -joliet-long -allow-multidot <br> -allow-leading-dots -no-bak -o &#x2F;data&#x2F;CentOS-6.7-x86_64.iso <br> -b isolinux&#x2F;isolinux.bin -c isolinux&#x2F;boot.cat -no-emul-boot <br> -boot-load-size 4 -boot-info-table &#x2F;data&#x2F;OS</p>
<h4 id="9-生成MD5校验码"><a href="#9-生成MD5校验码" class="headerlink" title="9.生成MD5校验码"></a>9.生成MD5校验码</h4><p>[root@localhost ~]# implantisomd5 &#x2F;data&#x2F;CentOS-6.3-x86_64.iso</p>
<h4 id="10-测试"><a href="#10-测试" class="headerlink" title="10.测试"></a>10.测试</h4>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/12/Archlinux%E5%AE%89%E8%A3%85-%E8%B6%85%E8%AF%A6%E7%BB%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/12/Archlinux%E5%AE%89%E8%A3%85-%E8%B6%85%E8%AF%A6%E7%BB%86/" class="post-title-link" itemprop="url">Archlinux安装(超详细)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-12 13:12:57 / 修改时间：13:49:21" itemprop="dateCreated datePublished" datetime="2024-06-12T13:12:57+08:00">2024-06-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/vconlln/p/17065420.html">https://www.cnblogs.com/vconlln/p/17065420.html</a></p>
<h3 id="Archlinux安装与美化全流程"><a href="#Archlinux安装与美化全流程" class="headerlink" title="Archlinux安装与美化全流程"></a>Archlinux安装与美化全流程</h3><p>本文是自己写的并且搬运少部分<a target="_blank" rel="noopener" href="https://arch.icekylin.online/prologue.html%E7%9A%84%E5%86%85%E5%AE%B9">https://arch.icekylin.online/prologue.html的内容</a></p>
<h3 id="一-镜像制作"><a href="#一-镜像制作" class="headerlink" title="一. 镜像制作#"></a>一. 镜像制作#</h3><h4 id="1-下载"><a href="#1-下载" class="headerlink" title="1. 下载#"></a>1. 下载#</h4><p><a target="_blank" rel="noopener" href="https://archlinux.org/download/">Arch官方下载界面</a></p>
<p><a target="_blank" rel="noopener" href="https://mirrors.aliyun.com/archlinux/iso/">阿里云镜像站下载</a></p>
<p>注意：官网下载页面下拉可以看多很多国家的镜像源！<br>⚠️ 注意:</p>
<p>请确保下载最新的安装镜像！因为 archlinux 是滚动发行版，不存在使用旧的安装镜像安装旧版本的说法。</p>
<h4 id="2-镜像烧录"><a href="#2-镜像烧录" class="headerlink" title="2.镜像烧录#"></a>2.镜像烧录#</h4><p>准备一个 2G 以上的 U 盘，刻录一个安装盘。</p>
<h4 id="2-1-Windows"><a href="#2-1-Windows" class="headerlink" title="2.1 Windows#"></a>2.1 Windows#</h4><p>Windows 下推荐使用 Ventoy、Rufus 或者 Power ISOEULA 进行 U 盘刻录。三者皆为免费使用的软件。具体操作请自行查阅，都非常简单除此之外，如果你还嫌麻烦，还可以使用更为简单的安装盘制作工具 balenaEtcher。</p>
<h4 id="2-2-Linux"><a href="#2-2-Linux" class="headerlink" title="2.2 Linux#"></a>2.2 Linux#</h4><p>Linux 下同样可以使用 Ventoy 和 balenaEtcher，具体步骤可参阅 Ventoy（推荐） 以及 balenaEtcher。</p>
<p>也可以直接用 dd 命令进行刻录，具体步骤可参阅 dd 命令。</p>
<p>下面是使用 Rufus 进行镜像烧录</p>
<p>下载好 Rufus 后打开，插入要写入的U盘</p>
<p>然后选择要烧录系统的U盘(设备没有可选项？勾上显示USB外置硬盘即可！)</p>
<p>选择要烧录的镜像</p>
<p>分区类型选择GPT格式</p>
<p>目标系统类型选择UEFI</p>
<p>文件系统选择FAT</p>
<p>点击开始并以ISO镜像模式写入即开始镜像烧录</p>
<p>注意：烧录镜像默认会格式化U盘，请提前备份好数据！</p>
<h3 id="二-USB启动安装"><a href="#二-USB启动安装" class="headerlink" title="二. USB启动安装#"></a>二. USB启动安装#</h3><h4 id="1-启动到-Live-环境"><a href="#1-启动到-Live-环境" class="headerlink" title="1.启动到 Live 环境#"></a>1.启动到 Live 环境#</h4><p>根据ArchWiki介绍，Arch是不支持安全启动的，而一般电脑默认开启安全启动，所以需要先到BIOS里面关闭安全启动( Secure Boot )，注意需要先关闭Windows的快速启动。</p>
<p>#关闭 BIOS 设置中的 Secure Boot<br>在类似名为 security（安全）的选项卡中，找到一项名为Secure Boot（安全启动，名称可能略有差异）的选项，选择 Disable 将其禁用。<br>设置好以后将刚才烧录的U盘插入电脑，然后开机，在开机的时候，按下 F2 &#x2F; F8 &#x2F; F10 &#x2F; DEL 等（取决与你的主板型号，具体请查阅你主板的相关信息）按键，进入主板的 BIOS 设置界面。进入Live环境。选择第一项 Arch Linux install medium (x86_64, UEFI) 开始加载安装程序，如果不是类似界面，请检查BIOS设置或者U盘烧录是否正确。</p>
<p>正式进入 Arch 的 U盘系统后，对于没有怎么接触过Arch的人可能比较惊讶，为什么不是图形界面？没错，Arch 安装镜像只包含了系统一些基础组件，并没有图形界面，需要用户安装好系统之后自行安装，这样虽然麻烦，但是却给了用户更多的选择，可定制化程度更高。</p>
<h4 id="2-正式安装"><a href="#2-正式安装" class="headerlink" title="2.正式安装#"></a>2.正式安装#</h4><h5 id="2-1-禁用-reflector-服务"><a href="#2-1-禁用-reflector-服务" class="headerlink" title="2.1 禁用 reflector 服务#"></a>2.1 禁用 reflector 服务#</h5><p>2020 年，archlinux 安装镜像中加入了 reflector 服务，它会自己更新 mirrorlist（软件包管理器 pacman 的软件源）。在特定情况下，它会误删某些有用的源信息。这里进入安装环境后的第一件事就是将其禁用。也许它是一个好用的工具，但是很明显，因为地理上造成的特殊网络环境，这项服务并不适合启用。</p>
<p>1.通过以下命令将该服务禁用：</p>
<p>systemctl stop reflector.service<br>2.通过以下命令查看该服务是否被禁用，按下 q 退出结果输出：</p>
<p>systemctl status reflector.service</p>
<h5 id="2-2-检查是否UEFI启动"><a href="#2-2-检查是否UEFI启动" class="headerlink" title="2.2 检查是否UEFI启动#"></a>2.2 检查是否UEFI启动#</h5><p>ArchLinux 只支持UEFI模式启动的电脑，所以第一步便是检查当前电脑是否为UEFI启动，在终端输入以下命令。如果出现大量文件则正常否则该电脑可能不支持安装ArchLinux。</p>
<p>ls &#x2F;sys&#x2F;firmware&#x2F;efi&#x2F;efivars</p>
<h1 id="提示：如果没有报错就是支持UEFI"><a href="#提示：如果没有报错就是支持UEFI" class="headerlink" title="提示：如果没有报错就是支持UEFI"></a>提示：如果没有报错就是支持UEFI</h1><p>若输出了一堆东西（efi 变量），则说明已在 UEFI 模式。否则请确认你的启动方式是否为 UEFI。</p>
<h4 id="2-3-连接网络"><a href="#2-3-连接网络" class="headerlink" title="2.3 连接网络#"></a>2.3 连接网络#</h4><p>防止网卡被禁用，使用以下命令解除网卡禁用：</p>
<p>rfkill unblock all<br>usb直连：ArchLinux安装需要下载一些软件，需要保证网络通畅，ArchLinux不会默认连接网络，建议手机开usb热点电脑连接，不用额外配置。</p>
<p>wifi 连接：输入 iwctl 进入wifi连接界面：</p>
<p>#是否启用了网络接口<br>ip link<br>#执行iwctl命令，进入交互式命令行<br>iwctl<br>————-下面为iwctl界面，不同于终端———–<br>[iwd] help   # 输入help回车可以查看使用说明<br>[iwd] device list # 回车后可以查看当前网卡设备，一般为 wlan0<br>[iwd] station <device> scan # <device>替换为上面的网卡设备，这条命令可以让网卡扫描wifi设备<br>[iwd] station <device> get-networks  # 回车后可以显示当前可连接网络，列出所有 wifi 网络<br>[iwd] station <device> connect <wifi name>  # 连接wifi, <wifi name> 为上面获取的wifi名称，注意这里无法输入中文。回车后输入密码即可<br>password: # 如果wifi为加密wifi,输入密码回车<br>[iwd] exit或者quit # 退出 wifi 连接界面<br>测试网络是否连接成功：</p>
<p>ping <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> -n</p>
<h4 id="2-4-更新系统时间"><a href="#2-4-更新系统时间" class="headerlink" title="2.4 更新系统时间#"></a>2.4 更新系统时间#</h4><p>更新系统时间是有必要的，因为下载软件是服务器会验证系统时间，如果时间不正确，可能出现下载失败的情况，输入以下命令同步系统时间为准确时间：</p>
<p>timedatectl set-ntp true # 将系统时间与网络时间进行同步<br>timedatectl status		 # 查看系统时间状态，检查是否成功 看到（system clock synchronized :yes）这一句就是成功了</p>
<h4 id="2-5-换源"><a href="#2-5-换源" class="headerlink" title="2.5 换源#"></a>2.5 换源#</h4><p>为保证安全与方便，Linux系统绝大多数软件都是在官方网站下载的，但是ArchLinux官方网站在国外，国内访问的话有点慢，国内有专门的镜像站可以直接从国内服务器下载软件包，就相当于在官网下载的并且镜像站都是每天更新，软件包也是最新的。</p>
<p>ℹ️ 提示</p>
<p>如果不会使用 vim 编辑器，请参阅 这里。vim 编辑器在安装和配置系统的过程中还需要使用多次。</p>
<h1 id="备份原来的配置文件"><a href="#备份原来的配置文件" class="headerlink" title="备份原来的配置文件"></a>备份原来的配置文件</h1><p>cp -a &#x2F;etc&#x2F;pacman.d&#x2F;mirrorlist &#x2F;etc&#x2F;pacman.d&#x2F;mirrorlist.bak</p>
<h1 id="编辑配置文件"><a href="#编辑配置文件" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h1><p>vim &#x2F;etc&#x2F;pacman.d&#x2F;mirrorlist</p>
<h1 id="—————下面为vim操作，不同于终端————"><a href="#—————下面为vim操作，不同于终端————" class="headerlink" title="—————下面为vim操作，不同于终端————-"></a>—————下面为vim操作，不同于终端————-</h1><h1 id="找到第一个-Server-…-的行在该行上一行写入以下内容"><a href="#找到第一个-Server-…-的行在该行上一行写入以下内容" class="headerlink" title="找到第一个 Server&#x3D;… 的行在该行上一行写入以下内容"></a>找到第一个 Server&#x3D;… 的行在该行上一行写入以下内容</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch">https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</a> # 中国科学技术大学开源镜像站<br>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch">https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch</a> # 清华大学开源软件镜像站<br>Server &#x3D; <a target="_blank" rel="noopener" href="https://repo.huaweicloud.com/archlinux/$repo/os/$arch">https://repo.huaweicloud.com/archlinux/$repo/os/$arch</a> # 华为开源镜像站<br>Server &#x3D; <a target="_blank" rel="noopener" href="http://mirror.lzu.edu.cn/archlinux/$repo/os/$arch">http://mirror.lzu.edu.cn/archlinux/$repo/os/$arch</a> # 兰州大学开源镜像站<br>Server &#x3D; <a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/archlinux/$repo/os/$arch">http://mirrors.aliyun.com/archlinux/$repo/os/$arch</a> # 阿里云镜像站</p>
<h1 id="————————————————–"><a href="#————————————————–" class="headerlink" title="————————————————–"></a>————————————————–</h1><p>#也可以按&#x2F;，搜索China,找到中科大的镜像源,然后2dd 剪切2行，再按GG回到第一行，按 p 粘贴<br>更新软件包</p>
<p>pacman -Syy</p>
<h4 id="2-6-硬盘分区"><a href="#2-6-硬盘分区" class="headerlink" title="2.6 硬盘分区#"></a>2.6 硬盘分区#</h4><p>分区就是为了上面讲到的挂载，不同分区有不同的大小，呈现在文件系统里面就是不同目录有不同大小，下面是我安装 ArchLinux 时的分区情况：</p>
<h1 id="efi-gpt"><a href="#efi-gpt" class="headerlink" title="efi + gpt"></a>efi + gpt</h1><p>&#x2F;分区:      150G   挂载目录： &#x2F;	类型：Linux filesystem    作用：存放系统其他文件<br>&#x2F;home分区： 300G   挂载目录：&#x2F;home    类型：Linux Home      作用：存放用户文件，&#x2F;home&#x2F;用户名 为指定用户根目录<br>boot分区：   1G	挂载目录： &#x2F;boot    类型：EFI System      作用：引导文件存放<br>swap分区：   16G   挂载目录：无        类型：Linux Swap      作用：系统恢复分区，系统挂起或内存不足时可能会被当作 ROM 使用</p>
<h1 id="biso-mbr"><a href="#biso-mbr" class="headerlink" title="biso + mbr"></a>biso + mbr</h1><p>&#x2F;分区:      150G   挂载目录： &#x2F;		类型：Linux     作用：存放系统其他文件<br>&#x2F;home分区： 300G   挂载目录：&#x2F;home     类型：Linux      作用：存放用户文件，&#x2F;home&#x2F;用户名 为指定用户根目录<br>swap分区：   16G   挂载目录：无        类型：Linux Swap      作用：系统恢复分区，系统挂起或内存不足时可能会被当作 ROM 使用<br>自己可以根据自己的具体情况合理分配，不过我还是建议 &#x2F;boot 分区不小于800M，&#x2F;分区不小于30G，这是Arch官方推荐情况。</p>
<p>下面命令用来查看系统的分区情况：</p>
<p>#查看磁盘分区<br>lsblk<br>#分区<br>fdisk -l<br>我的ArchLinux安装到 &#x2F;dev&#x2F;nvme0n1 (后面的p1 p2这些就是分区，外接U盘一般为&#x2F;dev&#x2F;sdx1 &#x2F;dev&#x2F;sdx2等)，输入 cfdisk &#x2F;dev&#x2F;nvme0n1 进入分区界面</p>
<p>cfdisk &#x2F;dev&#x2F;nvme0n1</p>
<h1 id="———————-cfdisk界面———————"><a href="#———————-cfdisk界面———————" class="headerlink" title="———————-cfdisk界面———————"></a>———————-cfdisk界面———————</h1><h1 id="cfdisk-是图形化的分区，比fdisk简单很多"><a href="#cfdisk-是图形化的分区，比fdisk简单很多" class="headerlink" title="cfdisk 是图形化的分区，比fdisk简单很多"></a>cfdisk 是图形化的分区，比fdisk简单很多</h1><h1 id="下面有一行操作文件，通过左右方向键可以移动到不同选项。上下方向键可以选择不同分区进行操作"><a href="#下面有一行操作文件，通过左右方向键可以移动到不同选项。上下方向键可以选择不同分区进行操作" class="headerlink" title="下面有一行操作文件，通过左右方向键可以移动到不同选项。上下方向键可以选择不同分区进行操作"></a>下面有一行操作文件，通过左右方向键可以移动到不同选项。上下方向键可以选择不同分区进行操作</h1><h1 id="New-选项为新建分区，将方向键选择到未分配的分区，选择-New-选项，回车后会提示新分区大小，输入大小即可创建一个新的分区"><a href="#New-选项为新建分区，将方向键选择到未分配的分区，选择-New-选项，回车后会提示新分区大小，输入大小即可创建一个新的分区" class="headerlink" title="[New]选项为新建分区，将方向键选择到未分配的分区，选择[New]选项，回车后会提示新分区大小，输入大小即可创建一个新的分区"></a>[New]选项为新建分区，将方向键选择到未分配的分区，选择[New]选项，回车后会提示新分区大小，输入大小即可创建一个新的分区</h1><h1 id="Quit-可以退出-cfdisk-，并且不保存修改，也就是之前做的操作一律作废"><a href="#Quit-可以退出-cfdisk-，并且不保存修改，也就是之前做的操作一律作废" class="headerlink" title="[Quit]可以退出 cfdisk ，并且不保存修改，也就是之前做的操作一律作废"></a>[Quit]可以退出 cfdisk ，并且不保存修改，也就是之前做的操作一律作废</h1><h1 id="Help-选项可以查看-cfdisk-帮助"><a href="#Help-选项可以查看-cfdisk-帮助" class="headerlink" title="[Help]选项可以查看 cfdisk 帮助"></a>[Help]选项可以查看 cfdisk 帮助</h1><h1 id="Write-选项才是真的执行写入操作，使用后会对操作的磁盘执行写入，以前做的修改会生效"><a href="#Write-选项才是真的执行写入操作，使用后会对操作的磁盘执行写入，以前做的修改会生效" class="headerlink" title="[Write]选项才是真的执行写入操作，使用后会对操作的磁盘执行写入，以前做的修改会生效"></a>[Write]选项才是真的执行写入操作，使用后会对操作的磁盘执行写入，以前做的修改会生效</h1><h1 id="Type-选项可以改变分区类型，boot分区选择EFI分区类型，根分区和home分区选ext4类型，swap分区选择Linux-swap类型"><a href="#Type-选项可以改变分区类型，boot分区选择EFI分区类型，根分区和home分区选ext4类型，swap分区选择Linux-swap类型" class="headerlink" title="[Type]选项可以改变分区类型，boot分区选择EFI分区类型，根分区和home分区选ext4类型，swap分区选择Linux swap类型"></a>[Type]选项可以改变分区类型，boot分区选择EFI分区类型，根分区和home分区选ext4类型，swap分区选择Linux swap类型</h1><p>分区可以按照上面列出的方案，swap可以不要，但是 boot分区、根分区和home分区是必须的。分好后记得选择 [Write] 写入之后再选择 [Quit] 退出，分区错误可以选择 [Delete] 删除分区之后重新分配，写入前请再三检查，特别是选择双系统安装的，不要把其他系统数据删除了。分区完成后输入 fdisk -l 查看分区。</p>
<h4 id="2-7-格式化分区"><a href="#2-7-格式化分区" class="headerlink" title="2.7 格式化分区#"></a>2.7 格式化分区#</h4><p>上面的操作只是分区，需要进行格式化，不同分区需要不同的格式。格式化分区会删除所有数据，千万小心操作！</p>
<p>一般分区都有跟分区（&#x2F;）、交换分区（swap）、引导分区（boot）</p>
<p>格式化根分区和home分区：根分区和home分区都是Linux常见的 ext4 格式</p>
<p>Btrfs格式可以看这个</p>
<h1 id="为你刚才分区时指定的分区，如果忘记可以使用-fdisk-l-查看"><a href="#为你刚才分区时指定的分区，如果忘记可以使用-fdisk-l-查看" class="headerlink" title=" 为你刚才分区时指定的分区，如果忘记可以使用 fdisk -l 查看"></a><disk> 为你刚才分区时指定的分区，如果忘记可以使用 fdisk -l 查看</h1><p>mkfs.ext4 &#x2F;dev&#x2F;<disk> </p>
<h1 id="例如："><a href="#例如：" class="headerlink" title="例如："></a>例如：</h1><h1 id="mkfs-ext4-dev-nvme0n1p1"><a href="#mkfs-ext4-dev-nvme0n1p1" class="headerlink" title="mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p1"></a>mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p1</h1><h1 id="mkfs-ext4-dev-nvme0n1p2"><a href="#mkfs-ext4-dev-nvme0n1p2" class="headerlink" title="mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p2"></a>mkfs.ext4 &#x2F;dev&#x2F;nvme0n1p2</h1><p>格式化boot分区：引导分区采用的是FAT格式</p>
<h1 id="为你刚才分区时指定的分区，如果忘记可以使用-fdisk-l-查看-1"><a href="#为你刚才分区时指定的分区，如果忘记可以使用-fdisk-l-查看-1" class="headerlink" title=" 为你刚才分区时指定的分区，如果忘记可以使用 fdisk -l 查看"></a><disk> 为你刚才分区时指定的分区，如果忘记可以使用 fdisk -l 查看</h1><p>mkfs.fat -F 32 &#x2F;dev&#x2F;<disk> 或者 mkfs.vfat &#x2F;dev&#x2F;sda1</p>
<h1 id="例如：-1"><a href="#例如：-1" class="headerlink" title="例如："></a>例如：</h1><h1 id="mkfs-fat-F-32-dev-nvme0n1p3"><a href="#mkfs-fat-F-32-dev-nvme0n1p3" class="headerlink" title="mkfs.fat -F 32 &#x2F;dev&#x2F;nvme0n1p3"></a>mkfs.fat -F 32 &#x2F;dev&#x2F;nvme0n1p3</h1><p>格式化swap分区：交换分区不需要挂载，采用特定格式</p>
<p>mkswap &#x2F;dev&#x2F;<device></p>
<h1 id="例如：-2"><a href="#例如：-2" class="headerlink" title="例如："></a>例如：</h1><h1 id="mkswap-dev-nvme0n1p4"><a href="#mkswap-dev-nvme0n1p4" class="headerlink" title="mkswap &#x2F;dev&#x2F;nvme0n1p4"></a>mkswap &#x2F;dev&#x2F;nvme0n1p4</h1><h4 id="2-8-挂载分区"><a href="#2-8-挂载分区" class="headerlink" title="2.8 挂载分区#"></a>2.8 挂载分区#</h4><p>根据上面的分区方案，将不同分区挂载到不同目录</p>
<h1 id="假设分区方案为："><a href="#假设分区方案为：" class="headerlink" title="假设分区方案为："></a>假设分区方案为：</h1><h1 id="根分区-dev-nvme0n1p1"><a href="#根分区-dev-nvme0n1p1" class="headerlink" title="根分区     -&gt;   &#x2F;         -&gt;  &#x2F;dev&#x2F;nvme0n1p1"></a>根分区     -&gt;   &#x2F;         -&gt;  &#x2F;dev&#x2F;nvme0n1p1</h1><h1 id="home分区-home-dev-nvme0n1p2"><a href="#home分区-home-dev-nvme0n1p2" class="headerlink" title="home分区   -&gt;   &#x2F;home     -&gt;  &#x2F;dev&#x2F;nvme0n1p2"></a>home分区   -&gt;   &#x2F;home     -&gt;  &#x2F;dev&#x2F;nvme0n1p2</h1><h1 id="boot分区-boot-dev-nvme0n1p3"><a href="#boot分区-boot-dev-nvme0n1p3" class="headerlink" title="boot分区   -&gt;   &#x2F;boot     -&gt;  &#x2F;dev&#x2F;nvme0n1p3"></a>boot分区   -&gt;   &#x2F;boot     -&gt;  &#x2F;dev&#x2F;nvme0n1p3</h1><h1 id="swap分区-不挂载-dev-nvme0n1p4"><a href="#swap分区-不挂载-dev-nvme0n1p4" class="headerlink" title="swap分区   -&gt;   不挂载    -&gt;   &#x2F;dev&#x2F;nvme0n1p4"></a>swap分区   -&gt;   不挂载    -&gt;   &#x2F;dev&#x2F;nvme0n1p4</h1><h1 id="Linux分区由根分区开始，所以必须先挂载根目录-才能挂载其他目录，然后创建文件夹，挂载"><a href="#Linux分区由根分区开始，所以必须先挂载根目录-才能挂载其他目录，然后创建文件夹，挂载" class="headerlink" title="Linux分区由根分区开始，所以必须先挂载根目录 才能挂载其他目录，然后创建文件夹，挂载"></a>Linux分区由根分区开始，所以必须先挂载根目录 才能挂载其他目录，然后创建文件夹，挂载</h1><h1 id="挂载-目录"><a href="#挂载-目录" class="headerlink" title="挂载 &#x2F; 目录"></a>挂载 &#x2F; 目录</h1><p>mount &#x2F;dev&#x2F;nvme0n1p1 &#x2F;mnt</p>
<h1 id="创建-home-目录"><a href="#创建-home-目录" class="headerlink" title="创建 &#x2F;home 目录"></a>创建 &#x2F;home 目录</h1><p>mkdir &#x2F;mnt&#x2F;home<br>mount &#x2F;dev&#x2F;nvme0n1p2 &#x2F;mnt&#x2F;home # 挂载 &#x2F;home 目录</p>
<h1 id="创建-mnt-boot-目录"><a href="#创建-mnt-boot-目录" class="headerlink" title="创建 &#x2F;mnt&#x2F;boot 目录"></a>创建 &#x2F;mnt&#x2F;boot 目录</h1><p>mkdir &#x2F;mnt&#x2F;boot<br>mount &#x2F;dev&#x2F;nvme0n1p3 &#x2F;mnt&#x2F;boot # 挂载 &#x2F;mnt&#x2F;boot 目录</p>
<h1 id="挂载交换分区"><a href="#挂载交换分区" class="headerlink" title="挂载交换分区"></a>挂载交换分区</h1><p>swapon &#x2F;dev&#x2F;nvme0n1p4<br>使用 df 命令复查挂载情况：</p>
<p>df -h<br>使用 free 命令复查 Swap 分区挂载情况：</p>
<p>free -h # -h 选项会使输出以人类可读的单位显示</p>
<h4 id="2-9-安装系统"><a href="#2-9-安装系统" class="headerlink" title="2.9 安装系统#"></a>2.9 安装系统#</h4><p>1.主要安装基本系统和几个待会需要用到的工具。等待安装完成，如果没有报错可以进行下一步,通过如下命令使用 pacstrap 脚本安装基础包：</p>
<p>#往&#x2F;mnt目录里安装系统<br>#其中最基础的四个包是base base-devel linux linux-firmware<br>#linux-lts （lts:稳定版）</p>
<h1 id="如果内核安装了稳定版，那么独显也要是稳定版的，要不然就会发生问题（我也不知道什么问题）"><a href="#如果内核安装了稳定版，那么独显也要是稳定版的，要不然就会发生问题（我也不知道什么问题）" class="headerlink" title="如果内核安装了稳定版，那么独显也要是稳定版的，要不然就会发生问题（我也不知道什么问题）"></a>如果内核安装了稳定版，那么独显也要是稳定版的，要不然就会发生问题（我也不知道什么问题）</h1><p>pacstrap &#x2F;mnt base base-devel linux linux-firmware<br>vim git dhcpcd e2fsprogs iwd<br>如果用了旧版镜像导致无法下载，一般显示GDP密钥出错，出现“User is unknown trust, installation failed“。先要安装最新密钥pacman -S archlinux-keyring。如果不是这个问题，就更新一下签名：pacman-key –refresh-keys</p>
<p>📑 命令参数说明：</p>
<p>base-devel —— base-devel 在 AUR 包的安装过程中是必须用到的<br>linux —— 内核软件包，这里建议先不要替换为其它内核<br>2.通过如下命令使用 pacstrap 脚本安装其它必要的功能性软件：</p>
<p>pacstrap &#x2F;mnt dhcpcd iwd vim sudo bash bash-completions ntfs-3g gvfs-mtp<br>📑 命令参数说明：</p>
<p>bash —— bash-completions 如果你是 zsh 的爱好者，请把这两个包换成zsh-completion</p>
<h4 id="2-10-生成文件系统表"><a href="#2-10-生成文件系统表" class="headerlink" title="2.10 生成文件系统表#"></a>2.10 生成文件系统表#</h4><p>fstab 用来定义磁盘分区。它是 Linux 系统中重要的文件之一。使用 genfstab 自动根据当前挂载情况生成并写入 fstab 文件。文件系统表主要用于系统启动时自动挂载分区，不然系统无法正常启动！执行以下命令生成</p>
<h1 id="生成-fstab文件-用-U-或-L-选项设置-UUID-或卷标"><a href="#生成-fstab文件-用-U-或-L-选项设置-UUID-或卷标" class="headerlink" title="生成 fstab文件 (用 -U 或 -L 选项设置 UUID 或卷标)"></a>生成 fstab文件 (用 <code>-U</code> 或 <code>-L</code> 选项设置 UUID 或卷标)</h1><h1 id="efi-gpt-1"><a href="#efi-gpt-1" class="headerlink" title="efi + gpt"></a>efi + gpt</h1><p>genfstab -U &#x2F;mnt &gt;&gt; &#x2F;mnt&#x2F;etc&#x2F;fstab</p>
<h1 id="biso-mbr-1"><a href="#biso-mbr-1" class="headerlink" title="biso + mbr"></a>biso + mbr</h1><p>genfstab -p &#x2F;mnt &gt;&gt; &#x2F;mnt&#x2F;etc&#x2F;fstab</p>
<h1 id="查看是否生成"><a href="#查看是否生成" class="headerlink" title="查看是否生成"></a>查看是否生成</h1><p>cat &#x2F;mnt&#x2F;etc&#x2F;fstab<br>到这一步基本系统安装已经完成，但是还没有对系统进行配置，所以现在还没到关机重启的时候。执行以下命令进入到我们安装的系统，对系统进行配置</p>
<p>arch-chroot &#x2F;mnt<br>此时，原来安装盘下的 &#x2F;mnt 目录就变成了新系统的 &#x2F; 目录。同时，可以发现命令行的提示符颜色和样式也发生了改变。</p>
<h4 id="2-11-设置时区"><a href="#2-11-设置时区" class="headerlink" title="2.11 设置时区#"></a>2.11 设置时区#</h4><p>设置上海为时区，并同步硬件时钟</p>
<p>ln -sf &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F;Asia&#x2F;Shanghai &#x2F;etc&#x2F;localtime</p>
<h1 id="同步硬件时钟"><a href="#同步硬件时钟" class="headerlink" title="同步硬件时钟"></a>同步硬件时钟</h1><p>hwclock –systohc</p>
<h4 id="2-12-本地化"><a href="#2-12-本地化" class="headerlink" title="2.12 本地化#"></a>2.12 本地化#</h4><p>程序和库如果需要本地化，需要依赖 local区域设置 ，local明确规定了地域、货币、时区日期的格式、字符排列方式和其他本地化标准。有两种办法，任选方案（1）和（2）中一个就行，推荐使用方法（1）</p>
<p>（1）在这两个文件设置：locale.gen 与 locale.conf。</p>
<p>编辑vim &#x2F;etc&#x2F;locale.gen，然后去掉 en_US.UTF-8 UTF-8 以及 zh_CN.UTF-8 UTF-8 行前的注释符号（#）：</p>
<p>接着执行 locale-gen 以生成 locale 信息：</p>
<h1 id="更新locale"><a href="#更新locale" class="headerlink" title="更新locale"></a>更新locale</h1><p>locale-gen<br>然后创建 locale.conf 文件，并编辑设定 LANG 变量，比如：</p>
<p>vim &#x2F;etc&#x2F;locale.conf<br>LANG&#x3D;en_US.UTF-8<br>（2）在这两个文件设置：locale.gen 与 locale.conf。</p>
<p>先生成 local 信息:</p>
<h1 id="取消注释"><a href="#取消注释" class="headerlink" title="取消注释"></a>取消注释</h1><p>sed -i ‘s&#x2F;^#en_US.UTF-8&#x2F;en_US.UTF-8&#x2F;‘ &#x2F;etc&#x2F;locale.gen<br>sed -i ‘s&#x2F;^#zh_CN.UTF-8&#x2F;zh_CN.UTF-8&#x2F;‘ &#x2F;etc&#x2F;locale.gen</p>
<h1 id="生成-Local"><a href="#生成-Local" class="headerlink" title="生成 Local"></a>生成 Local</h1><p>locale-gen<br>创建 locale.conf 文件，并编辑设定 LANG 变量</p>
<h1 id="这里不建议将-en-US-UTF-8-改为zh-CN-UTF-8-，这样会导致终端乱码！"><a href="#这里不建议将-en-US-UTF-8-改为zh-CN-UTF-8-，这样会导致终端乱码！" class="headerlink" title="这里不建议将 en_US.UTF-8 改为zh_CN.UTF-8 ，这样会导致终端乱码！"></a>这里不建议将 en_US.UTF-8 改为zh_CN.UTF-8 ，这样会导致终端乱码！</h1><p>echo “LANG&#x3D;en_US.UTF-8” &gt;&gt; &#x2F;etc&#x2F;locale.conf<br>echo “LANG&#x3D;en_US.UTF-8” &gt;&gt; &#x2F;etc&#x2F;profile</p>
<h4 id="2-13-主机名与hosts配置"><a href="#2-13-主机名与hosts配置" class="headerlink" title="2.13 主机名与hosts配置#"></a>2.13 主机名与hosts配置#</h4><h1 id="这里可以换成自己想要的名字，将主机名写入-etc-hostname"><a href="#这里可以换成自己想要的名字，将主机名写入-etc-hostname" class="headerlink" title="这里可以换成自己想要的名字，将主机名写入&#x2F;etc&#x2F;hostname"></a>这里可以换成自己想要的名字，将主机名写入&#x2F;etc&#x2F;hostname</h1><p>echo “ArchLinux” &gt;&gt; &#x2F;etc&#x2F;hostname</p>
<h1 id="将-下面hostname换成自己的主机名，与-etc-hostname-里面的名字一样"><a href="#将-下面hostname换成自己的主机名，与-etc-hostname-里面的名字一样" class="headerlink" title="将 下面hostname换成自己的主机名，与 &#x2F;etc&#x2F;hostname 里面的名字一样"></a>将 下面hostname换成自己的主机名，与 &#x2F;etc&#x2F;hostname 里面的名字一样</h1><p>echo -e “127.0.0.1  localhost\n::1  localhost\n127.0.1.1 ArchLinux.localdomain  ArchLinux” &gt;&gt; &#x2F;etc&#x2F;hosts<br>如果不想使用命令，也可以直接用vim创建文件：</p>
<p>利用vim创建hostname文件:</p>
<p>vim &#x2F;etc&#x2F;hostname<br>ArchLinux（主机名）<br>创建hosts文件：</p>
<p>vim &#x2F;etc&#x2F;hosts<br>127.0.0.1   localhost<br>::1         localhost<br>127.0.1.1   ArchLinux.localdomain	ArchLinux</p>
<h4 id="2-14-设置root密码"><a href="#2-14-设置root密码" class="headerlink" title="2.14 设置root密码#"></a>2.14 设置root密码#</h4><p>虽然现在可以使用root，但是新系统里面我们还不知道root的密码，使用下面的命令更改root密码</p>
<h1 id="会提示输入两次密码，关乎系统安全请牢记"><a href="#会提示输入两次密码，关乎系统安全请牢记" class="headerlink" title="会提示输入两次密码，关乎系统安全请牢记"></a>会提示输入两次密码，关乎系统安全请牢记</h1><p>passwd root</p>
<h4 id="2-15-安装引导程序"><a href="#2-15-安装引导程序" class="headerlink" title="2.15 安装引导程序#"></a>2.15 安装引导程序#</h4><p>需要安装 Linux 引导加载程序,才能在安装后启动系统</p>
<p>安装intel或amd：</p>
<h1 id="查看cpu型号"><a href="#查看cpu型号" class="headerlink" title="查看cpu型号"></a>查看cpu型号</h1><p>cat &#x2F;proc&#x2F;cpuinfo</p>
<h1 id="amd-电脑安装"><a href="#amd-电脑安装" class="headerlink" title="amd 电脑安装"></a>amd 电脑安装</h1><p>pacman -S amd-ucode</p>
<h1 id="intel-电脑安装"><a href="#intel-电脑安装" class="headerlink" title="intel 电脑安装"></a>intel 电脑安装</h1><p>pacman -S intel-ucode<br>配置grub：</p>
<h1 id="Arch使用grub2管理引导，安装相关程序"><a href="#Arch使用grub2管理引导，安装相关程序" class="headerlink" title="Arch使用grub2管理引导，安装相关程序"></a>Arch使用grub2管理引导，安装相关程序</h1><h1 id="efi-gpt-2"><a href="#efi-gpt-2" class="headerlink" title="efi + gpt"></a>efi + gpt</h1><p>pacman -S grub efibootmgr efivar os-prober</p>
<h1 id="biso-mbr-2"><a href="#biso-mbr-2" class="headerlink" title="biso + mbr"></a>biso + mbr</h1><p>pacman -S grub efivar os-prober<br>📑 命令参数说明：</p>
<p>-S 选项后指定要通过 pacman:</p>
<p>包管理器安装的包：</p>
<p>grub —— 启动引导器<br>efibootmgr —— efibootmgr 被 grub 脚本用来将启动项写入 NVRAM<br>os-prober —— 为了能够引导 win10，需要安装 os-prober 以检测到它<br>安装引导：</p>
<h1 id="–bootloader-id-name-其中-name-可以更改为自己想要的名称，建议简短明确"><a href="#–bootloader-id-name-其中-name-可以更改为自己想要的名称，建议简短明确" class="headerlink" title="–bootloader-id&#x3D;name  其中 name 可以更改为自己想要的名称，建议简短明确"></a>–bootloader-id&#x3D;name  其中 name 可以更改为自己想要的名称，建议简短明确</h1><h1 id="efi-gpt-3"><a href="#efi-gpt-3" class="headerlink" title="efi + gpt"></a>efi + gpt</h1><p>grub-install –target&#x3D;x86_64-efi –efi-directory&#x3D;&#x2F;boot –bootloader-id&#x3D;Arch –recheck</p>
<h1 id="biso-mbr-3"><a href="#biso-mbr-3" class="headerlink" title="biso + mbr"></a>biso + mbr</h1><p>grub-install –target&#x3D;i386-pc &#x2F;dev&#x2F;nvme0n1<br>#说明<br>grub-install <em>安装grub</em></p>
<p>–target&#x3D;x86_64-efi      <em>目标架构x86架构64位 efi启动方式  若不确定使用uname -a 可以查看</em></p>
<p>–efi-directory&#x3D;&#x2F;boot      <em>就是我sda1挂载的&#x2F;boot位置</em>,将 grubx64.efi 安装到之前的指定位置（EFI 分区）</p>
<p>–bootloader-id&#x3D;Arch     <em>这里的Arch名字可以自行更改 甚至这一段都可以不用写</em><br>接下来使用 vim 编辑 &#x2F;etc&#x2F;default&#x2F;grub 文件：</p>
<p>vim &#x2F;etc&#x2F;default&#x2F;grub<br>进行如下修改：</p>
<p>去掉 GRUB_CMDLINE_LINUX_DEFAULT 一行中最后的 quiet 参数<br>把 loglevel 的数值从 3 改成 5。这样是为了后续如果出现系统错误，方便排错<br>加入 nowatchdog 参数，这可以显著提高开关机速度<br>grub2默认禁用了 os-prober ，如果你是选择的双系统或多系统安装，需要手动开启该选项，os-prober 可以检查其他硬盘上的其他系统引导，如果不开启，可能无法识别其他系统，如果你是全盘单系统安装，可以忽略这个选项</p>
<h1 id="需要开启-os-prober-执行下面命令"><a href="#需要开启-os-prober-执行下面命令" class="headerlink" title="需要开启 os-prober 执行下面命令"></a>需要开启 os-prober 执行下面命令</h1><p>echo “GRUB_DISABLE_OS_PROBER&#x3D;false” &gt;&gt; &#x2F;etc&#x2F;default&#x2F;grub<br>生成引导配置文件：</p>
<p>grub-mkconfig -o &#x2F;boot&#x2F;grub&#x2F;grub.cfg<br>如果出现错误，请回头检查命令是否输入错误或者配置是否出错，安装时的一点错误都可能成为你无法开机的原因或者以后使用时的bug。如果检查没有问题，那么我们就可以进行最后的一点设置了。</p>
<h4 id="2-16-配置开机启动项"><a href="#2-16-配置开机启动项" class="headerlink" title="2.16 配置开机启动项#"></a>2.16 配置开机启动项#</h4><p>ArchLinux 使用 systemd 管理后台服务，我们希望开机之后自动连接网络，所以需要下载联网程序并设置开机自启动：</p>
<h1 id="下载wifi-管理"><a href="#下载wifi-管理" class="headerlink" title="下载wifi 管理"></a>下载wifi 管理</h1><p>pacman -S dhcpcd iwd networkmanager<br>pacman -S vim sudo bash-completion  iproute2  neofetch yay zsh fish</p>
<h1 id="设置开机自启动"><a href="#设置开机自启动" class="headerlink" title="设置开机自启动"></a>设置开机自启动</h1><p>systemctl enable dhcpcd<br>systemctl enable iwd<br>systemctl enable NetworkManager</p>
<h4 id="2-17-新建用户"><a href="#2-17-新建用户" class="headerlink" title="2.17 新建用户#"></a>2.17 新建用户#</h4><p>开机之后会显示一个终端的登陆界面，由于我们刚才安装时没有新建用户，默认只有一个root用户，所以我们直接使用 root 和 root 密码登录。运行以下命令新建用户：</p>
<h1 id="为你自己的用户名，登录用，注意用户名必须全小写"><a href="#为你自己的用户名，登录用，注意用户名必须全小写" class="headerlink" title=" 为你自己的用户名，登录用，注意用户名必须全小写"></a><username> 为你自己的用户名，登录用，注意用户名必须全小写</h1><p>useradd -m -G wheel -s &#x2F;bin&#x2F;bash <username></p>
<h1 id="设置用户密码"><a href="#设置用户密码" class="headerlink" title="设置用户密码"></a>设置用户密码</h1><p>passwd <username><br>📑 命令参数说明：</p>
<p>-m 创建用户的同时创建用户家目录<br>-G选项后指定附加组<br>wheel —— wheel 附加组可 sudo 进行提权<br>-s 选项后指定 shell 程序<br>myusername —— 用户名（请自定义，但不要包含空格和特殊字符）<br>使用 vim 编辑器通过 visudo 命令编辑 sudoers 文件：</p>
<p>EDITOR&#x3D;vim visudo # 这里需要显式的指定编辑器，因为上面的环境变量还未生效<br>找到如下这样的一行，把前面的注释符号 # 去掉：</p>
<p>#%wheel ALL&#x3D;(ALL) ALL<br>📑 这里稍微解释一下：</p>
<p>%wheel —— 用户名或用户组，此处则代表是 wheel 组，% 是用户组的前缀<br>ALL&#x3D; —— 主机名，此处则代表在所有主机上都生效（如果把同样的 sudoers 文件下发到了多个主机上）<br>(ALL) —— 用户名，此处则代表可以成为任意目标用户<br>最后的 ALL —— 代表可以执行任意命令</p>
<h4 id="2-18-结束"><a href="#2-18-结束" class="headerlink" title="2.18 结束#"></a>2.18 结束#</h4><p>到了这里ArchLinux的安装也就到了尾声，接下来你只需要退出安装程序，然后取消挂载分区，重启选择Arch系统就可以进入ArchLinux了</p>
<h1 id="退出arch-root-安装环境"><a href="#退出arch-root-安装环境" class="headerlink" title="退出arch root 安装环境"></a>退出arch root 安装环境</h1><p>exit</p>
<h1 id="取消挂载"><a href="#取消挂载" class="headerlink" title="取消挂载"></a>取消挂载</h1><p>umount -R &#x2F;mnt</p>
<h1 id="重启并拔出U盘"><a href="#重启并拔出U盘" class="headerlink" title="重启并拔出U盘"></a>重启并拔出U盘</h1><p>reboot</p>
<h3 id="三-安装图形界面-KDE"><a href="#三-安装图形界面-KDE" class="headerlink" title="三. 安装图形界面 KDE#"></a>三. 安装图形界面 KDE#</h3><p>没插网线重启后wifi记得重新连接！</p>
<p>设置开机自启并立即启动 dhcp 服务，即可连接网络：</p>
<p>systemctl enable –now dhcpcd # 设置开机自启并立即启动 dhcp 服务<br>ping <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a> # 测试网络连接<br>喜欢i3的可以看这篇文章</p>
<h4 id="1-窗口图形系统-Xorg"><a href="#1-窗口图形系统-Xorg" class="headerlink" title="1.窗口图形系统 Xorg#"></a>1.窗口图形系统 Xorg#</h4><p>开机之后会显示一个终端的登陆界面，开始安装kde。必须需要提一句，安装桌面环境需要在普通用户下安装，如果你刚创建完用户，还请重启后用普通用户登录在进行接下来的教程。</p>
<p>窗口图形系统有两种选择——Xorg和Wayland。虽然可以使用 Wayland 启动 KDE Plasma，但仍存在一些缺失的功能和已知问题。建议使用 Xorg 以获得最完整和稳定的体验。</p>
<p>执行下面命令安装 Xorg 的一些组件（提示全部回车确认）：</p>
<p>sudo pacman -S xorg-server xorg-apps xorg-xinit xorg-xclock xterm<br>安装完成后，可执行 startx 命令测试 Xorg 是否正常工作。（执行 exit 退出 Xorg 测试界面）</p>
<h4 id="2-KDE-Plasma"><a href="#2-KDE-Plasma" class="headerlink" title="2.KDE Plasma#"></a>2.KDE Plasma#</h4><h1 id="执行下面命令安装-KDE-Plasma（提示全部回车确认）："><a href="#执行下面命令安装-KDE-Plasma（提示全部回车确认）：" class="headerlink" title="执行下面命令安装 KDE Plasma（提示全部回车确认）："></a>执行下面命令安装 KDE Plasma（提示全部回车确认）：</h1><p>sudo pacman -S plasma</p>
<h1 id="如果你想一次性安装全部-KDE-应用，可执行下面命令（可选）"><a href="#如果你想一次性安装全部-KDE-应用，可执行下面命令（可选）" class="headerlink" title="如果你想一次性安装全部 KDE 应用，可执行下面命令（可选）"></a>如果你想一次性安装全部 KDE 应用，可执行下面命令（可选）</h1><p>sudo pacman -S kde-applications</p>
<h1 id="下面是安装个人喜欢的一些-KDE-应用"><a href="#下面是安装个人喜欢的一些-KDE-应用" class="headerlink" title="下面是安装个人喜欢的一些 KDE 应用"></a>下面是安装个人喜欢的一些 KDE 应用</h1><p>sudo pacman -S dolphin konsole kate kdeconnect ark gwenview filelight kcalc kdenlive krita kdiskmark</p>
<h1 id="（KDE-全部应用详见-https-apps-kde-org-zh-cn-）"><a href="#（KDE-全部应用详见-https-apps-kde-org-zh-cn-）" class="headerlink" title="（KDE 全部应用详见 https://apps.kde.org/zh-cn/）"></a>（KDE 全部应用详见 <a target="_blank" rel="noopener" href="https://apps.kde.org/zh-cn/%EF%BC%89">https://apps.kde.org/zh-cn/）</a></h1><h4 id="3-启用登录管理器-SDDM"><a href="#3-启用登录管理器-SDDM" class="headerlink" title="3. 启用登录管理器 SDDM#"></a>3. 启用登录管理器 SDDM#</h4><h1 id="sddm-开机自启"><a href="#sddm-开机自启" class="headerlink" title="sddm 开机自启"></a>sddm 开机自启</h1><p>sudo systemctl enable sddm</p>
<h1 id="启用-SDDM，进入桌面环境"><a href="#启用-SDDM，进入桌面环境" class="headerlink" title="启用 SDDM，进入桌面环境"></a>启用 SDDM，进入桌面环境</h1><p>sudo systemctl start sddm<br>进入桌面后、可通过Alt + Enter快捷键弹出全局搜索框，可以快速搜索打开想要打开的应用，本人打开应用程序99%都是使用这种方式，非常快速便捷！！！</p>
<h4 id="4-设置网络管理器"><a href="#4-设置网络管理器" class="headerlink" title="4.设置网络管理器#"></a>4.设置网络管理器#</h4><p>如果之前网络是由iwd终端连接wifi的，此刻需要在 iwd 终端忘记之前的连接。否则每次开机都会终端自动连接Wifi导致页面网络管理器不可用</p>
<p>sudo systemctl disable iwd # 确保 iwd 开机处于关闭状态，因为其无线连接会与 NetworkManager 冲突<br>sudo systemctl stop iwd # 立即关闭 iwd<br>sudo systemctl enable –now NetworkManager # 确保先启动 NetworkManager，并进行网络连接。若 iwd 已经与 NetworkManager 冲突，则执行完上一步重启一下电脑即可<br>ping <a target="_blank" rel="noopener" href="http://www.bilibili.com/">www.bilibili.com</a> # 测试网络连通性<br>iwd</p>
<h1 id="列出以前连接过的网络"><a href="#列出以前连接过的网络" class="headerlink" title="列出以前连接过的网络"></a>列出以前连接过的网络</h1><p>[iwd]# known-networks list</p>
<h1 id="忘记已知的网络"><a href="#忘记已知的网络" class="headerlink" title="忘记已知的网络"></a>忘记已知的网络</h1><p>[iwd]# known-networks 网络名 forget</p>
<h1 id="最后点击页面的网络图标连接网络即可"><a href="#最后点击页面的网络图标连接网络即可" class="headerlink" title="最后点击页面的网络图标连接网络即可"></a>最后点击页面的网络图标连接网络即可</h1><h4 id="5-浏览器及字体下载"><a href="#5-浏览器及字体下载" class="headerlink" title="5.浏览器及字体下载#"></a>5.浏览器及字体下载#</h4><h1 id="进入桌面环境后，按-Ctrl-Alt-T-可打开终端。执行下面命令安装-Firefox"><a href="#进入桌面环境后，按-Ctrl-Alt-T-可打开终端。执行下面命令安装-Firefox" class="headerlink" title="进入桌面环境后，按 Ctrl+Alt+T 可打开终端。执行下面命令安装 Firefox"></a>进入桌面环境后，按 Ctrl+Alt+T 可打开终端。执行下面命令安装 Firefox</h1><p>sudo pacman -S firefox</p>
<h1 id="一次性安装常用中文字体"><a href="#一次性安装常用中文字体" class="headerlink" title="一次性安装常用中文字体"></a>一次性安装常用中文字体</h1><p>wqy-microhei # 文泉驿<br>adobe-source-sans-fonts  # 思源黑体<br>harmonyos-sans-git  # 鸿蒙黑体<br>ttf-misans  # MiSans</p>
<p>sudo pacman -S wqy-microhei wqy-microhei-lite wqy-bitmapfont wqy-zenhei ttf-arphic-ukai adobe-source-han-sans-cn-fonts adobe-source-han-serif-cn-fonts</p>
<h1 id="开发人员最喜欢的字体没有之一"><a href="#开发人员最喜欢的字体没有之一" class="headerlink" title="开发人员最喜欢的字体没有之一"></a>开发人员最喜欢的字体没有之一</h1><p>yay -S ttf-fira-code</p>
<h4 id="6-KDE-界面改成中文"><a href="#6-KDE-界面改成中文" class="headerlink" title="6.KDE 界面改成中文#"></a>6.KDE 界面改成中文#</h4><h1 id="打开-System-Settings-Regional-Settings-Language-modify"><a href="#打开-System-Settings-Regional-Settings-Language-modify" class="headerlink" title="打开 System Settings -&gt; Regional Settings -&gt; Language(modify)"></a>打开 System Settings -&gt; Regional Settings -&gt; Language(modify)</h1><h1 id="点击-Add-More-languages，往下翻找到简体中文点击-Add"><a href="#点击-Add-More-languages，往下翻找到简体中文点击-Add" class="headerlink" title="点击 Add More languages，往下翻找到简体中文点击 Add"></a>点击 Add More languages，往下翻找到简体中文点击 Add</h1><h1 id="点击简体中文一栏右侧的向上箭头，将简体中文的优先级置顶，然后点击-apply"><a href="#点击简体中文一栏右侧的向上箭头，将简体中文的优先级置顶，然后点击-apply" class="headerlink" title="点击简体中文一栏右侧的向上箭头，将简体中文的优先级置顶，然后点击 apply"></a>点击简体中文一栏右侧的向上箭头，将简体中文的优先级置顶，然后点击 apply</h1><h1 id="点击左侧的-Formats，然后点击右侧的-Region"><a href="#点击左侧的-Formats，然后点击右侧的-Region" class="headerlink" title="点击左侧的 Formats，然后点击右侧的 Region"></a>点击左侧的 Formats，然后点击右侧的 Region</h1><h1 id="在搜索框里输入-zh-CN，点击-简体中文（中国）"><a href="#在搜索框里输入-zh-CN，点击-简体中文（中国）" class="headerlink" title="在搜索框里输入 zh_CN，点击 简体中文（中国）"></a>在搜索框里输入 zh_CN，点击 简体中文（中国）</h1><h1 id="然后再点击右下角的apply。注销后重新登录，即可看到中文界面"><a href="#然后再点击右下角的apply。注销后重新登录，即可看到中文界面" class="headerlink" title="然后再点击右下角的apply。注销后重新登录，即可看到中文界面"></a>然后再点击右下角的apply。注销后重新登录，即可看到中文界面</h1><h4 id="7-设置显示器全局缩放率"><a href="#7-设置显示器全局缩放率" class="headerlink" title="7. 设置显示器全局缩放率#"></a>7. 设置显示器全局缩放率#</h4><p>现在越来越多的人开始用高分屏了，设置一个合适的全局缩放率就很有必要了。<br>在系统设置的显卡与显示器 -&gt; 显示器配置中可以调节全局缩放率（注销后重新登录生效）。</p>
<h3 id="四-基本设置"><a href="#四-基本设置" class="headerlink" title="四. 基本设置#"></a>四. 基本设置#</h3><h4 id="1-中文输入法"><a href="#1-中文输入法" class="headerlink" title="1. 中文输入法#"></a>1. 中文输入法#</h4><p>安装字体</p>
<h1 id="英文字体"><a href="#英文字体" class="headerlink" title="英文字体"></a>英文字体</h1><p>pacman -S ttf-dejavu</p>
<h1 id="文泉驿正黑矢量字体"><a href="#文泉驿正黑矢量字体" class="headerlink" title="文泉驿正黑矢量字体"></a>文泉驿正黑矢量字体</h1><p>pacman -S wqy-zenhei</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>pacman -S wqy-microhei</p>
<h1 id="Emoji-字体"><a href="#Emoji-字体" class="headerlink" title="Emoji 字体"></a>Emoji 字体</h1><p>pacman -S noto-fonts-emoji<br>配置</p>
<h1 id="Arch-Linux可以安装安装fcitx5-实现输入中文，具体步骤如下（一路回车即可）"><a href="#Arch-Linux可以安装安装fcitx5-实现输入中文，具体步骤如下（一路回车即可）" class="headerlink" title="Arch Linux可以安装安装fcitx5 实现输入中文，具体步骤如下（一路回车即可）"></a>Arch Linux可以安装安装fcitx5 实现输入中文，具体步骤如下（一路回车即可）</h1><p>sudo pacman -S fcitx5-rime # 对经典的 Rime IME 输入法的包装，内置了繁体中文和简体中文的支持<br>sudo pacman -S fcitx5-im # 输入法基础包组<br>sudo pacman -S fcitx5-chinese-addons # 官方中文输入引擎<br>sudo pacman -S fcitx5-anthy # 日文输入引擎<br>sudo pacman -S fcitx5-pinyin-moegirl # 萌娘百科词库。二刺猿必备<br>sudo pacman -S fcitx5-pinyin-zhwiki # 中文维基百科创建的词库<br>sudo pacman -S fcitx5-material-color # 输入法主题</p>
<h1 id="fcitx5-chinese-addons-包含了大量中文输入方式：拼音、双拼、五笔拼音、自然码、仓颉、冰蟾全息、二笔等"><a href="#fcitx5-chinese-addons-包含了大量中文输入方式：拼音、双拼、五笔拼音、自然码、仓颉、冰蟾全息、二笔等" class="headerlink" title="fcitx5-chinese-addons 包含了大量中文输入方式：拼音、双拼、五笔拼音、自然码、仓颉、冰蟾全息、二笔等"></a>fcitx5-chinese-addons 包含了大量中文输入方式：拼音、双拼、五笔拼音、自然码、仓颉、冰蟾全息、二笔等</h1><h1 id="然后在环境变量配置文件-etc-environment中添加如下内容"><a href="#然后在环境变量配置文件-etc-environment中添加如下内容" class="headerlink" title="然后在环境变量配置文件&#x2F;etc&#x2F;environment中添加如下内容"></a>然后在环境变量配置文件&#x2F;etc&#x2F;environment中添加如下内容</h1><h1 id="etc-environment"><a href="#etc-environment" class="headerlink" title="&#x2F;etc&#x2F;environment"></a>&#x2F;etc&#x2F;environment</h1><p>GTK_IM_MODULE&#x3D;fcitx<br>QT_IM_MODULE&#x3D;fcitx<br>XMODIFIERS&#x3D;@im&#x3D;fcitx<br>SDL_IM_MODULE&#x3D;fcitx</p>
<h1 id="配置完成之后重启电脑或者注销"><a href="#配置完成之后重启电脑或者注销" class="headerlink" title="配置完成之后重启电脑或者注销"></a>配置完成之后重启电脑或者注销</h1><h1 id="然后配置自动启动，提供以下3种方法，第一个不行，试第2个，然后第3个"><a href="#然后配置自动启动，提供以下3种方法，第一个不行，试第2个，然后第3个" class="headerlink" title="然后配置自动启动，提供以下3种方法，第一个不行，试第2个，然后第3个"></a>然后配置自动启动，提供以下3种方法，第一个不行，试第2个，然后第3个</h1><h1 id="1-如果，支持XDG桌面环境，例如KDE-GNOME-Xfce-默认重启后即可"><a href="#1-如果，支持XDG桌面环境，例如KDE-GNOME-Xfce-默认重启后即可" class="headerlink" title="1. 如果，支持XDG桌面环境，例如KDE,GNOME, Xfce,默认重启后即可"></a>1. 如果，支持XDG桌面环境，例如KDE,GNOME, Xfce,默认重启后即可</h1><h1 id="2-在-config-autostart目录下添加fcitx-autostart-desktop文件，"><a href="#2-在-config-autostart目录下添加fcitx-autostart-desktop文件，" class="headerlink" title="2. 在~&#x2F;.config&#x2F;autostart目录下添加fcitx-autostart.desktop文件，"></a>2. 在~&#x2F;.config&#x2F;autostart目录下添加fcitx-autostart.desktop文件，</h1><h1 id="可以从目录etc-xdg-autostart中复制"><a href="#可以从目录etc-xdg-autostart中复制" class="headerlink" title="可以从目录etc&#x2F;xdg&#x2F;autostart中复制"></a>可以从目录etc&#x2F;xdg&#x2F;autostart中复制</h1><h1 id="3-对于i3-wm-可以在配置文件-config-i3-config中添加如下代码"><a href="#3-对于i3-wm-可以在配置文件-config-i3-config中添加如下代码" class="headerlink" title="3.对于i3-wm,可以在配置文件~&#x2F;.config&#x2F;i3&#x2F;config中添加如下代码"></a>3.对于i3-wm,可以在配置文件~&#x2F;.config&#x2F;i3&#x2F;config中添加如下代码</h1><p>exec_always –no-startup-id fcitx5</p>
<h1 id="输入法模块"><a href="#输入法模块" class="headerlink" title="输入法模块:"></a>输入法模块:</h1><h1 id="在只安装-fcitx5-和-输入法引擎-的情况下您可能依然可以正常输入"><a href="#在只安装-fcitx5-和-输入法引擎-的情况下您可能依然可以正常输入" class="headerlink" title="在只安装 fcitx5 和 输入法引擎 的情况下您可能依然可以正常输入"></a>在只安装 fcitx5 和 输入法引擎 的情况下您可能依然可以正常输入</h1><h1 id="但是安装对应的-输入法模块-后您将获得更加舒适的体验："><a href="#但是安装对应的-输入法模块-后您将获得更加舒适的体验：" class="headerlink" title="但是安装对应的 输入法模块 后您将获得更加舒适的体验："></a>但是安装对应的 输入法模块 后您将获得更加舒适的体验：</h1><p>fcitx5-qt  # 对 Qt5 程序的支持<br>fcitx5-gtk # 对 GTK 程序的支持<br>fcitx5-qt4-gitAUR # 对 Qt4 程序的支持</p>
<h1 id="提示：-一般情况下，只安装-fcitx5-qt-和-fcitx5-gtk-就行了"><a href="#提示：-一般情况下，只安装-fcitx5-qt-和-fcitx5-gtk-就行了" class="headerlink" title="提示： 一般情况下，只安装 fcitx5-qt 和 fcitx5-gtk 就行了"></a>提示： 一般情况下，只安装 fcitx5-qt 和 fcitx5-gtk 就行了</h1><h1 id="词库"><a href="#词库" class="headerlink" title="词库"></a>词库</h1><h1 id="对于-Fcitx5-的中文输入法-目前在仓库里提供了数个词库："><a href="#对于-Fcitx5-的中文输入法-目前在仓库里提供了数个词库：" class="headerlink" title="对于 Fcitx5 的中文输入法, 目前在仓库里提供了数个词库："></a>对于 Fcitx5 的中文输入法, 目前在仓库里提供了数个词库：</h1><p>fcitx5-pinyin-zhwiki # felixonmars 根据中文维基百科创建的词库。适用于 拼音输入法</p>
<h1 id="idea不能输入中文的问题"><a href="#idea不能输入中文的问题" class="headerlink" title="idea不能输入中文的问题"></a>idea不能输入中文的问题</h1><h1 id="在IDEA的bin目录下的idea-sh文件的前面加上"><a href="#在IDEA的bin目录下的idea-sh文件的前面加上" class="headerlink" title="在IDEA的bin目录下的idea.sh文件的前面加上"></a>在IDEA的bin目录下的idea.sh文件的前面加上</h1><p>export XIM&#x3D;”fcitx”<br>export XIM_PROGRAM&#x3D;”fcitx”<br>export XMODIFIERS&#x3D;”@im&#x3D;fcitx”<br>export GTK_IM_MODULE&#x3D;”fcitx”<br>export QT_IM_MODULE&#x3D;”fcitx”<br>添加中文输入法</p>
<p>setting -&gt; 语言和区域设置 -&gt; 输入法</p>
<h1 id="去掉默认的输入法"><a href="#去掉默认的输入法" class="headerlink" title="去掉默认的输入法"></a>去掉默认的输入法</h1><h1 id="添加输入法并应用（默认通过快捷键-ctrl-space-切换中英文）"><a href="#添加输入法并应用（默认通过快捷键-ctrl-space-切换中英文）" class="headerlink" title="添加输入法并应用（默认通过快捷键 ctrl + space 切换中英文）"></a>添加输入法并应用（默认通过快捷键 ctrl + space 切换中英文）</h1><p>Pinyin<br>键盘-英语(美国)</p>
<h5 id="2-蓝牙"><a href="#2-蓝牙" class="headerlink" title="2. 蓝牙#"></a>2. 蓝牙#</h5><h1 id="安装蓝牙并启动蓝牙服务"><a href="#安装蓝牙并启动蓝牙服务" class="headerlink" title="安装蓝牙并启动蓝牙服务"></a>安装蓝牙并启动蓝牙服务</h1><p>sudo pacman -S bluez bluez-utils<br>sudo systemctl enable bluetooth.service<br>sudo systemctl start bluetooth.service</p>
<h1 id="使用Bluetoothctl进入蓝牙控制台"><a href="#使用Bluetoothctl进入蓝牙控制台" class="headerlink" title="使用Bluetoothctl进入蓝牙控制台"></a>使用Bluetoothctl进入蓝牙控制台</h1><h1 id="Bluez是Linux系统上的蓝牙协议栈，自带了很多有用的工具，Bluetoothctl就是其一。"><a href="#Bluez是Linux系统上的蓝牙协议栈，自带了很多有用的工具，Bluetoothctl就是其一。" class="headerlink" title="Bluez是Linux系统上的蓝牙协议栈，自带了很多有用的工具，Bluetoothctl就是其一。"></a>Bluez是Linux系统上的蓝牙协议栈，自带了很多有用的工具，Bluetoothctl就是其一。</h1><p>bluetoothctl –help              # 查看帮助命令<br>bluetoothctl -v                  # 查看蓝牙版本</p>
<h1 id="使用Bluetoothctl连接蓝牙案例"><a href="#使用Bluetoothctl连接蓝牙案例" class="headerlink" title="使用Bluetoothctl连接蓝牙案例"></a>使用Bluetoothctl连接蓝牙案例</h1><p>bluetoothctl                     # 进入蓝牙管理工具环境</p>
<h1 id="bluetooth-power-on-打开蓝牙"><a href="#bluetooth-power-on-打开蓝牙" class="headerlink" title="[bluetooth]# power on                打开蓝牙"></a>[bluetooth]# power on                打开蓝牙</h1><h1 id="bluetooth-agent-on-开启"><a href="#bluetooth-agent-on-开启" class="headerlink" title="[bluetooth]# agent on                开启"></a>[bluetooth]# agent on                开启</h1><h1 id="bluetooth-scan-on-扫描蓝牙设备"><a href="#bluetooth-scan-on-扫描蓝牙设备" class="headerlink" title="[bluetooth]# scan on                 扫描蓝牙设备"></a>[bluetooth]# scan on                 扫描蓝牙设备</h1><h1 id="bluetooth-pair-xx-xx-xx-…-配对该设备"><a href="#bluetooth-pair-xx-xx-xx-…-配对该设备" class="headerlink" title="[bluetooth]# pair xx:xx:xx:…       配对该设备"></a>[bluetooth]# pair xx:xx:xx:…       配对该设备</h1><h1 id="bluetooth-trust-xx-xx-xx-…-信任该设备"><a href="#bluetooth-trust-xx-xx-xx-…-信任该设备" class="headerlink" title="[bluetooth]# trust xx:xx:xx:…      信任该设备"></a>[bluetooth]# trust xx:xx:xx:…      信任该设备</h1><h1 id="bluetooth-connect-xx-xx-…-连接该设备"><a href="#bluetooth-connect-xx-xx-…-连接该设备" class="headerlink" title="[bluetooth]# connect xx:xx:…       连接该设备"></a>[bluetooth]# connect xx:xx:…       连接该设备</h1><h1 id="bluetooth-disconnect-xx-xx-…-断开蓝牙"><a href="#bluetooth-disconnect-xx-xx-…-断开蓝牙" class="headerlink" title="[bluetooth]# disconnect xx:xx:…    断开蓝牙"></a>[bluetooth]# disconnect xx:xx:…    断开蓝牙</h1><h1 id="bluetooth-help-查看帮助信息"><a href="#bluetooth-help-查看帮助信息" class="headerlink" title="[bluetooth]# help                    查看帮助信息"></a>[bluetooth]# help                    查看帮助信息</h1><h1 id="bluetooth-show-查看本机蓝牙信息"><a href="#bluetooth-show-查看本机蓝牙信息" class="headerlink" title="[bluetooth]# show                    查看本机蓝牙信息"></a>[bluetooth]# show                    查看本机蓝牙信息</h1><h1 id="bluetooth-discoverable-yes-设置蓝牙可被发现"><a href="#bluetooth-discoverable-yes-设置蓝牙可被发现" class="headerlink" title="[bluetooth]# discoverable yes        设置蓝牙可被发现"></a>[bluetooth]# discoverable yes        设置蓝牙可被发现</h1><h1 id="bluetooth-info-xx-xx-xx-…-查看该蓝牙设备的信息"><a href="#bluetooth-info-xx-xx-xx-…-查看该蓝牙设备的信息" class="headerlink" title="[bluetooth]# info xx:xx:xx:…       查看该蓝牙设备的信息"></a>[bluetooth]# info xx:xx:xx:…       查看该蓝牙设备的信息</h1><h1 id="安装蓝牙音频"><a href="#安装蓝牙音频" class="headerlink" title="安装蓝牙音频"></a>安装蓝牙音频</h1><p>sudo pacman -S pulseaudio-bluetooth</p>
<h1 id="蓝牙图形化管理工具安装"><a href="#蓝牙图形化管理工具安装" class="headerlink" title="蓝牙图形化管理工具安装"></a>蓝牙图形化管理工具安装</h1><p>sudo pacman -S bluedevil</p>
<h5 id="3-pacman-32位运行库与ArchLinuxCN库的支持-以及一些镜像源"><a href="#3-pacman-32位运行库与ArchLinuxCN库的支持-以及一些镜像源" class="headerlink" title="3. pacman 32位运行库与ArchLinuxCN库的支持,以及一些镜像源#"></a>3. pacman 32位运行库与ArchLinuxCN库的支持,以及一些镜像源#</h5><h1 id="编辑配置文件，添加以下软件源"><a href="#编辑配置文件，添加以下软件源" class="headerlink" title="编辑配置文件，添加以下软件源"></a>编辑配置文件，添加以下软件源</h1><p>vim &#x2F;etc&#x2F;pacman.d&#x2F;mirrorlist</p>
<h1 id="—————下面为vim操作，不同于终端————-1"><a href="#—————下面为vim操作，不同于终端————-1" class="headerlink" title="—————下面为vim操作，不同于终端————-"></a>—————下面为vim操作，不同于终端————-</h1><h1 id="中科大源"><a href="#中科大源" class="headerlink" title="中科大源"></a>中科大源</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch">https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</a></p>
<h1 id="阿里源"><a href="#阿里源" class="headerlink" title="阿里源"></a>阿里源</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="http://mirrors.aliyun.com/archlinux/$repo/os/$arch">http://mirrors.aliyun.com/archlinux/$repo/os/$arch</a></p>
<h1 id="清华源"><a href="#清华源" class="headerlink" title="清华源"></a>清华源</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch">https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch</a></p>
<h1 id="华为源"><a href="#华为源" class="headerlink" title="华为源"></a>华为源</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="https://repo.huaweicloud.com/archlinux/$repo/os/$arch">https://repo.huaweicloud.com/archlinux/$repo/os/$arch</a></p>
<h1 id="163源-（i686-和-x86-64）"><a href="#163源-（i686-和-x86-64）" class="headerlink" title="163源 （i686 和 x86_64）"></a>163源 （i686 和 x86_64）</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="http://mirrors.163.com/archlinux/$repo/os/i686">http://mirrors.163.com/archlinux/$repo/os/i686</a><br>为了系统的稳定，官方关闭了32位软件以及aur软件库，但是仅仅只依靠官方源中的软件时不够用的，这里我们要打开这两个库</p>
<p>sudo vim &#x2F;etc&#x2F;pacman.conf<br>multilib<br>去掉[multilib]一节中两行的注释，来开启 32 位库支持。</p>
<p>#取消掉 # 号<br>[multilib]<br>Include &#x3D; &#x2F;etc&#x2F;pacman.d&#x2F;mirrorlist<br>Arch Linux CN<br>在文档结尾处加入下面的文字，来开启 ArchLinuxCN 源。</p>
<p>[archlinuxcn]<br>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/archlinuxcn/$arch">https://mirrors.ustc.edu.cn/archlinuxcn/$arch</a><br>执行 sudo pacman -Syyu 更新pacman数据库</p>
<p>然后需要安装 archlinuxcn-keyring 包以导入 GPG key</p>
<p>sudo pacman -S archlinuxcn-keyring<br>有时候因为密钥环的问题，导致这一步安装报错，可以依次执行下面的命令</p>
<p>sudo pacman -Syyu<br>sudo pacman -S haveged<br>sudo pacman -Syu haveged<br>sudo systemctl start haveged<br>sudo systemctl enable haveged</p>
<p>sudo rm -fr &#x2F;etc&#x2F;pacman.d&#x2F;gnupg<br>sudo pacman-key –init<br>sudo pacman-key –populate archlinux<br>sudo pacman-key –populate archlinuxcn</p>
<h1 id="如果-系统长时间不更新，可能也会出现问题"><a href="#如果-系统长时间不更新，可能也会出现问题" class="headerlink" title="如果 系统长时间不更新，可能也会出现问题"></a>如果 系统长时间不更新，可能也会出现问题</h1><h1 id="更新密钥"><a href="#更新密钥" class="headerlink" title="更新密钥"></a>更新密钥</h1><p>pacman-key –refresh-keys</p>
<h1 id="注意：keyserver如果是国外的更新很慢，以下是其他kerserker服务，可以指定更新服务器："><a href="#注意：keyserver如果是国外的更新很慢，以下是其他kerserker服务，可以指定更新服务器：" class="headerlink" title="注意：keyserver如果是国外的更新很慢，以下是其他kerserker服务，可以指定更新服务器："></a>注意：keyserver如果是国外的更新很慢，以下是其他kerserker服务，可以指定更新服务器：</h1><p>sudo pacman-key –refresh-keys –keyserver <a target="_blank" rel="noopener" href="http://pgp.mit.edu/">http://pgp.mit.edu</a><br>然后再重新安装，即可解决问题</p>
<p>最后安装 yay 用来下载archlinuxcn库中的软件</p>
<p>sudo pacman -S yay<br>BlackArch 镜像源<br>Arch Linux 添加 BlackArch 镜像源：</p>
<p>#Arch Linux 添加 BlackArch 镜像源<br>sudo vim &#x2F;etc&#x2F;pacman.conf</p>
<h1 id="在最后面添加如下几行"><a href="#在最后面添加如下几行" class="headerlink" title="在最后面添加如下几行"></a>在最后面添加如下几行</h1><p>[blackarch]<br>SigLevel &#x3D; Never</p>
<h1 id="国内镜像源"><a href="#国内镜像源" class="headerlink" title="国内镜像源"></a>国内镜像源</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/blackarch/$repo/os/$arch">https://mirrors.ustc.edu.cn/blackarch/$repo/os/$arch</a><br>#Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/blackarch/$repo/os/$arch">https://mirrors.tuna.tsinghua.edu.cn/blackarch/$repo/os/$arch</a><br>安装 BlackArch GPG 密钥<br>sudo pacman -S blackarch-keyring<br>同时建议安装 blackarch-mirrorlist 包<br>yay -S blackarch-mirrorlist</p>
<h1 id="取消当前所在区域的镜像源注释"><a href="#取消当前所在区域的镜像源注释" class="headerlink" title="取消当前所在区域的镜像源注释"></a>取消当前所在区域的镜像源注释</h1><p>sudo vim &#x2F;etc&#x2F;pacman.d&#x2F;blackarch-mirrorlist</p>
<h1 id="如："><a href="#如：" class="headerlink" title="如："></a>如：</h1><h1 id="China"><a href="#China" class="headerlink" title="China"></a>China</h1><p>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirror.sjtu.edu.cn/blackarch/$repo/os/$arch">https://mirror.sjtu.edu.cn/blackarch/$repo/os/$arch</a><br>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/blackarch/$repo/os/$arch">https://mirrors.tuna.tsinghua.edu.cn/blackarch/$repo/os/$arch</a><br>Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/blackarch/$repo/os/$arch">https://mirrors.ustc.edu.cn/blackarch/$repo/os/$arch</a></p>
<h1 id="修改-etc-pacman-conf"><a href="#修改-etc-pacman-conf" class="headerlink" title="修改 &#x2F;etc&#x2F;pacman.conf"></a>修改 &#x2F;etc&#x2F;pacman.conf</h1><p>sudo vim &#x2F;etc&#x2F;pacman.conf</p>
<h1 id="重新修改-blackarch-让其优先使用-blackarch-mirrorlist"><a href="#重新修改-blackarch-让其优先使用-blackarch-mirrorlist" class="headerlink" title="重新修改 [blackarch] 让其优先使用 blackarch-mirrorlist"></a>重新修改 [blackarch] 让其优先使用 blackarch-mirrorlist</h1><p>[blackarch]<br>#SigLevel &#x3D; Never<br>#Server &#x3D; <a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/blackarch/$repo/os/$arch">https://mirrors.ustc.edu.cn/blackarch/$repo/os/$arch</a><br>Include &#x3D; &#x2F;etc&#x2F;pacman.d&#x2F;blackarch-mirrorlist<br>Chaotic-AUR<br>Chaotic-AUR 中包含一些经过编译的 AUR 软件</p>
<p>导入 Chaotic-AUR 的 Pacman 密钥并安装 mirrorlist</p>
<p>pacman-key –recv-key FBA220DFC880C036 –keyserver keyserver.ubuntu.com<br>pacman-key –lsign-key FBA220DFC880C036<br>pacman -U ‘<a target="_blank" rel="noopener" href="https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-keyring.pkg.tar.zst">https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-keyring.pkg.tar.zst</a>‘ ‘<a target="_blank" rel="noopener" href="https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-mirrorlist.pkg.tar.zst">https://cdn-mirror.chaotic.cx/chaotic-aur/chaotic-mirrorlist.pkg.tar.zst</a>‘<br>然后在 &#x2F;etc&#x2F;pacman.conf 最下方加入以下两行</p>
<p>[chaotic-aur]<br>Include &#x3D; &#x2F;etc&#x2F;pacman.d&#x2F;chaotic-mirrorlist<br>然后更新软件源</p>
<p>sudo pacman -Sy<br>如果速度过慢可以尝试使用反代服务</p>
<p>Clansty<br>同样也是一些编译后的 AUR 软件</p>
<p>在 &#x2F;etc&#x2F;pacman.conf 最下方加入:</p>
<p>[Clansty]<br>SigLevel &#x3D; Never<br>Server &#x3D; <a target="_blank" rel="noopener" href="https://repo.lwqwq.com/archlinux/$arch">https://repo.lwqwq.com/archlinux/$arch</a><br>Server &#x3D; <a target="_blank" rel="noopener" href="https://pacman.ltd/archlinux/$arch">https://pacman.ltd/archlinux/$arch</a><br>Server &#x3D; <a target="_blank" rel="noopener" href="https://repo.clansty.com/archlinux/$arch">https://repo.clansty.com/archlinux/$arch</a><br>然后更新软件源</p>
<p>sudo pacman -Sy</p>
<h5 id="4-安装-AUR（yay）（添加CN源之后可以之间安装yay-此步骤可以省略）"><a href="#4-安装-AUR（yay）（添加CN源之后可以之间安装yay-此步骤可以省略）" class="headerlink" title="4.安装 AUR（yay）（添加CN源之后可以之间安装yay,此步骤可以省略）#"></a>4.安装 AUR（yay）（添加CN源之后可以之间安装yay,此步骤可以省略）#</h5><p>官方仓库的软件实在是太少了， AUR（Arch 用户软件仓库，全称 Arch User Repository）里有许多软件。AUR 是为用户而建、由用户主导的 Arch 软件仓库。</p>
<p>从 AUR 安装软件包，需要先安装 AUR Helper，这里以最有名的 yay 为例。yay 是一个用 Go 语言开发的 AUR Helper，具有高级依赖解决、PKGBUILD 下载、AUR 包名自动补全、移除生成依赖等功能。添加archlinuxcn源之后使用下面命令安装 yay（Binary 版本，无需自己编译）</p>
<p>sudo pacman -S yay<br>底下是使用git下载</p>
<p>pacman -S –needed git base-devel<br>git clone <a target="_blank" rel="noopener" href="https://aur.archlinux.org/yay-bin.git">https://aur.archlinux.org/yay-bin.git</a><br>cd yay-bin<br>makepkg -si<br>注意：执行 yay 的所有命令时，前面不需要加 sudo</p>
<h5 id="5-pacman-yay-常用操作"><a href="#5-pacman-yay-常用操作" class="headerlink" title="5. pacman&#x2F;yay 常用操作#"></a>5. pacman&#x2F;yay 常用操作#</h5><p>以下操作对 yay 同样适用</p>
<h1 id="1-系统更新"><a href="#1-系统更新" class="headerlink" title="1.系统更新"></a>1.系统更新</h1><h1 id="对整个archLinux进行更新"><a href="#对整个archLinux进行更新" class="headerlink" title="对整个archLinux进行更新"></a>对整个archLinux进行更新</h1><p>pacman -Syu</p>
<h1 id="如果你已经使用-pacman-Sy-将本地的包数据库与远程的仓库进行了同步-也可以只执行"><a href="#如果你已经使用-pacman-Sy-将本地的包数据库与远程的仓库进行了同步-也可以只执行" class="headerlink" title="如果你已经使用 pacman -Sy 将本地的包数据库与远程的仓库进行了同步,也可以只执行:"></a>如果你已经使用 pacman -Sy 将本地的包数据库与远程的仓库进行了同步,也可以只执行:</h1><p>pacman -Su</p>
<h1 id="如提示冲突，可强制更新-dd跳过所有检查"><a href="#如提示冲突，可强制更新-dd跳过所有检查" class="headerlink" title="如提示冲突，可强制更新(dd跳过所有检查)"></a>如提示冲突，可强制更新(dd跳过所有检查)</h1><p>pacman -Syudd</p>
<h1 id="2-安装包"><a href="#2-安装包" class="headerlink" title="2.安装包"></a>2.安装包</h1><p>pacman -S 包名                   # 你也可以同时安装多个包, 只需以空格分隔包名即可<br>pacman -Sy 包名                  # 与上面命令不同的是,该命令将在同步包数据库后再执行安装<br>pacman -Sv 包名                  # 在显示一些操作信息后执行安装<br>pacman -U  包名.tar.gz           # 安装本地包,其扩展名为 pkg.tar.gz</p>
<h1 id="3-删除包"><a href="#3-删除包" class="headerlink" title="3.删除包"></a>3.删除包</h1><p>pacman -R 包名                   # 该命令将只删除包,不包含该包的依赖<br>pacman -Rs 包名                  # 在删除包的同时,也将删除其依赖<br>pacman -Rd 包名                  # 在删除包时不检查依赖</p>
<h1 id="4-搜索包"><a href="#4-搜索包" class="headerlink" title="4.搜索包"></a>4.搜索包</h1><p>pacman -Ss 关键字                # 这将搜索含关键字的包<br>pacman -Qi 包名                  # 查看有关包的信息<br>pacman -Ql 包名                  # 列出该包的文件</p>
<h1 id="5-其他用法"><a href="#5-其他用法" class="headerlink" title="5.其他用法"></a>5.其他用法</h1><p>sudo pacman -R $(pacman -Qdtq)  # 清除系统中无用的包<br>pacman -Sw 包名                  # 只下载包,不安装<br>pacman -Sc                      # Pacman下载的包文件位于 &#x2F;var&#x2F;cache&#x2F;pacman&#x2F;pkg&#x2F; 目录<br>                                # 该命令将清理未安装的包文件<br>pacman -Scc                     # 清理所有的缓存文件</p>
<h5 id="6-pacman安装-常用软件"><a href="#6-pacman安装-常用软件" class="headerlink" title="6. pacman安装 常用软件#"></a>6. pacman安装 常用软件#</h5><p>openssh               # ssh 链接远程服务器<br>peek                  # GIF录制<br>tree                  # 玩 Linux 的朋友都知道该命令<br>python-pip            # Python 用户必备<br>neovim                # vim 党福音<br>neofetch              # 查看系统信息<br>screenkey             # 显示按下的键<br>figlet                # 生成一个 logo<br>iputils               # 允许用户使用 ping 命令<br>wget                  # 下载工具<br>chromium			  # Chromium<br>firefox				  # Firefox<br>intellij-idea-community-edition		# IntelliJ IDEA Community Edition<br>pycharm-community-edition			# PyCharm Community Edition<br>libreoffice-fresh libreoffice-fresh-zh-cn 	  # 办公套件LibreOffice</p>
<h1 id="udisk2-udiskie-自动挂载U盘修改"><a href="#udisk2-udiskie-自动挂载U盘修改" class="headerlink" title="udisk2 udiskie : 自动挂载U盘修改"></a>udisk2 udiskie : 自动挂载U盘修改</h1><h1 id="ntfs-3g-：-读取ntfs格式磁盘"><a href="#ntfs-3g-：-读取ntfs格式磁盘" class="headerlink" title="ntfs-3g ： 读取ntfs格式磁盘"></a>ntfs-3g ： 读取ntfs格式磁盘</h1><h1 id="dolphin-文件管理器"><a href="#dolphin-文件管理器" class="headerlink" title="dolphin : 文件管理器"></a>dolphin : 文件管理器</h1><p>sudo pacman -S udisks2 udiskie ntfs-3g  dolphin</p>
<h1 id="开机自启自动挂载U盘"><a href="#开机自启自动挂载U盘" class="headerlink" title="开机自启自动挂载U盘"></a>开机自启自动挂载U盘</h1><p>systemctl enable udisks2</p>
<h1 id="启动-ssh-服务"><a href="#启动-ssh-服务" class="headerlink" title="启动 ssh 服务"></a>启动 ssh 服务</h1><p>systemctl start sshd<br>systemctl enable sshd</p>
<h1 id="Virtualbox-安装与配置"><a href="#Virtualbox-安装与配置" class="headerlink" title="Virtualbox 安装与配置"></a>Virtualbox 安装与配置</h1><h1 id="需要安装linux-headers"><a href="#需要安装linux-headers" class="headerlink" title="需要安装linux-headers"></a>需要安装linux-headers</h1><p>sudo pacman -S linux-headers</p>
<h1 id="确认linux内核版本-确保linux-headers的版本和linux版本相同"><a href="#确认linux内核版本-确保linux-headers的版本和linux版本相同" class="headerlink" title="确认linux内核版本,确保linux-headers的版本和linux版本相同"></a>确认linux内核版本,确保linux-headers的版本和linux版本相同</h1><p>uname -r</p>
<h1 id="安装-virtualbox-执行命令后，会提示选择安装virtualbox软件类型，选择virtualbox-host-dkms"><a href="#安装-virtualbox-执行命令后，会提示选择安装virtualbox软件类型，选择virtualbox-host-dkms" class="headerlink" title="安装 virtualbox,执行命令后，会提示选择安装virtualbox软件类型，选择virtualbox-host-dkms"></a>安装 virtualbox,执行命令后，会提示选择安装virtualbox软件类型，选择virtualbox-host-dkms</h1><p>sudo pacman -Syu virtualbox</p>
<h1 id="安装virtualbox-guest-iso"><a href="#安装virtualbox-guest-iso" class="headerlink" title="安装virtualbox-guest-iso"></a>安装virtualbox-guest-iso</h1><p>sudo pacman -S virtualbox-guest-iso</p>
<h1 id="把当前用户增加到vboxusers组"><a href="#把当前用户增加到vboxusers组" class="headerlink" title="把当前用户增加到vboxusers组"></a>把当前用户增加到vboxusers组</h1><p>sudo usermod -G  vboxusers -a  myuser<br>#pip更换国内镜像源<br>pip config set global.index-url <a target="_blank" rel="noopener" href="https://pypi.tuna.tsinghua.edu.cn/simple">https://pypi.tuna.tsinghua.edu.cn/simple</a><br>sudo pacman -S ntfs-3g # 使系统可以识别 NTFS 格式的硬盘<br>sudo pacman -S adobe-source-han-serif-cn-fonts wqy-zenhei # 安装几个开源中文字体。一般装上文泉驿就能解决大多 wine 应用中文方块的问题<br>sudo pacman -S noto-fonts noto-fonts-cjk noto-fonts-emoji noto-fonts-extra # 安装谷歌开源字体及表情<br>sudo pacman -S firefox chromium # 安装常用的火狐、chromium 浏览器<br>sudo pacman -S ark # 压缩软件。在 dolphin 中可用右键解压压缩包<br>sudo pacman -S packagekit-qt5 packagekit appstream-qt appstream # 确保 Discover（软件中心）可用，需重启<br>sudo pacman -S gwenview # 图片查看器<br>sudo pacman -S steam # 游戏商店。稍后看完显卡驱动章节再使用</p>
<h5 id="7-yay-常用软件"><a href="#7-yay-常用软件" class="headerlink" title="7. yay 常用软件#"></a>7. yay 常用软件#</h5><h1 id="安装-AUR-软件"><a href="#安装-AUR-软件" class="headerlink" title="安装 AUR 软件"></a>安装 AUR 软件</h1><p>yay -S 包名</p>
<h1 id="使用-yay-安装下面软件之前，请先确保基础打包工具（base-devel）已经安装"><a href="#使用-yay-安装下面软件之前，请先确保基础打包工具（base-devel）已经安装" class="headerlink" title="使用 yay 安装下面软件之前，请先确保基础打包工具（base-devel）已经安装"></a>使用 yay 安装下面软件之前，请先确保基础打包工具（base-devel）已经安装</h1><p>yay -S base-devel</p>
<h1 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h1><p>yay -S firewalld<br>systemctl enable –now firewalld</p>
<h1 id="常用-aur-软件"><a href="#常用-aur-软件" class="headerlink" title="常用 aur 软件"></a>常用 aur 软件</h1><h1 id="编程软件"><a href="#编程软件" class="headerlink" title="&#x3D;&#x3D;&#x3D;&gt; 编程软件"></a>&#x3D;&#x3D;&#x3D;&gt; 编程软件</h1><p>yay -S visual-studio-code-bin  #  Visual Studio Code<br>yay -S intellij-idea-ultimate-edition intellij-idea-ultimate-edition-jre  # idea<br>yay -S pycharm-professional		# PyCharm Professional<br>yay -S intellij-idea-ultimate-edition		# IntelliJ IDEA Ultimate Edition</p>
<h1 id="浏览器"><a href="#浏览器" class="headerlink" title="&#x3D;&#x3D;&#x3D;&gt; 浏览器"></a>&#x3D;&#x3D;&#x3D;&gt; 浏览器</h1><p>yay -S google-chrome  # google 浏览器<br>yay -S microsoft-edge-stable-bin # edge 浏览器</p>
<h1 id="办公软件"><a href="#办公软件" class="headerlink" title="&#x3D;&#x3D;&#x3D;&gt; 办公软件"></a>&#x3D;&#x3D;&#x3D;&gt; 办公软件</h1><p>yay -S wps-office-cn wps-office-mui-zh-cn ttf-wps-fonts #  WPS Office</p>
<h1 id="社交软件"><a href="#社交软件" class="headerlink" title="&#x3D;&#x3D;&#x3D;&gt; 社交软件"></a>&#x3D;&#x3D;&#x3D;&gt; 社交软件</h1><p>yay -S icalingua++ # Icalingua++（第三方Linux QQ）<br>yay -S deepin-wine-tim  # win tim<br>yay -S deepin-wine-wechat  # win 微信<br>yay -S com.tencent.weixin # 微信</p>
<h1 id="实用工具"><a href="#实用工具" class="headerlink" title="&#x3D;&#x3D;&#x3D;&gt; 实用工具"></a>&#x3D;&#x3D;&#x3D;&gt; 实用工具</h1><p>yay -S wemeet-bin			 # 腾讯会议<br>yay -S utools                # uTools搜索<br>yay -S flameshot             # 火焰截图<br>yay -S motrix-bin            # 下载工具<br>yay -S kdiskmark-git         # 磁盘检测工具<br>yay -S gimp                  # 图像处理<br>yay -S kdenlive              # 视频后期<br>yay -S baidunetdisk-electron # 百度盘<br>yay -S xunlei-bin            # 迅雷<br>yay -S netease-cloud-music   # 网易云<br>yay -S obs-studio            # obs<br>yay -S p7zip                 # 压缩<br>yay -S unrar                 # 压缩<br>所有 AUR 软件可在 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/">https://aur.archlinux.org/</a> 上查询。</p>
<h5 id="8-显卡驱动与双显卡切换"><a href="#8-显卡驱动与双显卡切换" class="headerlink" title="8. 显卡驱动与双显卡切换#"></a>8. 显卡驱动与双显卡切换#</h5><p>首先，安装显卡驱动。mesa是所有开源显卡驱动的基础，一般都要安装。</p>
<h1 id="查看显卡型号"><a href="#查看显卡型号" class="headerlink" title="查看显卡型号"></a>查看显卡型号</h1><h1 id="自带核显"><a href="#自带核显" class="headerlink" title="自带核显"></a>自带核显</h1><p>lspci |grep VGA</p>
<h1 id="查看其它独显"><a href="#查看其它独显" class="headerlink" title="查看其它独显"></a>查看其它独显</h1><p>lspci |grep -i nvida<br>这里，我们尽量给安装完整，有几大功能：OpenGL, vulkan, vaapi, vdpau, opencl. 32位的程序也要使用并安装相应的驱动 (请先更新pacman 32运行库)。系统是archlinux，用的官方内核。</p>
<p>Intel显卡驱动安装：</p>
<p>sudo pacman -S mesa xf86-video-intel vulkan-intel<br>sudo pacman -S libva-intel-driver libvdpau-va-gl intel-compute-runtime<br>sudo pacman -S lib32-vulkan-intel lib32-mesa intel-gpu-tools</p>
<h1 id="mesa-3D-driver"><a href="#mesa-3D-driver" class="headerlink" title="mesa    3D driver"></a>mesa    3D driver</h1><h1 id="xf86-video-intel-2d-driver"><a href="#xf86-video-intel-2d-driver" class="headerlink" title="xf86-video-intel    2d driver"></a>xf86-video-intel    2d driver</h1><h1 id="libva-intel-driver-vaapi-视频硬解码库"><a href="#libva-intel-driver-vaapi-视频硬解码库" class="headerlink" title="libva-intel-driver    vaapi 视频硬解码库"></a>libva-intel-driver    vaapi 视频硬解码库</h1><h1 id="libvdpau-va-gl-vdpau-视频硬解码库，以vaapi为基础的翻译层"><a href="#libvdpau-va-gl-vdpau-视频硬解码库，以vaapi为基础的翻译层" class="headerlink" title="libvdpau-va-gl    vdpau 视频硬解码库，以vaapi为基础的翻译层"></a>libvdpau-va-gl    vdpau 视频硬解码库，以vaapi为基础的翻译层</h1><h1 id="intel-compute-runtime-opencl"><a href="#intel-compute-runtime-opencl" class="headerlink" title="intel-compute-runtime    opencl"></a>intel-compute-runtime    opencl</h1><h1 id="intel-gpu-tools-用sudo-intel-gpu-top观察Intel显卡负载"><a href="#intel-gpu-tools-用sudo-intel-gpu-top观察Intel显卡负载" class="headerlink" title="intel-gpu-tools    用sudo intel_gpu_top观察Intel显卡负载"></a>intel-gpu-tools    用sudo intel_gpu_top观察Intel显卡负载</h1><p>nvidia显卡驱动安装：（yay软件在archlinuxcn里面，添加源就可安装）</p>
<h1 id="闭源驱动："><a href="#闭源驱动：" class="headerlink" title="闭源驱动："></a>闭源驱动：</h1><p>sudo pacman -S nvidia nvidia-prime nvidia-settings nvidia-utils opencl-nvidia<br>sudo pacman -S lib32-nvidia-utils lib32-opencl-nvidia libva-vdpau-driver</p>
<h1 id="nvidia-内核所属，记得更新驱动也要更新linux内核：sudo-pacman-Syu"><a href="#nvidia-内核所属，记得更新驱动也要更新linux内核：sudo-pacman-Syu" class="headerlink" title="nvidia    内核所属，记得更新驱动也要更新linux内核：sudo pacman -Syu"></a>nvidia    内核所属，记得更新驱动也要更新linux内核：sudo pacman -Syu</h1><h1 id="nvidia-utils-opengl-vulkan-vdpau"><a href="#nvidia-utils-opengl-vulkan-vdpau" class="headerlink" title="nvidia-utils    opengl, vulkan, vdpau"></a>nvidia-utils    opengl, vulkan, vdpau</h1><h1 id="opencl-nvidia-opencl-cuda-driver"><a href="#opencl-nvidia-opencl-cuda-driver" class="headerlink" title="opencl-nvidia    opencl, cuda driver"></a>opencl-nvidia    opencl, cuda driver</h1><h1 id="nvidia-prime-用”prime-run-cmd”启动程序运行于nvidia上"><a href="#nvidia-prime-用”prime-run-cmd”启动程序运行于nvidia上" class="headerlink" title="nvidia-prime    用”prime-run $cmd”启动程序运行于nvidia上"></a>nvidia-prime    用”prime-run $cmd”启动程序运行于nvidia上</h1><h1 id="libva-vdpau-driver-vaapi-视频硬解码库，以vdpau为基础的翻译层"><a href="#libva-vdpau-driver-vaapi-视频硬解码库，以vdpau为基础的翻译层" class="headerlink" title="libva-vdpau-driver    vaapi 视频硬解码库，以vdpau为基础的翻译层"></a>libva-vdpau-driver    vaapi 视频硬解码库，以vdpau为基础的翻译层</h1><h1 id="开源驱动：（2d性能和闭源驱动相当，3d性能可能是闭源的一半，不支持opencl）"><a href="#开源驱动：（2d性能和闭源驱动相当，3d性能可能是闭源的一半，不支持opencl）" class="headerlink" title="开源驱动：（2d性能和闭源驱动相当，3d性能可能是闭源的一半，不支持opencl）"></a>开源驱动：（2d性能和闭源驱动相当，3d性能可能是闭源的一半，不支持opencl）</h1><p>yay -S nouveau-fw<br>sudo pacman -S mesa xf86-video-nouveau lib32-mesa libva-mesa-driver mesa-vdpau</p>
<h1 id="xf86-video-nouveau-2d-driver"><a href="#xf86-video-nouveau-2d-driver" class="headerlink" title="xf86-video-nouveau    2d driver"></a>xf86-video-nouveau    2d driver</h1><h1 id="nouveau-fw-nvidia官方firmware，视频硬解需要"><a href="#nouveau-fw-nvidia官方firmware，视频硬解需要" class="headerlink" title="nouveau-fw    nvidia官方firmware，视频硬解需要"></a>nouveau-fw    nvidia官方firmware，视频硬解需要</h1><h1 id="libva-mesa-driver-vaapi-视频硬解码库"><a href="#libva-mesa-driver-vaapi-视频硬解码库" class="headerlink" title="libva-mesa-driver    vaapi 视频硬解码库"></a>libva-mesa-driver    vaapi 视频硬解码库</h1><h1 id="mesa-vdpau-vdpau-视频硬解码库"><a href="#mesa-vdpau-vdpau-视频硬解码库" class="headerlink" title="mesa-vdpau    vdpau 视频硬解码库"></a>mesa-vdpau    vdpau 视频硬解码库</h1><p>AMD显卡驱动安装：</p>
<p>sudo pacman -S mesa xf86-video-amdgpu vulkan-radeon libva-mesa-driver mesa-vdpau<br>sudo pacman -S opencl-mesa lib32-vulkan-radeon lib32-mesa</p>
<h1 id="xf86-video-amdgpu-2d-driver"><a href="#xf86-video-amdgpu-2d-driver" class="headerlink" title="xf86-video-amdgpu    2d driver"></a>xf86-video-amdgpu    2d driver</h1><h1 id="vulkan-radeon-vulkan"><a href="#vulkan-radeon-vulkan" class="headerlink" title="vulkan-radeon    vulkan"></a>vulkan-radeon    vulkan</h1><h1 id="opencl-mesa-opencl"><a href="#opencl-mesa-opencl" class="headerlink" title="opencl-mesa    opencl"></a>opencl-mesa    opencl</h1><h1 id="开源驱动性能和闭源驱动差不了多少，就不考虑闭源。这方面AMD更好。"><a href="#开源驱动性能和闭源驱动差不了多少，就不考虑闭源。这方面AMD更好。" class="headerlink" title="开源驱动性能和闭源驱动差不了多少，就不考虑闭源。这方面AMD更好。"></a>开源驱动性能和闭源驱动差不了多少，就不考虑闭源。这方面AMD更好。</h1><p>如果要在Linux下工作，那么不推荐买nvidia显卡；如果只是为了打游戏，那么推荐买nvidia显卡。轻度办公和游戏，核显足够了。看视频的话，整个多核心带核显CPU就行。</p>
<p>Virtualbox（显卡）驱动安装：</p>
<p>sudo pacman -S virtualbox-guest-utils mesa lib32-mesa<br>systemctl enable –now vboxservice<br>Vmware（显卡）驱动安装：</p>
<p>sudo pacman -S mesa xf86-video-vmware xf86-input-vmmouse open-vm-tools lib32-mesa<br>systemctl enable –now vmtoolsd<br>systemctl neable –now vmware-vmblock-fuse<br>硬件无关的opencl库：</p>
<p>sudo pacman -S pocl<br>驱动安装完了，但是不知道如何使用。建议先sudo mkinitcpio -P再重启后，才会启动驱动。</p>
<p>要检查驱动的功能，可以如下方法：</p>
<p>sudo pacman -S –needed vulkan-tools libva-utils vdpauinfo mesa-demos lib32-mesa-demos</p>
<h1 id="64位的opengl信息"><a href="#64位的opengl信息" class="headerlink" title="64位的opengl信息"></a>64位的opengl信息</h1><p>glxinfo -B</p>
<h1 id="32位的opengl信息"><a href="#32位的opengl信息" class="headerlink" title="32位的opengl信息"></a>32位的opengl信息</h1><p>glxinfo32 -B</p>
<h1 id="使用glxinfo命令可以查看当前正在使用的显卡。"><a href="#使用glxinfo命令可以查看当前正在使用的显卡。" class="headerlink" title="使用glxinfo命令可以查看当前正在使用的显卡。"></a>使用glxinfo命令可以查看当前正在使用的显卡。</h1><h1 id="Intel"><a href="#Intel" class="headerlink" title="Intel"></a>Intel</h1><p>glxinfo | grep “OpenGL renderer”<br>OpenGL renderer string: Mesa Intel(R) UHD Graphics 630 (CFL GT2)</p>
<h1 id="切换NVIDIA显卡后"><a href="#切换NVIDIA显卡后" class="headerlink" title="切换NVIDIA显卡后"></a>切换NVIDIA显卡后</h1><p>glxinfo | grep “OpenGL renderer”<br>OpenGL renderer string: NVIDIA GeForce GTX 1050 Ti&#x2F;PCIe&#x2F;SSE2</p>
<h1 id="vulkan信息汇总"><a href="#vulkan信息汇总" class="headerlink" title="vulkan信息汇总"></a>vulkan信息汇总</h1><p>vulkaninfo –summary</p>
<h1 id="vaapi信息"><a href="#vaapi信息" class="headerlink" title="vaapi信息"></a>vaapi信息</h1><p>vainfo  # 注意：闭源nvidia驱动会导致该命令不可用</p>
<h1 id="vdpau信息"><a href="#vdpau信息" class="headerlink" title="vdpau信息"></a>vdpau信息</h1><p>vdpauinfo<br>此外，可能还需要切换显卡，要用这项功能，安装optimus-manager软件包：</p>
<p>具体详情参照Optimus-manager的GitHub页面</p>
<p>yay -S optimus-manager</p>
<h1 id="命令行切换显卡"><a href="#命令行切换显卡" class="headerlink" title="命令行切换显卡"></a>命令行切换显卡</h1><p>optimus-manager –switch nvidia   # 切换到 Nvidia GPU<br>optimus-manager –switch integrated  # 切换到集成 GPU 并关闭 Nvidia GPU<br>UI界面：我使用的是kde桌面环境，所以我的安装过程是</p>
<p>sudo pacman -S bbswitch<br>yay -S optimus-manager-qt-kde</p>
<h1 id="安装完成后就可以在任务栏上找到Optimus-Manager-Qt这一项"><a href="#安装完成后就可以在任务栏上找到Optimus-Manager-Qt这一项" class="headerlink" title="安装完成后就可以在任务栏上找到Optimus Manager Qt这一项"></a>安装完成后就可以在任务栏上找到Optimus Manager Qt这一项</h1><h1 id="右键可以切换显卡，之后会自动注销-你也可以打开设置进行设置。"><a href="#右键可以切换显卡，之后会自动注销-你也可以打开设置进行设置。" class="headerlink" title="右键可以切换显卡，之后会自动注销; 你也可以打开设置进行设置。"></a>右键可以切换显卡，之后会自动注销; 你也可以打开设置进行设置。</h1><h3 id="五-触控板设置"><a href="#五-触控板设置" class="headerlink" title="五. 触控板设置#"></a>五. 触控板设置#</h3><h4 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言#"></a>1.前言#</h4><p>官网wiki</p>
<p>当前系统环境是 archlinux+kde plasma5，touchegg和libinput-gestures都可以触控板需求，但是在实际配置过程中touchegg存在很多问题一直都没能解决，而libinput-gestures基本没有太大的问题。所以使用libinput-gestures。</p>
<p>kde是X.Org桌面环境，aur上维护了一个基于X.Org Server的驱动xf86-input-libinput-git很方便。而下面所说的X11 client在我这里就是kde plasma5。</p>
<p>驱动程序libinput在linux生态提供了很多驱动，本文使用的驱动是libinput，它负责分析内核从输入设备得到的数据发送给桌面环境，桌面环境根据不同的数据进行反馈。</p>
<p>术语解释</p>
<p>touchpad：通常意义上的触摸板。<br>clickpad：指底部没有按钮的touchpad，参考clickpad。clickpad中通过不同手指数量的点击行为来模拟鼠标左键、中键、右键点击。这些都可以配置或者关闭。<br>click：点击，本文语境中之物理按钮的“按压”和“释放”。<br>Clickpad software button behavior：clickpad上软按钮的行为，详情见Clickpad software button behavior。</p>
<h4 id="2-基本设置"><a href="#2-基本设置" class="headerlink" title="2.基本设置#"></a>2.基本设置#</h4><h1 id="setting-输入设备-触摸板"><a href="#setting-输入设备-触摸板" class="headerlink" title="setting -&gt; 输入设备 -&gt; 触摸板"></a>setting -&gt; 输入设备 -&gt; 触摸板</h1><p>手指轻触      轻触点击、轻触拖拽<br>双指轻触      右击（三指轻触中键点击）</p>
<h4 id="3-安装libinput-与-xdotool"><a href="#3-安装libinput-与-xdotool" class="headerlink" title="3.安装libinput 与 xdotool#"></a>3.安装libinput 与 xdotool#</h4><h1 id="确保当前用户在输入组中具有读取触摸板设备的权限"><a href="#确保当前用户在输入组中具有读取触摸板设备的权限" class="headerlink" title="确保当前用户在输入组中具有读取触摸板设备的权限"></a>确保当前用户在输入组中具有读取触摸板设备的权限</h1><p>sudo gpasswd -a $USER input</p>
<h1 id="install-basic-libinput-and-xf86-input-libinput"><a href="#install-basic-libinput-and-xf86-input-libinput" class="headerlink" title="install basic libinput and xf86-input-libinput"></a>install basic libinput and xf86-input-libinput</h1><p>sudo pacman -S libinput xf86-input-libinput</p>
<h1 id="安装-xdotool-和-libinput-gestures"><a href="#安装-xdotool-和-libinput-gestures" class="headerlink" title="安装 xdotool 和 libinput-gestures"></a>安装 xdotool 和 libinput-gestures</h1><p>yay -S xdotool libinput-gestures</p>
<h1 id="开机自动启动"><a href="#开机自动启动" class="headerlink" title="开机自动启动"></a>开机自动启动</h1><p>libinput-gestures-setup autostart</p>
<h1 id="试一下三指上下滑动成功了不，如果不成功就重启一下，如果重启了还不成功就用"><a href="#试一下三指上下滑动成功了不，如果不成功就重启一下，如果重启了还不成功就用" class="headerlink" title="试一下三指上下滑动成功了不，如果不成功就重启一下，如果重启了还不成功就用"></a>试一下三指上下滑动成功了不，如果不成功就重启一下，如果重启了还不成功就用</h1><p>sudo libinput-gestures</p>
<h1 id="试一下，如果提示少依赖，根据提示sudo-apt-get-install-提示依赖名"><a href="#试一下，如果提示少依赖，根据提示sudo-apt-get-install-提示依赖名" class="headerlink" title="试一下，如果提示少依赖，根据提示sudo apt-get install + 提示依赖名"></a>试一下，如果提示少依赖，根据提示sudo apt-get install + 提示依赖名</h1><h1 id="然后重新运行自动启动"><a href="#然后重新运行自动启动" class="headerlink" title="然后重新运行自动启动"></a>然后重新运行自动启动</h1><h4 id="4-配置"><a href="#4-配置" class="headerlink" title="4.配置#"></a>4.配置#</h4><p>libinput有两种配置方式：</p>
<p>使用配置文件的永久配置方式<br>使用xinput命令行工具，针对运行时(runtime)进行实时配置，主要用来调试。<br>libinput安装后默认的配置文件在&#x2F;usr&#x2F;share&#x2F;X11&#x2F;xorg.conf.d目录下，如何你安装多个驱动会存在多个文件：</p>
<p>ls &#x2F;usr&#x2F;share&#x2F;X11&#x2F;xorg.conf.d&#x2F;<br>10-nvidia-drm-outputclass.conf  10-quirks.conf  40-libinput.conf  50-vmmouse.conf<br>这里安装了4个驱动所以会有4个配置文件，默认情况下kde会根据文件前缀数字的大小决定优先使用哪个配置文件，数字越大优先级越高。</p>
<p>我们需要把默认配置文件复制到&#x2F;etc&#x2F;X11&#x2F;xorg.conf.d&#x2F;目录下：</p>
<p>sudo cp &#x2F;usr&#x2F;share&#x2F;X11&#x2F;xorg.conf.d&#x2F;40-libinput.conf &#x2F;etc&#x2F;X11&#x2F;xorg.conf.d&#x2F;40-libinput.conf<br>下面是文件中touchpad部分的配置：</p>
<p>Section “InputClass”<br>        Identifier “touchpad”<br>        MatchIsTouchpad “on”<br>        MatchDevicePath “&#x2F;dev&#x2F;input&#x2F;event*”<br>        Driver “libinput”<br>        Option “Tapping” “on”<br>        Option “ButtonMapping” “1 3 0 4 5 6 7”<br>        Option “TappingButtonMap” “lmr”<br>        Option “DisableWhileTyping” “on”<br>        Option “TappingDrag” “on”<br>EndSection<br>详细参数和解释见libinput man page: based on X.Org input dirver，解释下几个重要的配置参数：</p>
<p>Option “Tapping” “on”：手指点击touchpad发送鼠标点击事件<br>Option “TappingButtonMap” “lmr”：1个手指点击对应鼠标左键，2个手指点击对应鼠标中键，3个鼠标点击对应鼠标右键<br>Option “ButtonMapping” “1 3 0 4 5 6 7”，按钮映射，详情见libinput#Button_Mapping，这里笔者关闭了3指对应的左键<br>Option “DisableWhileTyping” “on”：打字时不检测touchpad事件，防止用户不小心触碰touchpad引起不必要的影响<br>Option “TappingDrag” “on”：开启点击拖拽<br>调试</p>
<h5 id="1-确定touchpad设备"><a href="#1-确定touchpad设备" class="headerlink" title="1.确定touchpad设备"></a>1.确定touchpad设备</h5><p>终端输入：xinput list<br>⎡ Virtual core pointer                          id&#x3D;2    [master pointer  (3)]<br>⎜   ↳ Virtual core XTEST pointer                id&#x3D;4    [slave  pointer  (2)]<br>⎜   ↳ ELAN962C:00 04F3:30F5 Mouse               id&#x3D;11   [slave  pointer  (2)]<br>⎜   ↳ ELAN962C:00 04F3:30F5 Touchpad            id&#x3D;12   [slave  pointer  (2)]<br>⎜   ↳ SYNA7813:00 06CB:1A1A                     id&#x3D;13   [slave  pointer  (2)]<br>⎣ Virtual core keyboard                         id&#x3D;3    [master keyboard (2)]<br>    ↳ Virtual core XTEST keyboard               id&#x3D;5    [slave  keyboard (3)]<br>    ↳ Power Button                              id&#x3D;6    [slave  keyboard (3)]<br>    ↳ Video Bus                                 id&#x3D;7    [slave  keyboard (3)]<br>    ↳ Video Bus                                 id&#x3D;8    [slave  keyboard (3)]<br>    ↳ Power Button                              id&#x3D;9    [slave  keyboard (3)]<br>    ↳ HD Camera: HD Camera                      id&#x3D;10   [slave  keyboard (3)]<br>    ↳ Huawei WMI hotkeys                        id&#x3D;14   [slave  keyboard (3)]<br>    ↳ AT Translated Set 2 keyboard              id&#x3D;15   [slave  keyboard (3)]</p>
<h5 id="2-查看touchpad的详细配置"><a href="#2-查看touchpad的详细配置" class="headerlink" title="2.查看touchpad的详细配置"></a>2.查看touchpad的详细配置</h5><h1 id="这里面有一个值很重要Device-Node-xxx-”-dev-input-event8”"><a href="#这里面有一个值很重要Device-Node-xxx-”-dev-input-event8”" class="headerlink" title="这里面有一个值很重要Device Node (xxx):”&#x2F;dev&#x2F;input&#x2F;event8”"></a>这里面有一个值很重要Device Node (xxx):”&#x2F;dev&#x2F;input&#x2F;event8”</h1><h1 id="后面使用libinput命令行时会用到这个路径"><a href="#后面使用libinput命令行时会用到这个路径" class="headerlink" title="后面使用libinput命令行时会用到这个路径"></a>后面使用libinput命令行时会用到这个路径</h1><p>终端输入：xinput list-props “ELAN962C:00 04F3:30F5 Touchpad”<br>        …<br>        libinput Left Handed Enabled (328):     0<br>        libinput Left Handed Enabled Default (329):     0<br>        libinput Send Events Modes Available (299):     1, 1<br>        libinput Send Events Mode Enabled (300):        0, 0<br>        libinput Send Events Mode Enabled Default (301):        0, 0<br>        Device Node (302):      “&#x2F;dev&#x2F;input&#x2F;event8”<br>        Device Product ID (303):        1267, 12533<br>        libinput Drag Lock Buttons (330):       <no items><br>        libinput Horizontal Scroll Enabled (331):       1<br>        libinput Scrolling Pixel Distance (332):        15<br>        libinput Scrolling Pixel Distance Default (333):        15<br>        libinput High Resolution Wheel Scroll Enabled (334):    1</p>
<h5 id="3-使用libinput-debug-events-监控touchpad事件"><a href="#3-使用libinput-debug-events-监控touchpad事件" class="headerlink" title="3.使用libinput debug-events 监控touchpad事件"></a>3.使用libinput debug-events 监控touchpad事件</h5><p>终端输入：libinput debug-events –device &#x2F;dev&#x2F;input&#x2F;event8<br>-event8   DEVICE_ADDED            ELAN962C:00 04F3:30F5 Touchpad    seat0 default group1  cap:pg  size 115x70mm tap(dl off) left scroll-nat scroll-2fg-edge click-buttonareas-clickfinger dwt-on dwtp-on<br> event8   POINTER_MOTION          +0.023s        -0.40&#x2F;  0.62 ( -2.00&#x2F; +3.10)<br> event8   POINTER_MOTION          +0.031s        -1.29&#x2F;  2.67 ( -4.00&#x2F; +8.26)<br> event8   POINTER_MOTION          +0.039s        -4.28&#x2F;  6.80 (-13.00&#x2F;+20.65)<br> event8   POINTER_MOTION          +0.047s        -8.56&#x2F; 12.72 (-25.00&#x2F;+37.16)<br>4.使用libinput debug-gui 监控touchpad事件<br>这里可能会报没有 libgtk-4.so.1 的错误，安装gtk4即可：yay -S gtk4</p>
<h1 id="这时会出现一个GUI画面帮助检测"><a href="#这时会出现一个GUI画面帮助检测" class="headerlink" title="这时会出现一个GUI画面帮助检测"></a>这时会出现一个GUI画面帮助检测</h1><p>libinput debug-gui –device &#x2F;dev&#x2F;input&#x2F;event8<br>libinput-gestures 配置<br>配置好touchpad和手势后，下面利用 libinput-gestures 来解析touchpad的数据，然后执行相关的操作。这里主要用到xdotool，xdotool是模拟键盘&#x2F;鼠标输入和窗口管理等的命令行工具。libinput-gestures依赖xdotool。</p>
<p>libinput-gestures安装后会有默认的配置，位置在&#x2F;etc&#x2F;libinput-gestures.conf，用户可以在～&#x2F;.config&#x2F;libinput-gestures.conf配置自己的配置。这里我根据自己的需要修改了相关配置如下：</p>
<h1 id="Switch-to-next-desktop"><a href="#Switch-to-next-desktop" class="headerlink" title="Switch to next desktop"></a>Switch to next desktop</h1><p>gesture swipe right 4   xdotool key ctrl+F1</p>
<h1 id="Switch-to-prev-desktop"><a href="#Switch-to-prev-desktop" class="headerlink" title="Switch to prev desktop"></a>Switch to prev desktop</h1><p>gesture swipe left 4 xdotool key ctrl+F2</p>
<h1 id="Present-windows-current-desktop"><a href="#Present-windows-current-desktop" class="headerlink" title="Present windows (current desktop)"></a>Present windows (current desktop)</h1><p>gesture swipe down 3 xdotool key ctrl+F9</p>
<h1 id="Present-windows-all-desktop"><a href="#Present-windows-all-desktop" class="headerlink" title="Present windows (all desktop)"></a>Present windows (all desktop)</h1><p>gesture swipe down 4 xdotool key ctrl+F10</p>
<h1 id="Show-desktop"><a href="#Show-desktop" class="headerlink" title="Show desktop"></a>Show desktop</h1><p>gesture swipe up 3 xdotool key super+d</p>
<h1 id="Show-desktops-grid"><a href="#Show-desktops-grid" class="headerlink" title="Show desktops grid"></a>Show desktops grid</h1><p>gesture swipe up 4 xdotool key ctrl+F8<br>主要思想是针对不同的手势触发相关的快捷键，快捷键的配置则可以在系统偏好设置→快捷键中设置。下图是我在plasma5中的切换桌面的快捷键配置：</p>
<h1 id="配置快捷键：setting-KWin"><a href="#配置快捷键：setting-KWin" class="headerlink" title="配置快捷键：setting -&gt; KWin"></a>配置快捷键：setting -&gt; KWin</h1><p>切换到上一个桌面                       Ctrl + F1<br>切换到下一个桌面                       Ctrl + F2<br>显示&#x2F;应玚窗口平铺（当前桌面）            Ctrl + F9<br>显示&#x2F;应玚窗口平铺（全部桌面）            Ctrl + F10<br>显示虚拟桌面网格                       Meta + F8<br>暂时显示桌面                          Meta + D<br>添加虚拟桌面：</p>
<h1 id="工作区行为-虚拟桌面-按自己需求添加任意个"><a href="#工作区行为-虚拟桌面-按自己需求添加任意个" class="headerlink" title="工作区行为 -&gt; 虚拟桌面 -&gt; 按自己需求添加任意个"></a>工作区行为 -&gt; 虚拟桌面 -&gt; 按自己需求添加任意个</h1><p>TODO</p>
<p>通过捏和(pinch in&#x2F;pinch out)来放大&#x2F;缩小网页（对标macbook）<br>网页的前进&#x2F;后退（对标macbook）<br>待添加…</p>
<h3 id="六-转换deb包"><a href="#六-转换deb包" class="headerlink" title="六. 转换deb包#"></a>六. 转换deb包#</h3><p>可能一些软件需要我们手动将 deb 包 转换后安装，这时候就需要 debtab 工具来转换。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>yay -S debtap</p>
<h1 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h1><p>sudo debtap -u</p>
<h1 id="下载好待转换的-deb-包，将其转换，以下步骤一路回车即可"><a href="#下载好待转换的-deb-包，将其转换，以下步骤一路回车即可" class="headerlink" title="下载好待转换的 deb 包，将其转换，以下步骤一路回车即可"></a>下载好待转换的 deb 包，将其转换，以下步骤一路回车即可</h1><p>sudo debtap ~&#x2F;Downloads&#x2F;包名.deb</p>
<h1 id="安装转换后的包"><a href="#安装转换后的包" class="headerlink" title="安装转换后的包"></a>安装转换后的包</h1><p>sudo pacman -U ~&#x2F;Downloads&#x2F;包名.pkg.tar.zst</p>
<h3 id="七-KDE-桌面美化"><a href="#七-KDE-桌面美化" class="headerlink" title="七. KDE 桌面美化#"></a>七. KDE 桌面美化#</h3><p>KDE商店</p>
<p>也可参考这个博客</p>
<h4 id="1-官网下载"><a href="#1-官网下载" class="headerlink" title="1. 官网下载#"></a>1. 官网下载#</h4><p>在 设置 -&gt; 外观中下载各种美化插件！！</p>
<p>如果没有访问，则需要手动去 主题官网 下载各类美化效果的压缩包，然后解压到下面的目录中即可</p>
<p>~&#x2F;.local&#x2F;share&#x2F;plasma&#x2F;look-and-feel&#x2F;  # 存放全局主题<br>~&#x2F;.local&#x2F;share&#x2F;plasma&#x2F;desktoptheme&#x2F;   # 存放 plasma 视觉风格<br>~&#x2F;.local&#x2F;share&#x2F;plasma&#x2F;plasmoids&#x2F;      # 存放插件<br>~&#x2F;.local&#x2F;share&#x2F;aurorae&#x2F;themes&#x2F;		  # 存放窗口装饰<br>~&#x2F;.local&#x2F;share&#x2F;color-schemes&#x2F;		  # 存放颜色<br>~&#x2F;.local&#x2F;share&#x2F;icons&#x2F;				  # 存放图标<br>~&#x2F;.local&#x2F;share&#x2F;fonts&#x2F;				  # 存放字体<br>~&#x2F;.local&#x2F;share&#x2F;sddm&#x2F;themes&#x2F;			  # 欢迎屏幕<br>~&#x2F;.local&#x2F;share&#x2F;backgrounds&#x2F;			  # 壁纸<br>在 系统设置 -&gt; 外观 中 可以应用我们下载下来的各种美化插件！</p>
<p>我的方案：</p>
<p>桌面右击-配置桌面和壁纸-获取新壁纸：Linux Cheatsheet Wallpaper-Arlinux_Linux.png</p>
<p>全局主题使用：系统自带 Breeze 微风深色-只勾选了外观布局</p>
<p>应用程序风格：Oxygen 轻氧</p>
<p>光标：ArchCusorTheme</p>
<p>欢迎屏幕：Smokey Arch Blue</p>
<p>工作区行为-锁屏-外观配置：Arlinux_Linux</p>
<p>工作区行为-最近文件：不要记住</p>
<p>开机与关机-登陆屏幕（SDDM）：sweet</p>
<h4 id="2-dock栏"><a href="#2-dock栏" class="headerlink" title="2. dock栏#"></a>2. dock栏#</h4><h1 id="删除原始默认面板菜单"><a href="#删除原始默认面板菜单" class="headerlink" title="删除原始默认面板菜单"></a>删除原始默认面板菜单</h1><p>右击下方图标面板 -&gt; 进入编辑模式 -&gt; 删除面板</p>
<h1 id="下载-latte-dock"><a href="#下载-latte-dock" class="headerlink" title="下载 latte-dock"></a>下载 latte-dock</h1><p>sudo pacman -S latte-dock</p>
<h1 id="启动-dock"><a href="#启动-dock" class="headerlink" title="启动 dock"></a>启动 dock</h1><p>latte-dock</p>
<h1 id="右击-dock-栏，配置-latte、选择布局编辑器，选择-extended"><a href="#右击-dock-栏，配置-latte、选择布局编辑器，选择-extended" class="headerlink" title="右击 dock 栏，配置 latte、选择布局编辑器，选择 extended"></a>右击 dock 栏，配置 latte、选择布局编辑器，选择 extended</h1><h1 id="右击-dock-栏，编辑停靠栏、点击高级-逐项按自己需求设置"><a href="#右击-dock-栏，编辑停靠栏、点击高级-逐项按自己需求设置" class="headerlink" title="右击 dock 栏，编辑停靠栏、点击高级 逐项按自己需求设置"></a>右击 dock 栏，编辑停靠栏、点击高级 逐项按自己需求设置</h1><h1 id="面板添加电池组件"><a href="#面板添加电池组件" class="headerlink" title="面板添加电池组件"></a>面板添加电池组件</h1><h1 id="桌面右击-添加组件-搜索电池-拖动到面板合适的位置即可"><a href="#桌面右击-添加组件-搜索电池-拖动到面板合适的位置即可" class="headerlink" title="桌面右击 -&gt; 添加组件 -&gt; 搜索电池 -&gt; 拖动到面板合适的位置即可"></a>桌面右击 -&gt; 添加组件 -&gt; 搜索电池 -&gt; 拖动到面板合适的位置即可</h1><h4 id="3-系统托盘"><a href="#3-系统托盘" class="headerlink" title="3.系统托盘#"></a>3.系统托盘#</h4><p>当打开一个应用之后，可以在 dock 栏中右击该应用的图标，然后将其固定在 dock 栏上。我们还需要一个类似 MAC 系统的 launchpad 程序，可以右击 dock 栏然后添加部件，点击右上角的 Get New Widgets。</p>
<p>搜索 OSXLaunchpad 下载并添加，然后将它添加到 dock 栏上。</p>
<p>加完成后，在 OSXLaunchpad 上单击右键，然后配置 OSXLaunchpad 向下面这样设置：</p>
<p>快捷键：meta + a<br>设置自定义背景图</p>
<h4 id="4-grub美化"><a href="#4-grub美化" class="headerlink" title="4.grub美化#"></a>4.grub美化#</h4><p>下载地址</p>
<h4 id="5-插件"><a href="#5-插件" class="headerlink" title="5.插件#"></a>5.插件#</h4><p>wallpaper-engine-kde-plugin</p>
<p>安装好之后，将原本windows的壁纸copy到linux的~&#x2F;.local&#x2F;share&#x2F;Steam目录，然后在插件里浏览此目录，原本windows存放的壁纸在Steam&#x2F;steamapps&#x2F;workshop&#x2F;content&#x2F;</p>
<h4 id="6-icons"><a href="#6-icons" class="headerlink" title="6.icons#"></a>6.icons#</h4><p>Candy icons</p>
<h4 id="7-主题"><a href="#7-主题" class="headerlink" title="7.主题#"></a>7.主题#</h4><p>win10主题</p>
<h3 id="八-终端美化"><a href="#八-终端美化" class="headerlink" title="八. 终端美化#"></a>八. 终端美化#</h3><p>Konsole配置#</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 打开Konsole -&gt; 设置 -&gt; 配置konsole</span><br><span class="line">标签栏 -&gt; 外观 -&gt; 显示 -&gt; 勾选永不</span><br><span class="line">配置方案 -&gt; 新建并命名为custom、勾选默认配置方案</span><br><span class="line">外观 -&gt; Breeze 微风 -&gt; 编辑 -&gt; 透明度10%</span><br><span class="line">外观 -&gt; 字体 -&gt; 选择 -&gt; 设置字体大小为12</span><br><span class="line"></span><br><span class="line"># 设置 -&gt; 显示工具栏 -&gt; 取消勾选主工具栏、会话工具栏</span><br><span class="line"></span><br><span class="line"># 设置 -&gt; 取消勾选菜单栏（可通过右击终端设置中打开菜单栏）</span><br></pre></td></tr></table></figure>
<p>🚀 zsh#<br>zsh 基本兼容 bash，但相比 bash，又有诸多优点：</p>
<p>更强大的 tab 补全<br>更智能的切换目录<br>大小写字母自动更正<br>更强大的 alias 命令<br>丰富多彩的主题<br>可以集成各种类型的插件<br>#<br>🍧 碎碎念#<br>当然，也有很多人对 bash 爱的深沉，这些都看个人喜好啦。</p>
<p>可以参考这篇文章进行美化</p>
<p>zsh终端美化 powerlevel10k配置</p>
<h4 id="1-通过以下命令安装-zsh-相关的包："><a href="#1-通过以下命令安装-zsh-相关的包：" class="headerlink" title="1.通过以下命令安装 zsh 相关的包："></a>1.通过以下命令安装 zsh 相关的包：</h4><p>sudo pacman -S zsh zsh-autosuggestions zsh-syntax-highlighting zsh-completions<br>📑 相关包说明：</p>
<p>zsh-autosuggestions —— 命令自动补全插件<br>zsh-syntax-highlighting —— 语法上高亮插件<br>zsh-completions —— 补充补全定义</p>
<h4 id="2-安装-autojump插件："><a href="#2-安装-autojump插件：" class="headerlink" title="2.安装 autojump插件："></a>2.安装 autojump插件：</h4><p>sudo pacman -S autojump</p>
<h4 id="3-更改账户的默认-Shell："><a href="#3-更改账户的默认-Shell：" class="headerlink" title="3.更改账户的默认 Shell："></a>3.更改账户的默认 Shell：</h4><p>chsh -l # 查看安装了哪些 Shell<br>chsh -s &#x2F;usr&#x2F;bin&#x2F;zsh # 修改当前账户的默认 Shell</p>
<h4 id="4-注销并重新登录-打开终端，此时会弹出如下界面进行设置："><a href="#4-注销并重新登录-打开终端，此时会弹出如下界面进行设置：" class="headerlink" title="4.注销并重新登录 &gt; 打开终端，此时会弹出如下界面进行设置："></a>4.注销并重新登录 &gt; 打开终端，此时会弹出如下界面进行设置：</h4><p><img src="https://img2023.cnblogs.com/blog/3084858/202302/3084858-20230214235244835-2047495655.png"><br>zsh_step-5</p>
<p>按下 0 将创建一个只包含注释的 ~&#x2F;.zshrc 文件，在下次启动时不会再次弹出设置选项。<br>按下 1 即可进入设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Please pick one of the following options:</span><br><span class="line"></span><br><span class="line">(1)  Configure settings for history, i.e. command lines remembered</span><br><span class="line">     and saved by the shell.  (Recommended.)</span><br><span class="line"></span><br><span class="line">(2)  Configure the new completion system.  (Recommended.)</span><br><span class="line"></span><br><span class="line">(3)  Configure how keys behave when editing command lines.  (Recommended.)</span><br><span class="line"></span><br><span class="line">(4)  Pick some of the more common shell options.  These are simple &quot;on&quot;</span><br><span class="line">     or &quot;off&quot; switches controlling the shell&#x27;s features.</span><br><span class="line"></span><br><span class="line">(0)  Exit, creating a blank ~/.zshrc file.</span><br><span class="line"></span><br><span class="line">(a)  Abort all settings and start from scratch.  Note this will overwrite</span><br><span class="line">     any settings from zsh-newuser-install already in the startup file.</span><br><span class="line">     It will not alter any of your other settings, however.</span><br><span class="line"></span><br><span class="line">(q)  Quit and do nothing else.  The function will be run again next time.</span><br></pre></td></tr></table></figure>
<p>根据提示完成设置即可。也可以创建一个只包含注释的 ~&#x2F;.zshrc 文件以使用默认值。</p>
<p>ℹ️ 提示</p>
<p>root 账户需要手动创建 root&#x2F;.zshrc 文件。</p>
<p>ℹ️ 提示</p>
<p>若希望重新设置，只需要把 ~&#x2F;.zshrc 文件删掉即可。</p>
<h4 id="5-为了让插件生效，需要修改-zshrc。使用-vim-编辑-zshrc-文件："><a href="#5-为了让插件生效，需要修改-zshrc。使用-vim-编辑-zshrc-文件：" class="headerlink" title="5.为了让插件生效，需要修改 ~&#x2F;.zshrc。使用 vim 编辑 ~&#x2F;.zshrc 文件："></a>5.为了让插件生效，需要修改 ~&#x2F;.zshrc。使用 vim 编辑 ~&#x2F;.zshrc 文件：</h4><p>vim ~&#x2F;.zshrc<br>将以下内容分别添加到需要设置 zsh 账户的 ~&#x2F;.zshrc 中：</p>
<p>source &#x2F;usr&#x2F;share&#x2F;zsh&#x2F;plugins&#x2F;zsh-syntax-highlighting&#x2F;zsh-syntax-highlighting.zsh<br>source &#x2F;usr&#x2F;share&#x2F;zsh&#x2F;plugins&#x2F;zsh-autosuggestions&#x2F;zsh-autosuggestions.zsh<br>source &#x2F;usr&#x2F;share&#x2F;autojump&#x2F;autojump.zsh<br><img src="https://img2023.cnblogs.com/blog/3084858/202302/3084858-20230214235244240-1596268782.png"><br>zsh_step-6</p>
<h4 id="6-关闭并重新打开终端，测试一下："><a href="#6-关闭并重新打开终端，测试一下：" class="headerlink" title="6.关闭并重新打开终端，测试一下："></a>6.关闭并重新打开终端，测试一下：</h4><p><img src="https://img2023.cnblogs.com/blog/3084858/202302/3084858-20230214235245817-1020333573.png"><br>zsh_step-7</p>
<p>提示</p>
<p>可能需要:</p>
<p>将在 ~&#x2F;.bash_profile 所做的配置复制到 ~&#x2F;.zsh_profile<br>将在 ~&#x2F;.bashrc 所做的配置复制到 ~&#x2F;.zshrc<br>如在步骤 1. 配置 root 账户的默认编辑器 和 8. 配置非 root 账户的默认编辑器 所做的配置。<br>🔗 相关链接：</p>
<p>关于 zsh 的美化请参阅 系统美化。</p>
<p>oh_my_zsh#<br>可以参考这篇文章</p>
<p>Zim#<br>Zim 是一个 zsh 的模块化配置框架</p>
<p>安装<br>wget -nv -O - <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/zimfw/install/master/install.zsh">https://raw.githubusercontent.com/zimfw/install/master/install.zsh</a> | zsh<br>配置<br>Zimfw 的配置文件为 ~&#x2F;.zimrc</p>
<p>使用任意文本编辑器打开它，配置文件的编写格式为:</p>
<p>zmodule [module name] # 模块在 zimfw 官方组织<br>zmodule [author]&#x2F;[module name] # 模块在 Github 上<br>zmodule https:&#x2F;&#x2F;[host]&#x2F;[author]&#x2F;[module name].git # 模块在其他 Git 仓库中<br>在添加好模块后，可以通过 zimfw install 命令安装，本文同样提供模块推荐</p>
<p>在之后可以通过 zimfw update 更新模块，通过 zimfw upgrade 更新 Zim 本体</p>
<p>模块推荐#<br>部分内容来自 Zim 官方网站</p>
<p>下拉式终端 yakuake</p>
<h1 id="第一次打开会让设置下拉终端快捷键-按自己方便设置即可"><a href="#第一次打开会让设置下拉终端快捷键-按自己方便设置即可" class="headerlink" title="第一次打开会让设置下拉终端快捷键 -&gt; 按自己方便设置即可"></a>第一次打开会让设置下拉终端快捷键 -&gt; 按自己方便设置即可</h1><h1 id="该终端也Konsole共享系统配置，不用再对系统配置作更改"><a href="#该终端也Konsole共享系统配置，不用再对系统配置作更改" class="headerlink" title="该终端也Konsole共享系统配置，不用再对系统配置作更改"></a>该终端也Konsole共享系统配置，不用再对系统配置作更改</h1><h1 id="设置yakuake独有配置"><a href="#设置yakuake独有配置" class="headerlink" title="设置yakuake独有配置"></a>设置yakuake独有配置</h1><h1 id="打开yakuake-面板会有终端小图标出现）、右击"><a href="#打开yakuake-面板会有终端小图标出现）、右击" class="headerlink" title="打开yakuake(面板会有终端小图标出现）、右击"></a>打开yakuake(面板会有终端小图标出现）、右击</h1><h1 id="宽度：100"><a href="#宽度：100" class="headerlink" title="宽度：100%"></a>宽度：100%</h1><h1 id="高度：100"><a href="#高度：100" class="headerlink" title="高度：100%"></a>高度：100%</h1><h1 id="配置yakuake"><a href="#配置yakuake" class="headerlink" title="配置yakuake"></a>配置yakuake</h1><h1 id="窗口-取消勾选显示标d题栏、取消勾选显示标签栏"><a href="#窗口-取消勾选显示标d题栏、取消勾选显示标签栏" class="headerlink" title="窗口 -&gt; 取消勾选显示标d题栏、取消勾选显示标签栏"></a>窗口 -&gt; 取消勾选显示标d题栏、取消勾选显示标签栏</h1><h1 id="外观-勾选隐藏边框"><a href="#外观-勾选隐藏边框" class="headerlink" title="外观 -&gt; 勾选隐藏边框"></a>外观 -&gt; 勾选隐藏边框</h1><h1 id="设置开机自启动-1"><a href="#设置开机自启动-1" class="headerlink" title="设置开机自启动"></a>设置开机自启动</h1><h1 id="设置-开机与关机-自动启动-添加-添加应用程序-系统-Yakuake"><a href="#设置-开机与关机-自动启动-添加-添加应用程序-系统-Yakuake" class="headerlink" title="设置 -&gt; 开机与关机 -&gt; 自动启动 -&gt; 添加 -&gt; 添加应用程序 -&gt; 系统 -&gt; Yakuake"></a>设置 -&gt; 开机与关机 -&gt; 自动启动 -&gt; 添加 -&gt; 添加应用程序 -&gt; 系统 -&gt; Yakuake</h1><h3 id="九-其他软件安装"><a href="#九-其他软件安装" class="headerlink" title="九. 其他软件安装#"></a>九. 其他软件安装#</h3><h4 id="1-Typora"><a href="#1-Typora" class="headerlink" title="1. Typora#"></a>1. Typora#</h4><p>方式一：二进制包<br>Typora 最新版已经收费，可以在官网下载以前的版本并手动安装，下面是最后一个免费版本两种下载方法：</p>
<p>1.点我跳转<br>2.首先下载文件：SAGIMA主页 找到2022-12-12那天的资源<br>下载完成后手动安装:</p>
<p>sudo tar xzvf Typora-linux-x64.tar.gz<br>cd bin<br>sudo cp -ar Typora-linux-x64 &#x2F;opt<br>cd &#x2F;opt&#x2F;Typora-linux-x64&#x2F;<br>#启动<br>.&#x2F;Typora<br>为了能够在任意位置启动软件，得设置一下环境变量</p>
<p>sudo gedit ~&#x2F;.bashrc<br>打开.bashrc配置文件，添加：</p>
<p>#Typora环境变量<br>export PATH&#x3D;$PATH:&#x2F;opt&#x2F;Typora-linux-x64<br>保存后关闭文件，source一下，让配置生效</p>
<p>source ~&#x2F;.bashrc<br>这样我们在任意终端中输入“Typora”再回车，就可以打开软件了</p>
<p>添加可视化启动程序，在cd &#x2F;usr&#x2F;share&#x2F;applications下新建以下文件，Typora 内部自己有 PNG 图片，所以不需要额外下载，直接复制粘贴以下内容即可：</p>
<p>[Desktop Entry]<br>Name&#x3D;Typora<br>Comment&#x3D;Typora<br>Exec&#x3D;&#x2F;opt&#x2F;Typora-linux-x64&#x2F;Typora<br>Icon&#x3D;&#x2F;opt&#x2F;Typora-linux-x64&#x2F;resources&#x2F;app&#x2F;asserts&#x2F;icon&#x2F;icon_256x256.png<br>Terminal&#x3D;false<br>Type&#x3D;Application<br>Categories&#x3D;Developer;<br>设置在.md文件上右键能够选择用Typora打开，进入终端</p>
<p>sudo gedit ~&#x2F;.config&#x2F;mimeapps.list<br>然后在文件的[Added Associations]一栏下面加上一行</p>
<p>sudo text&#x2F;markdown&#x3D;typora.desktop;<br>方式二：deb包</p>
<h1 id="直接Typora官网下载最新deb包"><a href="#直接Typora官网下载最新deb包" class="headerlink" title="直接Typora官网下载最新deb包"></a>直接Typora官网下载最新deb包</h1><h1 id="利用前面安装的deb包转换工具安装即可"><a href="#利用前面安装的deb包转换工具安装即可" class="headerlink" title="利用前面安装的deb包转换工具安装即可"></a>利用前面安装的deb包转换工具安装即可</h1><h4 id="2-Navicat"><a href="#2-Navicat" class="headerlink" title="2. Navicat#"></a>2. Navicat#</h4><h1 id="创建AppImage、二进制格式软件存放目录"><a href="#创建AppImage、二进制格式软件存放目录" class="headerlink" title="创建AppImage、二进制格式软件存放目录"></a>创建AppImage、二进制格式软件存放目录</h1><p>mkdir -p ~&#x2F;Application&#x2F;{AppImage,binary}</p>
<h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p>cd ~&#x2F;Application&#x2F;AppImage<br>wget <a target="_blank" rel="noopener" href="http://download.navicat.com.cn/download/navicat16-premium-cs.AppImage">http://download.navicat.com.cn/download/navicat16-premium-cs.AppImage</a></p>
<h1 id="赋权"><a href="#赋权" class="headerlink" title="赋权"></a>赋权</h1><p>chmod +x navicat16-premium-cs.AppImage</p>
<h1 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h1><p>.&#x2F;navicat16-premium-cs.AppImage</p>
<h1 id="第一次通过上面方式启动后Navicat会自动创建桌面图标，下次启动就可以直接以快捷方式启动！"><a href="#第一次通过上面方式启动后Navicat会自动创建桌面图标，下次启动就可以直接以快捷方式启动！" class="headerlink" title="第一次通过上面方式启动后Navicat会自动创建桌面图标，下次启动就可以直接以快捷方式启动！"></a>第一次通过上面方式启动后Navicat会自动创建桌面图标，下次启动就可以直接以快捷方式启动！</h1><h3 id="十-常见Bug解决"><a href="#十-常见Bug解决" class="headerlink" title="十. 常见Bug解决#"></a>十. 常见Bug解决#</h3><h4 id="1-VScode-Git保持登录状态"><a href="#1-VScode-Git保持登录状态" class="headerlink" title="1. VScode Git保持登录状态#"></a>1. VScode Git保持登录状态#</h4><p>arch 系的 Linux 无法保存 vscode 里 github 的登录状态，需要下载一个插件进行解决</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S qtkeychain gnome-keyring</span><br></pre></td></tr></table></figure>
<p>作者：vconlln</p>
<p>出处：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/vconlln/p/17065420.html">https://www.cnblogs.com/vconlln/p/17065420.html</a></p>
<p>版权：本作品采用「署名-非商业性使用-相同方式共享 4.0 国际」许可协议进行许可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/06/11/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%EF%BC%88%E9%99%84Python%E5%AE%9E%E7%8E%B0%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="英雄本色">
      <meta itemprop="description" content="英雄本色的博客，记录生活，分享感悟。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="英雄本色的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/06/11/%E4%B8%80%E6%96%87%E8%AF%BB%E6%87%82%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%EF%BC%88%E9%99%84Python%E5%AE%9E%E7%8E%B0%EF%BC%89/" class="post-title-link" itemprop="url">一文读懂遗传算法工作原理（附Python实现）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-06-11 22:01:29 / 修改时间：22:54:47" itemprop="dateCreated datePublished" datetime="2024-06-11T22:01:29+08:00">2024-06-11</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>转载 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/28328304">https://zhuanlan.zhihu.com/p/28328304</a></p>
<p><img src="https://picx.zhimg.com/70/v2-7a45b6b390aedcac825d700a1f8ea596_1440w.avis?source=172ae18b&biz_tag=Post"><br>近日，Analyticsvidhya 上发表了一篇题为《Introduction to Genetic Algorithm &amp; their application in data science》的文章，作者 Shubham Jain 现身说法，用通俗易懂的语言对遗传算法作了一个全面而扼要的概述，并列举了其在多个领域的实际应用，其中重点介绍了遗传算法的数据科学应用。机器之心对该文进行了编译，原文链接请见文末。</p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>几天前，我着手解决一个实际问题——大型超市销售问题。在使用了几个简单模型做了一些特征工程之后，我在排行榜上名列第 219 名。</p>
<p><img src="https://pic2.zhimg.com/80/v2-f522f83c180bfdf34403cb7a0b6af339_720w.webp"></p>
<p>虽然结果不错，但是我还是想做得更好。于是，我开始研究可以提高分数的优化方法。结果我果然找到了一个，它叫遗传算法。在把它应用到超市销售问题之后，最终我的分数在排行榜上一下跃居前列。</p>
<p><img src="https://pic2.zhimg.com/80/v2-0c473b00cb5074bc83be05469bb8c5bd_720w.webp"></p>
<p>没错，仅靠遗传算法我就从 219 名直接跳到 15 名，厉害吧！相信阅读完本篇文章后，你也可以很自如地应用遗传算法，而且会发现，当把它用到你自己正在处理的问题时，效果也会有很大提升。</p>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>1、遗传算法理论的由来</p>
<p>2、生物学的启发</p>
<p>3、遗传算法定义</p>
<p>4、遗传算法具体步骤</p>
<p>初始化</p>
<p>适应度函数</p>
<p>选择</p>
<p>交叉</p>
<p>变异</p>
<p>5、遗传算法的应用</p>
<p>特征选取</p>
<p>使用 TPOT 库实现</p>
<p>6、实际应用</p>
<p>7、结语</p>
<h3 id="1、遗传算法理论的由来"><a href="#1、遗传算法理论的由来" class="headerlink" title="1、遗传算法理论的由来"></a>1、遗传算法理论的由来</h3><p>我们先从查尔斯·达尔文的一句名言开始：</p>
<p>能够生存下来的往往不是最强大的物种，也不是最聪明的物种，而是最能适应环境的物种。</p>
<p>你也许在想：这句话和遗传算法有什么关系？其实遗传算法的整个概念就基于这句话。</p>
<p>让我们用一个基本例子来解释 ：</p>
<p>我们先假设一个情景，现在你是一国之王，为了让你的国家免于灾祸，你实施了一套法案：</p>
<p>你选出所有的好人，要求其通过生育来扩大国民数量。<br>这个过程持续进行了几代。<br>你将发现，你已经有了一整群的好人。</p>
<p>这个例子虽然不太可能，但是我用它是想帮助你理解概念。也就是说，我们改变了输入值（比如：人口），就可以获得更好的输出值（比如：更好的国家）。现在，我假定你已经对这个概念有了大致理解，认为遗传算法的含义应该和生物学有关系。那么我们就快速地看一些小概念，这样便可以将其联系起来理解。</p>
<h3 id="2、生物学的启发"><a href="#2、生物学的启发" class="headerlink" title="2、生物学的启发"></a>2、生物学的启发</h3><p>相信你还记得这句话：「细胞是所有生物的基石。」由此可知，在一个生物的任何一个细胞中，都有着相同的一套染色体。所谓染色体，就是指由 DNA 组成的聚合体。</p>
<p><img src="https://pic2.zhimg.com/80/v2-46dad9291bf5315078c6b8119877a9a5_720w.webp"></p>
<p>传统上看，这些染色体可以被由数字 0 和 1 组成的字符串表达出来。</p>
<p><img src="https://pic2.zhimg.com/80/v2-46dad9291bf5315078c6b8119877a9a5_720w.webp"></p>
<p>一条染色体由基因组成，这些基因其实就是组成 DNA 的基本结构，DNA 上的每个基因都编码了一个独特的性状，比如，头发或者眼睛的颜色。希望你在继续阅读之前先回忆一下这里提到的生物学概念。结束了这部分，现在我们来看看所谓遗传算法实际上指的是什么？</p>
<h3 id="3、遗传算法定义"><a href="#3、遗传算法定义" class="headerlink" title="3、遗传算法定义"></a>3、遗传算法定义</h3><p>首先我们回到前面讨论的那个例子，并总结一下我们做过的事情。</p>
<p>首先，我们设定好了国民的初始人群大小。<br>然后，我们定义了一个函数，用它来区分好人和坏人。<br>再次，我们选择出好人，并让他们繁殖自己的后代。<br>最后，这些后代们从原来的国民中替代了部分坏人，并不断重复这一过程。</p>
<p>遗传算法实际上就是这样工作的，也就是说，它基本上尽力地在某种程度上模拟进化的过程。</p>
<p>因此，为了形式化定义一个遗传算法，我们可以将它看作一个优化方法，它可以尝试找出某些输入，凭借这些输入我们便可以得到最佳的输出值或者是结果。遗传算法的工作方式也源自于生物学，具体流程见下图：</p>
<p><img src="https://pic4.zhimg.com/80/v2-71baf20b857d4d740e183ca7ba06bf0f_720w.webp"></p>
<p>那么现在我们来逐步理解一下整个流程。</p>
<h3 id="4、遗传算法具体步骤"><a href="#4、遗传算法具体步骤" class="headerlink" title="4、遗传算法具体步骤"></a>4、遗传算法具体步骤</h3><p>为了让讲解更为简便，我们先来理解一下著名的组合优化问题「背包问题」。如果你还不太懂，这里有一个我的解释版本。</p>
<p>比如，你准备要去野游 1 个月，但是你只能背一个限重 30 公斤的背包。现在你有不同的必需物品，它们每一个都有自己的「生存点数」（具体在下表中已给出）。因此，你的目标是在有限的背包重量下，最大化你的「生存点数」。</p>
<p><img src="https://pic3.zhimg.com/80/v2-a69fc118ba38d36e9546fabc21bf2c8e_720w.webp"></p>
<p>4.1 初始化</p>
<p>这里我们用遗传算法来解决这个背包问题。第一步是定义我们的总体。总体中包含了个体，每个个体都有一套自己的染色体。</p>
<p>我们知道，染色体可表达为 2 进制数串，在这个问题中，1 代表接下来位置的基因存在，0 意味着丢失。（译者注：作者这里借用染色体、基因来解决前面的背包问题，所以特定位置上的基因代表了上方背包问题表格中的物品，比如第一个位置上是 Sleeping Bag，那么此时反映在染色体的『基因』位置就是该染色体的第一个『基因』。）</p>
<p><img src="https://pic3.zhimg.com/80/v2-dafeba7904e16ace59bb60e289815cd6_720w.webp"></p>
<p>现在，我们将图中的 4 条染色体看作我们的总体初始值。</p>
<p>4.2 适应度函数</p>
<p>接下来，让我们来计算一下前两条染色体的适应度分数。对于 A1 染色体 [100110] 而言，有：</p>
<p><img src="https://pic1.zhimg.com/80/v2-07b5a0de472b31b377246335948e7c04_720w.webp"></p>
<p>类似地，对于 A2 染色体 [001110] 来说，有：</p>
<p><img src="https://pic4.zhimg.com/80/v2-cf0f2b05eb569459a089dce3dfc19abf_720w.webp"></p>
<p>对于这个问题，我们认为，当染色体包含更多生存分数时，也就意味着它的适应性更强。</p>
<p>因此，由图可知，染色体 1 适应性强于染色体 2。</p>
<p>4.3 选择</p>
<p>现在，我们可以开始从总体中选择适合的染色体，来让它们互相『交配』，产生自己的下一代了。这个是进行选择操作的大致想法，但是这样将会导致染色体在几代之后相互差异减小，失去了多样性。因此，我们一般会进行「轮盘赌选择法」（Roulette Wheel Selection method）。</p>
<p><img src="https://pic1.zhimg.com/80/v2-73cfce9d7de4d073042655095856ef24_720w.webp"></p>
<p>想象有一个轮盘，现在我们将它分割成 m 个部分，这里的 m 代表我们总体中染色体的个数。每条染色体在轮盘上占有的区域面积将根据适应度分数成比例表达出来。</p>
<p><img src="https://pic2.zhimg.com/80/v2-6d88e5a3f1713d56f7423022937f578d_720w.webp"></p>
<p>基于上图中的值，我们建立如下「轮盘」。</p>
<p><img src="https://pic3.zhimg.com/80/v2-f19147bda57b189dba7ee39ebd8360d6_720w.webp"></p>
<p>现在，这个轮盘开始旋转，我们将被图中固定的指针（fixed point）指到的那片区域选为第一个亲本。然后，对于第二个亲本，我们进行同样的操作。有时候我们也会在途中标注两个固定指针，如下图：</p>
<p><img src="https://pic1.zhimg.com/80/v2-fa0556de7fa3c25af7f344f209c886b4_720w.webp"></p>
<p>通过这种方法，我们可以在一轮中就获得两个亲本。我们将这种方法成为「随机普遍选择法」（Stochastic Universal Selection method）。</p>
<p>4.4 交叉</p>
<p>在上一个步骤中，我们已经选择出了可以产生后代的亲本染色体。那么用生物学的话说，所谓「交叉」，其实就是指的繁殖。现在我们来对染色体 1 和 4（在上一个步骤中选出来的）进行「交叉」，见下图：</p>
<p><img src="https://pic2.zhimg.com/80/v2-47e942407f40368a304925e9361ad031_720w.webp"></p>
<p>这是交叉最基本的形式，我们称其为「单点交叉」。这里我们随机选择一个交叉点，然后，将交叉点前后的染色体部分进行染色体间的交叉对调，于是就产生了新的后代。</p>
<p>如果你设置两个交叉点，那么这种方法被成为「多点交叉」，见下图：</p>
<p><img src="https://pic1.zhimg.com/80/v2-99a09ec98d8b52dfa484760c450ba19c_720w.webp"></p>
<p>4.5 变异</p>
<p>如果现在我们从生物学的角度来看这个问题，那么请问：由上述过程产生的后代是否有和其父母一样的性状呢？答案是否。在后代的生长过程中，它们体内的基因会发生一些变化，使得它们与父母不同。这个过程我们称为「变异」，它可以被定义为染色体上发生的随机变化，正是因为变异，种群中才会存在多样性。</p>
<p>下图为变异的一个简单示例：</p>
<p><img src="https://pic4.zhimg.com/80/v2-7a175eb56c6df95fa8e408fddb89623b_720w.webp"></p>
<p>变异完成之后，我们就得到了新为个体，进化也就完成了，整个过程如下图：</p>
<p><img src="https://pic4.zhimg.com/80/v2-e5c9c15540d37e0879dfccb02c0550c7_720w.webp"></p>
<p>在进行完一轮「遗传变异」之后，我们用适应度函数对这些新的后代进行验证，如果函数判定它们适应度足够，那么就会用它们从总体中替代掉那些适应度不够的染色体。这里有个问题，我们最终应该以什么标准来判断后代达到了最佳适应度水平呢？</p>
<p>一般来说，有如下几个终止条件：</p>
<p>在进行 X 次迭代之后，总体没有什么太大改变。<br>我们事先为算法定义好了进化的次数。<br>当我们的适应度函数已经达到了预先定义的值。</p>
<p>好了，现在我假设你已基本理解了遗传算法的要领，那么现在让我们用它在数据科学的场景中应用一番。</p>
<h3 id="5、遗传算法的应用"><a href="#5、遗传算法的应用" class="headerlink" title="5、遗传算法的应用"></a>5、遗传算法的应用</h3><p>5.1 特征选取</p>
<p>试想一下每当你参加一个数据科学比赛，你会用什么方法来挑选那些对你目标变量的预测来说很重要的特征呢？你经常会对模型中特征的重要性进行一番判断，然后手动设定一个阈值，选择出其重要性高于这个阈值的特征。</p>
<p>那么，有没有什么方法可以更好地处理这个问题呢？其实处理特征选取任务最先进的算法之一就是遗传算法。</p>
<p>我们前面处理背包问题的方法可以完全应用到这里。现在，我们还是先从建立「染色体」总体开始，这里的染色体依旧是二进制数串，「1」表示模型包含了该特征，「0 表示模型排除了该特征」。</p>
<p>不过，有一个不同之处，即我们的适应度函数需要改变一下。这里的适应度函数应该是这次比赛的的精度的标准。也就是说，如果染色体的预测值越精准，那么就可以说它的适应度更高。</p>
<p>现在我假设你已经对这个方法有点一概念了。下面我不会马上讲解这个问题的解决过程，而是让我们先来用 TPOT 库去实现它。</p>
<p>5.2 用 TPOT 库来实现</p>
<p>这个部分相信是你在一开始读本文时心里最终想实现的那个目标。即：实现。那么首先我们来快速浏览一下 TPOT 库（Tree-based Pipeline Optimisation Technique，树形传递优化技术），该库基于 scikit-learn 库建立。下图为一个基本的传递结构。</p>
<p><img src="https://pic2.zhimg.com/80/v2-11bc6d17c66220b177ce56e416fefa81_720w.webp"></p>
<p>图中的灰色区域用 TPOT 库实现了自动处理。实现该部分的自动处理需要用到遗传算法。</p>
<p>我们这里不深入讲解，而是直接应用它。为了能够使用 TPOT 库，你需要先安装一些 TPOT 建立于其上的 python 库。下面我们快速安装它们：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># installing DEAP, update_checker and tqdm </span><br><span class="line">pip install deap update_checker tqdm</span><br><span class="line"># installling TPOT </span><br><span class="line">pip install tpot</span><br></pre></td></tr></table></figure>

<p>这里，我用了 Big Mart Sales（数据集地址：<a target="_blank" rel="noopener" href="https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/%EF%BC%89%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%8C%E4%B8%BA%E5%AE%9E%E7%8E%B0%E5%81%9A%E5%87%86%E5%A4%87%EF%BC%8C%E6%88%91%E4%BB%AC%E5%85%88%E5%BF%AB%E9%80%9F%E4%B8%8B%E8%BD%BD%E8%AE%AD%E7%BB%83%E5%92%8C%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6%EF%BC%8C%E4%BB%A5%E4%B8%8B%E6%98%AF">https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/）数据集，为实现做准备，我们先快速下载训练和测试文件，以下是</a> python 代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"># import basic libraries</span><br><span class="line">import numpy as np </span><br><span class="line">import pandas as pd </span><br><span class="line">import matplotlib.pyplot as plt </span><br><span class="line">%matplotlib inline </span><br><span class="line">from sklearn import preprocessing </span><br><span class="line">from sklearn.metrics import mean_squared_error </span><br><span class="line">## preprocessing </span><br><span class="line">### mean imputations </span><br><span class="line">train[&#x27;Item_Weight&#x27;].fillna((train[&#x27;Item_Weight&#x27;].mean()), inplace=True)</span><br><span class="line">test[&#x27;Item_Weight&#x27;].fillna((test[&#x27;Item_Weight&#x27;].mean()), inplace=True)</span><br><span class="line"> ### reducing fat content to only two categories </span><br><span class="line">train[&#x27;Item_Fat_Content&#x27;] = train[&#x27;Item_Fat_Content&#x27;].replace([&#x27;low fat&#x27;,&#x27;LF&#x27;], [&#x27;Low Fat&#x27;,&#x27;Low Fat&#x27;]) </span><br><span class="line">train[&#x27;Item_Fat_Content&#x27;] = train[&#x27;Item_Fat_Content&#x27;].replace([&#x27;reg&#x27;], [&#x27;Regular&#x27;]) </span><br><span class="line">test[&#x27;Item_Fat_Content&#x27;] = test[&#x27;Item_Fat_Content&#x27;].replace([&#x27;low fat&#x27;,&#x27;LF&#x27;], [&#x27;Low Fat&#x27;,&#x27;Low Fat&#x27;]) </span><br><span class="line">test[&#x27;Item_Fat_Content&#x27;] = test[&#x27;Item_Fat_Content&#x27;].replace([&#x27;reg&#x27;], [&#x27;Regular&#x27;]) </span><br><span class="line">train[&#x27;Outlet_Establishment_Year&#x27;] = 2013 - train[&#x27;Outlet_Establishment_Year&#x27;] </span><br><span class="line">test[&#x27;Outlet_Establishment_Year&#x27;] = 2013 - test[&#x27;Outlet_Establishment_Year&#x27;] </span><br><span class="line"></span><br><span class="line">train[&#x27;Outlet_Size&#x27;].fillna(&#x27;Small&#x27;,inplace=True)</span><br><span class="line">test[&#x27;Outlet_Size&#x27;].fillna(&#x27;Small&#x27;,inplace=True)</span><br><span class="line"></span><br><span class="line">train[&#x27;Item_Visibility&#x27;] = np.sqrt(train[&#x27;Item_Visibility&#x27;])</span><br><span class="line">test[&#x27;Item_Visibility&#x27;] = np.sqrt(test[&#x27;Item_Visibility&#x27;])</span><br><span class="line"></span><br><span class="line">col = [&#x27;Outlet_Size&#x27;,&#x27;Outlet_Location_Type&#x27;,&#x27;Outlet_Type&#x27;,&#x27;Item_Fat_Content&#x27;]</span><br><span class="line">test[&#x27;Item_Outlet_Sales&#x27;] = 0</span><br><span class="line">combi = train.append(test)</span><br><span class="line">for i in col:</span><br><span class="line"> combi[i] = number.fit_transform(combi[i].astype(&#x27;str&#x27;))</span><br><span class="line"> combi[i] = combi[i].astype(&#x27;object&#x27;)</span><br><span class="line">train = combi[:train.shape[0]]</span><br><span class="line">test = combi[train.shape[0]:]</span><br><span class="line">test.drop(&#x27;Item_Outlet_Sales&#x27;,axis=1,inplace=True)</span><br><span class="line"></span><br><span class="line">## removing id variables </span><br><span class="line">tpot_train = train.drop([&#x27;Outlet_Identifier&#x27;,&#x27;Item_Type&#x27;,&#x27;Item_Identifier&#x27;],axis=1)</span><br><span class="line">tpot_test = test.drop([&#x27;Outlet_Identifier&#x27;,&#x27;Item_Type&#x27;,&#x27;Item_Identifier&#x27;],axis=1)</span><br><span class="line">target = tpot_train[&#x27;Item_Outlet_Sales&#x27;]</span><br><span class="line">tpot_train.drop(&#x27;Item_Outlet_Sales&#x27;,axis=1,inplace=True)</span><br><span class="line"></span><br><span class="line"># finally building model using tpot library</span><br><span class="line">from tpot import TPOTRegressor</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(tpot_train, target,</span><br><span class="line"> train_size=0.75, test_size=0.25)</span><br><span class="line"></span><br><span class="line">tpot = TPOTRegressor(generations=5, population_size=50, verbosity=2)</span><br><span class="line">tpot.fit(X_train, y_train)</span><br><span class="line">print(tpot.score(X_test, y_test))</span><br><span class="line">tpot.export(&#x27;tpot_boston_pipeline.py&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="https://pic2.zhimg.com/80/v2-f3f823f771594f151665d85c934de4e1_720w.webp"></p>
<p>一旦这些代码运行完成，tpot_exported_pipeline.py 里就将会放入用于路径优化的 python 代码。我们可以发现，ExtraTreeRegressor 可以最好地解决这个问题。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">## predicting using tpot optimised pipeline</span><br><span class="line">tpot_pred = tpot.predict(tpot_test)</span><br><span class="line">sub1 = pd.DataFrame(data=tpot_pred)</span><br><span class="line">#sub1.index = np.arange(0, len(test)+1)</span><br><span class="line">sub1 = sub1.rename(columns = &#123;&#x27;0&#x27;:&#x27;Item_Outlet_Sales&#x27;&#125;)</span><br><span class="line">sub1[&#x27;Item_Identifier&#x27;] = test[&#x27;Item_Identifier&#x27;]</span><br><span class="line">sub1[&#x27;Outlet_Identifier&#x27;] = test[&#x27;Outlet_Identifier&#x27;]</span><br><span class="line">sub1.columns = [&#x27;Item_Outlet_Sales&#x27;,&#x27;Item_Identifier&#x27;,&#x27;Outlet_Identifier&#x27;]</span><br><span class="line">sub1 = sub1[[&#x27;Item_Identifier&#x27;,&#x27;Outlet_Identifier&#x27;,&#x27;Item_Outlet_Sales&#x27;]]</span><br><span class="line">sub1.to_csv(&#x27;tpot.csv&#x27;,index=False)</span><br></pre></td></tr></table></figure>

<p>如果你提交了这个 csv，那么你会发现我一开始保证的那些还没有完全实现。那是不是我在骗你们呢？当然不是。实际上，TPOT 库有一个简单的规则。如果你不运行 TPOT 太久，那么它就不会为你的问题找出最可能传递方式。</p>
<p>所以，你得增加进化的代数，拿杯咖啡出去走一遭，其它的交给 TPOT 就行。此外，你也可以用这个库来处理分类问题。进一步内容可以参考这个文档：<a target="_blank" rel="noopener" href="http://rhiever.github.io/tpot/%E3%80%82%E9%99%A4%E4%BA%86%E6%AF%94%E8%B5%9B%EF%BC%8C%E5%9C%A8%E7%94%9F%E6%B4%BB%E4%B8%AD%E6%88%91%E4%BB%AC%E4%B9%9F%E6%9C%89%E5%BE%88%E5%A4%9A%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E5%8F%AF%E4%BB%A5%E7%94%A8%E5%88%B0%E9%81%97%E4%BC%A0%E7%AE%97%E6%B3%95%E3%80%82">http://rhiever.github.io/tpot/。除了比赛，在生活中我们也有很多应用场景可以用到遗传算法。</a></p>
<h3 id="6、-实际应用"><a href="#6、-实际应用" class="headerlink" title="6、 实际应用"></a>6、 实际应用</h3><p>遗传算法在真实世界中有很多应用。这里我列了部分有趣的场景，但是由于篇幅限制，我不会逐一详细介绍。</p>
<p>6.1 工程设计</p>
<p>工程设计非常依赖计算机建模以及模拟，这样才能让设计周期过程即快又经济。遗传算法在这里可以进行优化并给出一个很好的结果。</p>
<p>相关资源：</p>
<p>论文：Engineering design using genetic algorithms<br>地址：<a target="_blank" rel="noopener" href="http://lib.dr.iastate.edu/cgi/viewcontent.cgi?article=16942&amp;context=rtd">http://lib.dr.iastate.edu/cgi/viewcontent.cgi?article=16942&amp;context=rtd</a></p>
<p>6.2 交通与船运路线（Travelling Salesman Problem，巡回售货员问题）</p>
<p>这是一个非常著名的问题，它已被很多贸易公司用来让运输更省时、经济。解决这个问题也要用到遗传算法。</p>
<p><img src="https://pic4.zhimg.com/80/v2-9cf9a88399e85794bfcca306ba45c4bb_720w.webp"><br><img src="https://pic4.zhimg.com/80/v2-05abc32550c07774ffc4f906383d39b7_720w.webp"></p>
<p>6.3 机器人</p>
<p>遗传算法在机器人领域中的应用非常广泛。实际上，目前人们正在用遗传算法来创造可以像人类一样行动的自主学习机器人，其执行的任务可以是做饭、洗衣服等等。</p>
<p>相关资源：</p>
<p>论文：Genetic Algorithms for Auto-tuning Mobile Robot Motion Control</p>
<p>地址：<a target="_blank" rel="noopener" href="https://pdfs.semanticscholar.org/7c8c/faa78795bcba8e72cd56f8b8e3b95c0df20c.pdf">https://pdfs.semanticscholar.org/7c8c/faa78795bcba8e72cd56f8b8e3b95c0df20c.pdf</a></p>
<h3 id="7、结语"><a href="#7、结语" class="headerlink" title="7、结语"></a>7、结语</h3><p>希望通过本文介绍，你现在已经对遗传算法有了足够的理解，而且也会用 TPOT 库来实现它了。但是如果你不亲身实践，本文的知识也是非常有限的。</p>
<p>所以，请各位读者朋友一定要在无论是数据科学比赛或是生活中尝试自己去实现它。</p>
<p>选自<a target="_blank" rel="noopener" href="https://www.analyticsvidhya.com/blog/2017/07/introduction-to-genetic-algorithm/">Analyticsvidhya</a> 机器之心编译</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">英雄本色</p>
  <div class="site-description" itemprop="description">英雄本色的博客，记录生活，分享感悟。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">英雄本色</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
